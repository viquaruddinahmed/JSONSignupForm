// @Mon 03/05/2018 123245 
/*
 * Dynamsoft JavaScript Library
 * Product: Dynamsoft Camera SDK
 * Web Site: http://www.dynamsoft.com
 *
 * Copyright 2017, Dynamsoft Corporation
 * Author: Dynamsoft
 * Version: 6.1
 */
var dynamsoft=dynamsoft||{};dynamsoft.lib=dynamsoft.lib||{};dynamsoft.lib.detect=dynamsoft.lib.detect||{};dynamsoft.initOrder=dynamsoft.initOrder||[];dynamsoft.dcsEnv=dynamsoft.dcsEnv||{};dynamsoft.dcsEnv.host=dynamsoft.dcsEnv.host||{};dynamsoft.dcsEnv.host.win=dynamsoft.dcsEnv.host.win||window;dynamsoft.dcsEnv._lang=0;var dynamsoft=dynamsoft||{};dynamsoft.lib=dynamsoft.lib||{};dynamsoft.lib.win=window;(function(lib,undefined){var OP=Object.prototype,AP=Array.prototype,_utilities_ver=20180115,toString=OP.toString,win=lib.win,_host=lib.win,nil=undefined,EMPTY_STR="",FALSE=!1,TRUE=!0,_console=FALSE,class2TypeMap={},mix,each,navInfo,isNil,types,mixIsFunctions;if(dynamsoft.lib._utilities_ver){if(dynamsoft.lib._utilities_ver>=_utilities_ver){return}}dynamsoft.lib._utilities_ver=_utilities_ver;lib.mix=mix=function(dest,source){for(var i in source){dest[i]=source[i]}return dest};isNil=function(o){return o===nil};isDef=function(o){return o!==nil};mix(lib,{isDef:isDef,isUndef:isNil,isUndefined:isNil,isNull:function(o){return(o===null)},isNaN:function(o){return isNaN(o)},type:function(o){if(o===null||o===nil){return String(o)}return class2TypeMap[toString.call(o)]||"object"},isPlainObject:function(obj){if(!obj||lib.type(obj)!=="object"||obj.nodeType||obj.window==obj){return FALSE}var key,objConstructor;try{if((objConstructor=obj.constructor)&&!hasOwnProperty(obj,"constructor")&&!hasOwnProperty(objConstructor.prototype,"isPrototypeOf")){return FALSE}}catch(e){return FALSE}for(key in obj){}return(isNil(key)||hasOwnProperty(obj,key))}});mixIsFunctions=function(name,lc){class2TypeMap["[object "+name+"]"]=(lc=name.toLowerCase());lib["is"+name]=function(o){return lib.type(o)===lc}};mixIsFunctions("Function");lib.each=each=function(object,fn,context){if(object){var key,val,keys,i=0,length=object.length,isObj=isNil(length)||lib.isFunction(object);context=context||null;if(isObj){keys=lib.keys(object);for(;i<keys.length;i++){key=keys[i];if(fn.call(context,object[key],key,object)===FALSE){break}}}else{for(val=object[0];i<length;val=object[++i]){if(fn.call(context,val,i,object)===FALSE){break}}}}return object};types=["String","Object","Boolean","Number"];if(Array.isArray){lib.isArray=Array.isArray}else{types.push("Array")}each(types,mixIsFunctions);if(!isNil(win.console)){_console=win.console;if(!lib.isFunction(_console.log)||!lib.isFunction(_console.error)){_console=false}}mix(lib,{debug:FALSE,log:function(txt){if(lib.debug&&_console){_console.log(txt)}},error:function(txt){if(lib.debug&&_console){_console.error(txt)}},getLogger:function(){var _=lib.log;return{warn:_,log:_,info:_,debug:_}},nil:nil,noop:function(){}});mix(lib,{startsWith:function(str,prefix){return str.lastIndexOf(prefix,0)===0},endsWith:function(str,suffix){var ind=str.length-suffix.length;return ind>=0&&str.indexOf(suffix,ind)===ind},replaceAll:function(str,sFind,sReplace){return str.replace(eval("/"+sFind+"/gi"),sReplace)},upperCaseFirst:function(str){return str.charAt(0).toUpperCase()+str.substr(1)},makeArray:function(o){if(o==null){return[]}if(lib.isArray(o)){return o}var lengthType=typeof o.length,oType=typeof o;if(lengthType!=="number"||o.alert||oType==="string"||(oType==="function"&&!("item" in o&&lengthType==="number"))){return[o]}var ret=[];for(var i=0,l=o.length;i<l;i++){ret[i]=o[i]}return ret}});var hasEnumBug=!({toString:1}.propertyIsEnumerable("toString")),enumProperties=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"];lib.keys=Object.keys||function(o){var result=[],p,i;for(p in o){if(o.hasOwnProperty(p)){result.push(p)}}if(hasEnumBug){for(i=enumProperties.length-1;i>=0;i--){p=enumProperties[i];if(o.hasOwnProperty(p)){result.push(p)}}}return result};function hasOwnProperty(o,p){return OP.hasOwnProperty.call(o,p)}var doc=win.document,docElement=doc&&doc.documentElement,head=doc.getElementsByTagName("head")[0]||docElement,scriptOnload=doc.createElement("script").readyState?function(node,callback){var oldCallback=node.onreadystatechange;node.onreadystatechange=function(){var rs=node.readyState;if(rs==="loaded"||rs==="complete"){node.onreadystatechange=null;oldCallback&&oldCallback();callback.call(this)}}}:function(node,callback){node.addEventListener("load",callback,FALSE);node.addEventListener("error",callback,FALSE)};lib.getScript=function(url,isAsync,callback){var node,u;if(!lib.isFunction(callback)){callback=function(){}}if(!lib.isString(url)||url==EMPTY_STR){callback();return}node=doc.createElement("script");u=["",url].join(EMPTY_STR);node.src=u;if(isAsync){node.async=TRUE}node.charset="utf-8";scriptOnload(node,callback);head.insertBefore(node,head.firstChild);return node};lib.getCss=function(url,callback){var node,u,c=callback;if(!lib.isFunction(c)){c=!1}if(!lib.isString(url)||url==EMPTY_STR){c&&c();return}node=doc.createElement("link");node.href=url;node.rel="stylesheet";node.async=TRUE;c&&scriptOnload(node,c);head.insertBefore(node,head.firstChild);return node};lib.getRandom=function(){var a=new Date().getTime()%10000,b=[],tmp;for(var i=0;i<5;i++){tmp=Math.floor(Math.random()*10);if(i==0&&tmp==0){i=-1;continue}b.push(tmp)}if(a<10){b.push("000")}else{if(a<100){b.push("00")}else{if(a<1000){b.push("0")}}}b.push(a);return b.join("")};mix(lib,{get:function(id){return doc.getElementById(id)},hide:function(id){var o=lib.isString(id)?lib.get(id):id;if(o){o.style.display="none"}},show:function(id){var o=lib.isString(id)?lib.get(id):id;if(o){o.style.display=EMPTY_STR}},toggle:function(id){var o=lib.isString(id)?lib.get(id):id;if(o){if(o.style.display==="none"){o.style.display=EMPTY_STR}else{o.style.display="none"}}},empty:function(el){if(!el){return}while(el.firstChild){el.removeChild(el.firstChild)}},getOffset:function(evt,_parent,target){evt=evt||window.event;var el=target||evt.target,x=0,y=0,parentLeft=0,parentTop=0,scrollTop,scrollLeft,bFixed=false;while(el&&!isNaN(el.offsetLeft)&&!isNaN(el.offsetTop)){scrollLeft=el.scrollLeft;scrollTop=el.scrollTop;if(el.tagName==="BODY"){if(bFixed){scrollLeft=0;scrollTop=0}else{scrollLeft=scrollLeft|document.documentElement.scrollLeft;scrollTop=scrollTop|document.documentElement.scrollTop}}else{if(el.style.position==="fixed"){bFixed=true}}x+=el.offsetLeft-scrollLeft;y+=el.offsetTop-scrollTop;el=el.offsetParent}if(_parent){parentLeft=_parent.left;parentTop=_parent.top}x=evt.clientX-x-parentLeft;y=evt.clientY-y-parentTop;return{x:x,y:y}},getElDimensions:function(el,bOffset){var displayFormat,elDimensions;if(!el){return false}displayFormat=el.style.display;el.style.display="";elDimensions=bOffset?{offsetTop:el.offsetTop,offsetLeft:el.offsetLeft,offsetWidth:el.offsetWidth,offsetHeight:el.offsetHeight}:{clientTop:el.clientTop,clientLeft:el.clientLeft,clientWidth:el.clientWidth?el.clientWidth:(parseInt(el.style.width)?parseInt(el.style.width):0),clientHeight:el.clientHeight?el.clientHeight:(parseInt(el.style.height)?parseInt(el.style.height):0)};el.style.display=displayFormat;return elDimensions}});var ua=navigator.userAgent.toLowerCase(),_platform=navigator.platform.toLowerCase(),_protocol=doc.location.protocol,_ssl=(_protocol==="https:"),_bFileSystem=(_protocol!=="https:"&&_protocol!=="http:"),_bWin=(_platform=="win32")||(_platform=="win64")||(_platform=="windows"),_bMac=(_platform=="mac68k")||(_platform=="macppc")||(_platform=="macintosh")||(_platform=="macintel")||(_platform=="iphone"),_bLinux=(_platform.indexOf("linux")>=0),_isX64=(_platform=="win64")||(ua.indexOf("WOW64")>=0)||(ua.indexOf("x86_64")>=0)||(ua.indexOf("win64")>=0)||(ua.indexOf("x64")>=0),_nMSIE=ua.indexOf("msie"),_nTrident=ua.indexOf("trident"),_nRV=ua.indexOf("rv:"),_nEdge=ua.indexOf("edge"),_tmp=ua.match(/version\/([\d.]+).*safari/),_bSafari=_tmp?TRUE:FALSE,_nSafari=_tmp?_tmp[1]:0,_nFirefox=ua.indexOf("firefox"),_bFirefox=(_nFirefox!=-1),_bEdge=_bWin&&!_bFirefox&&(_nEdge!=-1),_indexOfChrome=ua.indexOf("chrome"),_bChrome=!_bEdge&&(_indexOfChrome!=-1),_bIE=_bWin&&!_bFirefox&&!_bEdge&&!_bChrome&&(_nMSIE!=-1||_nTrident!=-1||_nRV!=-1),_strIEVersion="",_IEMode=0,_bGecko=ua.match(/Gecko/)?TRUE:FALSE,_bHTML5Edition=FALSE,_strBrowserVersion=EMPTY_STR,_bQuerySelector=FALSE,_nativeJson=win.JSON,guidNum=0;if(_bEdge){_tmp=ua.slice(_nEdge+5);_tmp=_tmp.slice(0,_tmp.indexOf(" "));_strIEVersion=_tmp;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=27){_bHTML5Edition=TRUE}}else{if(_bChrome){_tmp=ua.slice(_indexOfChrome+7);_tmp=_tmp.slice(0,_tmp.indexOf(" "));_strBrowserVersion=_tmp;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=27){_bHTML5Edition=TRUE}}else{if(_bFirefox){_tmp=ua.slice(_nFirefox+8);_tmp=_tmp.slice(0,_tmp.indexOf(" "));_strBrowserVersion=_tmp;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=27){_bHTML5Edition=TRUE}}else{if(_bIE){if(_nMSIE!=-1){_tmp=ua.slice(_nMSIE+4);_tmp=_tmp.slice(0,_tmp.indexOf(";"));_strIEVersion=_tmp}else{if(_nRV!=-1){_tmp=ua.slice(_nRV+3);_tmp=_tmp.slice(0,_tmp.indexOf(";"));_tmp=_tmp.slice(0,_tmp.indexOf(")"));_strIEVersion=_tmp}else{if(_nTrident!=-1){_tmp=ua.slice(_nTrident+7);_tmp=_tmp.slice(0,_tmp.indexOf(";"));_strIEVersion=_tmp}}}if(_strIEVersion===""||_strIEVersion>8){_bHTML5Edition=TRUE}_strBrowserVersion=_tmp}else{if(_bSafari){if(_tmp){_strBrowserVersion=_tmp[1]}_tmp=_nSafari;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=7){_bHTML5Edition=TRUE}}}}}}if(_bEdge||_bIE){if(doc.documentMode){_IEMode=doc.documentMode}else{_IEMode=5;if(doc.compatMode){if(doc.compatMode=="CSS1Compat"){_IEMode=7}}}}if(docElement&&docElement.querySelector&&(!_bIE||_bIE&&(_strBrowserVersion>8))){_bQuerySelector=TRUE}if(_bIE&&_strBrowserVersion<9){_nativeJson=null}dynamsoft.navInfo=navInfo={host:_host,bSSL:_ssl,bFileSystem:_bFileSystem,bWin:_bWin,bMac:_bMac,bLinux:_bLinux,isX64:_isX64,bIE:_bIE,bEdge:_bEdge,bChrome:_bChrome,bFirefox:_bFirefox,bSafari:_bSafari,bGecko:_bGecko,bHTML5Edition:_bHTML5Edition,strBrowserVersion:_strBrowserVersion,IEMode:_IEMode,bQuerySelectorSupported:_bQuerySelector,nativeJson:_nativeJson,nodejs:FALSE,scrollBarWidth:false};var RE_TRIM=/^[\s\xa0]+|[\s\xa0]+$/g,trim=String.prototype.trim,indexOf=AP.indexOf,lastIndexOf=AP.lastIndexOf,filter=AP.filter,every=AP.every,some=AP.some,map=AP.map;mix(lib,{now:Date.now||function(){return +new Date()},guid:function(pre){return(pre||EMPTY_STR)+guidNum++},trim:trim?function(str){return str==null?EMPTY_STR:trim.call(str)}:function(str){return str==null?EMPTY_STR:(str+"").replace(RE_TRIM,EMPTY_STR)},filter:filter?function(arr,fn,context){return filter.call(arr,fn,context||this)}:function(arr,fn,context){var ret=[];each(arr,function(item,i,arr){if(fn.call(context||this,item,i,arr)){ret.push(item)}});return ret},indexOf:indexOf?function(item,arr){return indexOf.call(arr,item)}:function(item,arr){each(arr,function(v,k){if(v===item){return k}});return -1}});var logger=lib.getLogger(),SEP="&",EQ="=",HEX_BASE=16,htmlEntities={"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},reverseEntities={},escapeReg,unEscapeReg,escapeRegExp=/[\-#$\^*()+\[\]{}|\\,.?\s]/g;(function(){for(var k in htmlEntities){reverseEntities[htmlEntities[k]]=k}})();function isValidParamValue(val){var t=typeof val;return val==null||(t!=="object"&&t!=="function")}function getEscapeReg(){if(escapeReg){return escapeReg}var str=EMPTY_STR;each(htmlEntities,function(entity){str+=entity+"|"});str=str.slice(0,-1);escapeReg=new RegExp(str,"g");return escapeReg}function getUnEscapeReg(){if(unEscapeReg){return unEscapeReg}var str=EMPTY_STR;each(reverseEntities,function(entity){str+=entity+"|"});str+="&#(\\d{1,5});";unEscapeReg=new RegExp(str,"g");return unEscapeReg}lib.mix(lib,{urlEncode:function(s){return encodeURIComponent(String(s))},urlDecode:function(s){return decodeURIComponent(s.replace(/\+/g," "))},fromUnicode:function(str){return str.replace(/\\u([a-f\d]{4})/ig,function(m,u){return String.fromCharCode(parseInt(u,HEX_BASE))})},escapeHtml:function(str){return(str+"").replace(getEscapeReg(),function(m){return reverseEntities[m]})},escapeRegExp:function(str){return str.replace(escapeRegExp,"\\$&")},unEscapeHtml:function(str){return str.replace(getUnEscapeReg(),function(m,n){return htmlEntities[m]||String.fromCharCode(+n)})},param:function(o,sep,eq,serializeArray){sep=sep||SEP;eq=eq||EQ;if(isNil(serializeArray)){serializeArray=TRUE}var buf=[],key,i,v,len,val,encode=lib.urlEncode;for(key in o){val=o[key];key=encode(key);if(isValidParamValue(val)){buf.push(key);if(isDef(val)){buf.push(eq,encode(val+EMPTY_STR))}buf.push(sep)}else{if(lib.isArray(val)&&val.length){for(i=0,len=val.length;i<len;++i){v=val[i];if(isValidParamValue(v)){buf.push(key,(serializeArray?encode("[]"):EMPTY_STR));if(isDef(v)){buf.push(eq,encode(v+EMPTY_STR))}buf.push(sep)}}}}}buf.pop();return buf.join(EMPTY_STR)},unparam:function(str,sep,eq){if(!lib.isString(str)||!(str=lib.trim(str))){return{}}sep=sep||SEP;eq=eq||EQ;var ret={},eqIndex,decode=lib.urlDecode,pairs=str.split(sep),key,val,i=0,len=pairs.length;for(;i<len;++i){eqIndex=lib.indexOf(eq,pairs[i]);if(eqIndex===-1){key=decode(pairs[i]);val=nil}else{key=decode(pairs[i].substring(0,eqIndex));val=pairs[i].substring(eqIndex+1);try{val=decode(val)}catch(e){logger.error("decodeURIComponent error : "+val);logger.error(e)}if(lib.endsWith(key,"[]")){key=key.substring(0,key.length-2)}}if(key in ret){if(lib.isArray(ret[key])){ret[key].push(val)}else{ret[key]=[ret[key],val]}}else{ret[key]=val}}return ret}});var splitPathRe=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/;function normalizeArray(parts,allowAboveRoot){var up=0,i=parts.length-1,newParts=[],last;for(;i>=0;i--){last=parts[i];if(last!=="."){if(last===".."){up++}else{if(up){up--}else{newParts[newParts.length]=last}}}}if(allowAboveRoot){for(;up--;up){newParts[newParts.length]=".."}}newParts=newParts.reverse();return newParts}var Path=lib.Path={resolve:function(){var resolvedPath="",resolvedPathStr,i,args=(arguments),path,absolute=0;for(i=args.length-1;i>=0&&!absolute;i--){path=args[i];if(lib.isString(path)&&!!path){resolvedPath=path+"/"+resolvedPath;absolute=path.charAt(0)==="/"}}resolvedPathStr=normalizeArray(lib.filter(resolvedPath.split("/"),function(p){return !!p}),!absolute).join("/");return((absolute?"/":"")+resolvedPathStr)||"."},normalize:function(path){var absolute=path.charAt(0)==="/",trailingSlash=path.slice(-1)==="/";path=normalizeArray(lib.filter(path.split("/"),function(p){return !!p}),!absolute).join("/");if(!path&&!absolute){path="."}if(path&&trailingSlash){path+="/"}return(absolute?"/":"")+path},join:function(){var args=lib.makeArray(arguments);return Path.normalize(lib.filter(args,function(p){return p&&(lib.isString(p))}).join("/"))},relative:function(from,to){from=Path.normalize(from);to=Path.normalize(to);var fromParts=lib.filter(from.split("/"),function(p){return !!p}),path=[],sameIndex,sameIndex2,toParts=lib.filter(to.split("/"),function(p){return !!p}),commonLength=Math.min(fromParts.length,toParts.length);for(sameIndex=0;sameIndex<commonLength;sameIndex++){if(fromParts[sameIndex]!==toParts[sameIndex]){break}}sameIndex2=sameIndex;while(sameIndex<fromParts.length){path.push("..");sameIndex++}path=path.concat(toParts.slice(sameIndex2));path=path.join("/");return path},basename:function(path,ext){var result=path.match(splitPathRe)||[],basename;basename=result[3]||"";if(ext&&basename&&basename.slice(-1*ext.length)===ext){basename=basename.slice(0,-1*ext.length)}return basename},dirname:function(path){var result=path.match(splitPathRe)||[],root=result[1]||"",dir=result[2]||"";if(!root&&!dir){return"."}if(dir){dir=dir.substring(0,dir.length-1)}return root+dir},extname:function(path){return(path.match(splitPathRe)||[])[4]||""}};var logger=lib.getLogger(),reDisallowedInSchemeOrUserInfo=/[#\/\?@]/g,reDisallowedInPathName=/[#\?]/g,reDisallowedInQuery=/[#@]/g,reDisallowedInFragment=/#/g,URI_SPLIT_REG=new RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),Path=lib.Path,REG_INFO={scheme:1,userInfo:2,hostname:3,port:4,path:5,query:6,fragment:7};function parseQuery(self){if(!self._queryMap){self._queryMap=lib.unparam(self._query)}}function Query(query){this._query=query||""}Query.prototype={constructor:Query,clone:function(){return new Query(this.toString())},reset:function(query){var self=this;self._query=query||"";self._queryMap=null;return self},count:function(){var self=this,count=0,_queryMap,k;parseQuery(self);_queryMap=self._queryMap;for(k in _queryMap){if(lib.isArray(_queryMap[k])){count+=_queryMap[k].length}else{count++}}return count},has:function(key){var self=this,_queryMap;parseQuery(self);_queryMap=self._queryMap;if(key){return key in _queryMap}else{return !lib.isEmptyObject(_queryMap)}},get:function(key){var self=this,_queryMap;parseQuery(self);_queryMap=self._queryMap;if(key){return _queryMap[key]}else{return _queryMap}},keys:function(){var self=this;parseQuery(self);return lib.keys(self._queryMap)},set:function(key,value){var self=this,_queryMap;parseQuery(self);_queryMap=self._queryMap;if(lib.isString(key)){self._queryMap[key]=value}else{if(key instanceof Query){key=key.get()}each(key,function(v,k){_queryMap[k]=v})}return self},remove:function(key){var self=this;parseQuery(self);if(key){delete self._queryMap[key]}else{self._queryMap={}}return self},add:function(key,value){var self=this,_queryMap,currentValue;if(lib.isString(key)){parseQuery(self);_queryMap=self._queryMap;currentValue=_queryMap[key];if(isNil(currentValue)){currentValue=value}else{currentValue=[].concat(currentValue).concat(value)}_queryMap[key]=currentValue}else{if(key instanceof Query){key=key.get()}for(var k in key){self.add(k,key[k])}}return self},toString:function(serializeArray){var self=this;parseQuery(self);return lib.param(self._queryMap,nil,nil,serializeArray)}};function padding2(str){return str.length===1?"0"+str:str}function equalsIgnoreCase(str1,str2){return str1.toLowerCase()===str2.toLowerCase()}function encodeSpecialChars(str,specialCharsReg){return encodeURI(str).replace(specialCharsReg,function(m){return"%"+padding2(m.charCodeAt(0).toString(16))})}function Uri(uriStr){if(uriStr instanceof Uri){return uriStr.clone()}var components,self=this;lib.mix(self,{scheme:"",userInfo:"",hostname:"",port:"",path:"",query:"",fragment:""});components=Uri.getComponents(uriStr);each(components,function(v,key){v=v||"";if(key==="query"){self.query=new Query(v)}else{try{v=lib.urlDecode(v)}catch(e){logger.error(e+"urlDecode error : "+v)}self[key]=v}});return self}Uri.prototype={constructor:Uri,clone:function(){var uri=new Uri(),self=this;each(REG_INFO,function(index,key){uri[key]=self[key]});uri.query=uri.query.clone();return uri},resolve:function(relativeUri){if(lib.isString(relativeUri)){relativeUri=new Uri(relativeUri)}var self=this,override=0,lastSlashIndex,order=["scheme","userInfo","hostname","port","path","query","fragment"],target=self.clone();each(order,function(o){if(o==="path"){if(override){target[o]=relativeUri[o]}else{var path=relativeUri.path;if(path){override=1;if(!lib.startsWith(path,"/")){if(target.hostname&&!target.path){path="/"+path}else{if(target.path){lastSlashIndex=target.path.lastIndexOf("/");if(lastSlashIndex!==-1){path=target.path.slice(0,lastSlashIndex+1)+path}}}}target.path=Path.normalize(path)}}}else{if(o==="query"){if(override||relativeUri.query.toString()){target.query=relativeUri.query.clone();override=1}}else{if(override||relativeUri[o]){target[o]=relativeUri[o];override=1}}}});return target},getScheme:function(){return this.scheme},setScheme:function(scheme){this.scheme=scheme;return this},getHostname:function(){return this.hostname},setHostname:function(hostname){this.hostname=hostname;return this},setUserInfo:function(userInfo){this.userInfo=userInfo;return this},getUserInfo:function(){return this.userInfo},setPort:function(port){this.port=port;return this},getPort:function(){return this.port},setPath:function(path){this.path=path;return this},getPath:function(){return this.path},setQuery:function(query){if(lib.isString(query)){if(lib.startsWith(query,"?")){query=query.slice(1)}query=new Query(encodeSpecialChars(query,reDisallowedInQuery))}this.query=query;return this},getQuery:function(){return this.query},getFragment:function(){return this.fragment},setFragment:function(fragment){var self=this;if(lib.startsWith(fragment,"#")){fragment=fragment.slice(1)}self.fragment=fragment;return self},isSameOriginAs:function(other){var self=this;return equalsIgnoreCase(self.hostname,other.hostname)&&equalsIgnoreCase(self.scheme,other.scheme)&&equalsIgnoreCase(self.port,other.port)},toString:function(serializeArray){var out=[],self=this,scheme,hostname,path,port,fragment,query,userInfo;if((scheme=self.scheme)){out.push(encodeSpecialChars(scheme,reDisallowedInSchemeOrUserInfo));out.push(":")}if((hostname=self.hostname)){out.push("//");if((userInfo=self.userInfo)){out.push(encodeSpecialChars(userInfo,reDisallowedInSchemeOrUserInfo));out.push("@")}out.push(encodeURIComponent(hostname));if((port=self.port)){out.push(":");out.push(port)}}if((path=self.path)){if(hostname&&!lib.startsWith(path,"/")){path="/"+path}path=Path.normalize(path);out.push(encodeSpecialChars(path,reDisallowedInPathName))}if((query=(self.query.toString.call(self.query,serializeArray)))){out.push("?");out.push(query)}if((fragment=self.fragment)){out.push("#");out.push(encodeSpecialChars(fragment,reDisallowedInFragment))}return out.join("")}};Uri.Query=Query;Uri.getComponents=function(url){url=url||EMPTY_STR;var m=url.match(URI_SPLIT_REG)||[],ret={};each(REG_INFO,function(index,key){ret[key]=m[index]});return ret};lib.Uri=Uri;var logger=lib.getLogger();var doc=win.document,docElem=doc&&doc.documentElement,location=win.location,domReady=0,callbacks=[],POLL_RETIRES=500,POLL_INTERVAL=40,RE_ID_STR=/^#?([\w-]+)$/,RE_NOT_WHITESPACE=/\S/,standardEventModel=!!(doc&&doc.addEventListener),DOM_READY_EVENT="DOMContentLoaded",READY_STATE_CHANGE_EVENT="readystatechange",LOAD_EVENT="load",COMPLETE="complete",addEventListener=standardEventModel?function(el,type,fn){el.addEventListener(type,fn,false)}:function(el,type,fn){el.attachEvent("on"+type,fn)},removeEventListener=standardEventModel?function(el,type,fn){el.removeEventListener(type,fn,false)}:function(el,type,fn){el.detachEvent("on"+type,fn)};lib.mix(lib,{isWindow:function(obj){return obj!=null&&obj==obj.window},globalEval:function(data){if(data&&RE_NOT_WHITESPACE.test(data)){if(win.execScript){win.execScript(data)}else{(function(data){win.eval.call(win,data)})(data)}}},ready:function(fn){if(domReady){try{fn(lib)}catch(e){lib.log(e.stack||e,"error");setTimeout(function(){throw e},0)}}else{callbacks.push(fn)}return this}});function fireReady(){if(domReady){return}if(doc&&!navInfo.nodejs){removeEventListener(win,LOAD_EVENT,fireReady)}domReady=1;for(var i=0;i<callbacks.length;i++){try{callbacks[i](lib)}catch(e){lib.log(e.stack||e,"error");setTimeout(function(){throw e},0)}}}function bindReady(){if(!doc||doc.readyState===COMPLETE){fireReady();return}addEventListener(win,LOAD_EVENT,fireReady);if(standardEventModel){var domReady=function(){removeEventListener(doc,DOM_READY_EVENT,domReady);fireReady()};addEventListener(doc,DOM_READY_EVENT,domReady)}else{var stateChange=function(){if(doc.readyState===COMPLETE){removeEventListener(doc,READY_STATE_CHANGE_EVENT,stateChange);fireReady()}};addEventListener(doc,READY_STATE_CHANGE_EVENT,stateChange);var notframe,doScroll=docElem&&docElem.doScroll;try{notframe=(win.frameElement===null)}catch(e){notframe=false}if(doScroll&&notframe){var readyScroll=function(){try{doScroll("left");fireReady()}catch(ex){setTimeout(readyScroll,POLL_INTERVAL)}};readyScroll()}}}bindReady();if(navInfo.bIE){try{doc.execCommand("BackgroundImageCache",false,true)}catch(e){}}lib.switchEvent=function(e){e=e||window.event;if(e.which==null){e.which=(e.button<2)?1:((e.button==4)?2:3)}else{e.which=(e.which<2)?1:((e.which==2)?2:3)}return e};lib.currentStyle=function(obj,prop){if(obj.currentStyle){return obj.currentStyle[prop]}else{if(window.getComputedStyle){propprop=prop.replace(/([A-Z])/g,"-$1");propprop=prop.toLowerCase();return document.defaultView.getComputedStyle(obj,null)[prop]}}return null};lib.extend=function(ParentClass,childAddConstructor){var ChildClass=function(){ParentClass.apply(this,arguments);if(childAddConstructor){childAddConstructor.apply(this,arguments)}};for(var i in ParentClass.prototype){ChildClass.prototype[i]=ParentClass.prototype[i]}ChildClass.prototype.constructor=ChildClass;return ChildClass};lib.colorStrToInt=function(str){var mystr="0x";if(/^(rgb|RGB)/.test(str)){var nums=str.replace(/[^\d,.]/g,"").split(",");for(var i=0;i<3;++i){var hex=Number(nums[i]).toString(16);if(hex.length==1){hex="0"+hex}mystr+=hex}if(nums.length==4){var hex=Math.round(Number(nums[i])*255).toString(16);if(hex.length==1){hex="0"+hex}mystr+=hex}else{mystr+="ff"}}else{if(str=="transparent"){mystr+="00000000"}else{if(/^#[0-9a-fA-f]{6}$/.test(str)){mystr+=str.replace(/#/,"")+"ff"}else{if(/^#[0-9a-fA-f]{3}$/.test(str)){for(var i=0;i<3;++i){mystr+=str[i]+str[i]}mystr+="ff"}else{mystr="-1"}}}}return Number(mystr)};lib.IntToColorStr=function(value){if(value>4294967295||value<0){return null}var str;if(!navInfo.bHTML5Edition){if(value%256==0){str="transparent"}else{str=Math.floor(value/256).toString(16);while(str.length!=6){str="0"+str}str="#"+str}}else{str="rgba("+Math.floor(value/16777216)+","+Math.floor(value/65536)%256+","+Math.floor(value/256)%256+","+(value%256)/255+")"}return str};var customEvent={fire:function(type){var self=this,args;self.exec=self.exec||{};type=type.toLowerCase();args=AP.slice.call(arguments,1);each(self.exec[type]||[],function(item){var fn=item.f,ctx=item.c||self;try{fn.apply(ctx,args)}catch(e){console.log(e)}})},on:function(type,fn,ctx){var self=this;self.exec=self.exec||{};type=type.toLowerCase();self.exec[type]=self.exec[type]||[];self.exec[type].push({f:fn,c:ctx})},off:function(type,fn,c){var self=this,exec=self.exec;if(!exec){return}if(!type){self.exec=null;return}type=type.toLowerCase();if(!fn){exec[type]=null;return}var arr=exec[type]||[];for(var i=arr.length-1;i>=0;i--){if(arr[i]===fn){arr.splice(i,1)}}}};function Attributes(config){var self=this;self.__attrs={};self.__attrVals={};self.userConfig=config;while(c){self.addAttrs(c.ATTRS);c=c.superclass?c.superclass.constructor:null}lib.mix(self.__attrs,config)}lib.mix(Attributes.prototype,{get:function(name){var self=this;if(name in self.__attrs){return self.__attrs[name]}return""},set:function(name,v){var self=this;if(name in self.__attrs){self.__attrs[name]=v}},addAttrs:function(attrsConfig){lib.mix(this.__attrs,attrsConfig)}});Attributes.extend=function(px){var SuperClass=this,childAddConstructor,ret;px=px||{};if(px.constructor){childAddConstructor=px.constructor}ret=extend(SuperClass,childAddConstructor);lib.mix(ret,px);return ret};lib.obj={Attributes:Attributes,customEvent:customEvent}})(dynamsoft.lib);(function(s){var w=20180115;if(s._sizzle_ver){if(s.isNumber(s._sizzle_ver)&&s._sizzle_ver>=w){return}}s._sizzle_ver=w;var aq,g=RegExp,ae,ab,d,k,t,al,Y,U,r,u,o,p,ao=!0,f,M,b,S,am="dws_"+1*new Date(),an=window.document,K=0,y=0,ai=au(),aj=au(),G=au(),z=function(av,e){if(av===e){r=true}return 0},I=[],V=I.pop,aa=I.push,ak=I.push,E=I.slice,H=function(ax,aw){var av=0,e=ax.length;for(;av<e;av++){if(ax[av]===aw){return av}}return -1},ag="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Q="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",ad=["\\[",Q,"*(",B,")(?:",Q,"*([*^$|!~]?=)",Q,"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(",B,"))|)",Q,"*\\]"].join(""),D=new g(Q+"+","g"),ah=new g(["^",Q,"+|((?:^|[^\\\\])(?:\\\\.)*)",Q,"+$"].join(""),"g"),m=new g(["^",Q,"*,",Q,"*"].join("")),X=new g(["^",Q,"*([>+~]|",Q,")",Q,"*"].join("")),F=new g("="+Q+"*([^\\]'\"]*?)"+Q+"*\\]","g"),h=new g("^"+B+"$"),W={ID:new g("^#("+B+")"),CLASS:new g("^\\.("+B+")"),TAG:new g("^("+B+"|[*])"),ATTR:new g("^"+ad),needsContext:new g(["^",Q,"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(",Q,"*((?:-\\d)?\\d*)",Q,"*\\)|)(?=[^-]|$)"].join(""),"i")},L=/^[^{]+\{\s*\[native \w/,ac=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,R=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,l=function(av,e){if(e){if(av==="\0"){return"\uFFFD"}return av.slice(0,-1)+"\\"+av.charCodeAt(av.length-1).toString(16)+" "}return"\\"+av},q=function(){u()};try{ak.apply((I=E.call(an.childNodes)),an.childNodes);I[an.childNodes.length].nodeType}catch(at){ak={apply:I.length?function(av,e){aa.apply(av,E.call(e))}:function(ax,aw){var e=ax.length,av=0;while((ax[e++]=aw[av++])){}ax.length=e-1}}}function af(aB,av,aE,aH){var az,aF,ay,e,aG,ax,aC,aw=av&&av.ownerDocument,aD=av?av.nodeType:9;aE=aE||[];if(typeof aB!=="string"||!aB||aD!==1&&aD!==9&&aD!==11){return aE}if(!aH){if((av?av.ownerDocument||av:an)!==o){u(av)}av=av||o;if(aD!==11&&(aG=ac.exec(aB))){if((az=aG[1])){if(aD===9){if((ay=av.getElementById(az))){if(ay.id===az){aE.push(ay);return aE}}else{return aE}}else{if(aw&&(ay=aw.getElementById(az))&&S(av,ay)&&ay.id===az){aE.push(ay);return aE}}}else{if(aG[2]){ak.apply(aE,av.getElementsByTagName(aB));return aE}else{if((az=aG[3])&&ae.getElementsByClassName&&av.getElementsByClassName){ak.apply(aE,av.getElementsByClassName(az));return aE}}}}if(ae.qsa&&!G[aB+" "]&&(!f||!f.test(aB))){if(aD!==1){aw=av;aC=aB}else{if(av.nodeName.toLowerCase()!=="object"){if((e=av.getAttribute("id"))){e=e.replace(R,l)}else{av.setAttribute("id",(e=am))}ax=k(aB);aF=ax.length;while(aF--){ax[aF]="#"+e+" "+a(ax[aF])}aC=ax.join(",");aw=av}}if(aC){try{ak.apply(aE,aw.querySelectorAll(aC));return aE}catch(aA){}finally{if(e===am){av.removeAttribute("id")}}}}}return al(aB.replace(ah,"$1"),av,aE,aH)}function au(){var av=[];function e(aw,ax){if(av.push(aw+" ")>ab.cacheLength){delete e[av.shift()]}return(e[aw+" "]=ax)}return e}function ap(e){e[am]=true;return e}function Z(aw){var av=o.createElement("fieldset");try{return !!aw(av)}catch(ax){return false}finally{if(av.parentNode){av.parentNode.removeChild(av)}av=null}}function A(e,av){}function j(av,e){var ax=e&&av,aw=ax&&av.nodeType===1&&e.nodeType===1&&av.sourceIndex-e.sourceIndex;if(aw){return aw}if(ax){while((ax=ax.nextSibling)){if(ax===e){return -1}}}return av?1:-1}function T(e){return e&&typeof e.getElementsByTagName!=="undefined"&&e}ae=af.support={};u=af.setDocument=function(aw){var e,av,ax=aw?aw.ownerDocument||aw:an;if(ax===o||ax.nodeType!==9||!ax.documentElement){return o}o=ax;p=o.documentElement;if(an!==o&&(av=o.defaultView)&&av.top!==av){if(av.addEventListener){av.addEventListener("unload",q,false)}else{if(av.attachEvent){av.attachEvent("onunload",q)}}}ae.attributes=Z(function(ay){ay.className="i";return !ay.getAttribute("className")});ae.getElementsByTagName=Z(function(ay){ay.appendChild(o.createComment(""));return !ay.getElementsByTagName("*").length});ae.getElementsByClassName=L.test(o.getElementsByClassName);ae.getById=Z(function(ay){p.appendChild(ay).id=am;return !o.getElementsByName||!o.getElementsByName(am).length});if(ae.getById){ab.filter.ID=function(az){var ay=az;return function(aA){return aA.getAttribute("id")===ay}}}else{ab.filter.ID=function(az){var ay=new g(["^",az,"$"].join(""),"g");return function(aB){var aA=typeof aB.getAttributeNode!=="undefined"&&aB.getAttributeNode("id");return aA&&ay.test(aA.value)}}}ab.find.TAG=ae.getElementsByTagName?function(ay,az){if(typeof az.getElementsByTagName!=="undefined"){return az.getElementsByTagName(ay)}else{if(ae.qsa){return az.querySelectorAll(ay)}}}:function(ay,aC){var aD,aB=[],aA=0,az=aC.getElementsByTagName(ay);if(ay==="*"){while((aD=az[aA++])){if(aD.nodeType===1){aB.push(aD)}}return aB}return az};ab.find.CLASS=ae.getElementsByClassName&&function(az,ay){if(typeof ay.getElementsByClassName!=="undefined"){return ay.getElementsByClassName(az)}};M=[];f=[];if((ae.qsa=L.test(o.querySelectorAll))){Z(function(ay){p.appendChild(ay).innerHTML="<a id='"+am+"'></a><select id='"+am+"-\r\\' msallowcapture=''><option selected=''></option></select>";if(ay.querySelectorAll("[msallowcapture^='']").length){f.push("[*^$]="+Q+"*(?:''|\"\")")}if(!ay.querySelectorAll("[selected]").length){f.push("\\["+Q+"*(?:value|"+ag+")")}if(!ay.querySelectorAll("[id~="+am+"-]").length){f.push("~=")}if(!ay.querySelectorAll(":checked").length){f.push(":checked")}if(!ay.querySelectorAll("a#"+am+"+*").length){f.push(".#.+[+~]")}});Z(function(az){az.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var ay=o.createElement("input");ay.setAttribute("type","hidden");az.appendChild(ay).setAttribute("name","D");if(az.querySelectorAll("[name=d]").length){f.push("name"+Q+"*[*^$|!~]?=")}if(az.querySelectorAll(":enabled").length!==2){f.push(":enabled",":disabled")}p.appendChild(az).disabled=true;if(az.querySelectorAll(":disabled").length!==2){f.push(":enabled",":disabled")}az.querySelectorAll("*,:x");f.push(",.*:")})}if((ae.matchesSelector=L.test((b=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector)))){Z(function(ay){ae.disconnectedMatch=b.call(ay,"*");b.call(ay,"[s!='']:x")})}f=f.length&&new g(f.join("|"));M=M.length&&new g(M.join("|"));e=L.test(p.compareDocumentPosition);S=e||L.test(p.contains)?function(az,ay){var aB=az.nodeType===9?az.documentElement:az,aA=ay&&ay.parentNode;return az===aA||!!(aA&&aA.nodeType===1&&(aB.contains?aB.contains(aA):az.compareDocumentPosition&&az.compareDocumentPosition(aA)&16))}:function(az,ay){if(ay){while((ay=ay.parentNode)){if(ay===az){return true}}}return false};z=e?function(az,ay){if(az===ay){r=true;return 0}var aA=!az.compareDocumentPosition-!ay.compareDocumentPosition;if(aA){return aA}aA=(az.ownerDocument||az)===(ay.ownerDocument||ay)?az.compareDocumentPosition(ay):1;if(aA&1||(!ae.sortDetached&&ay.compareDocumentPosition(az)===aA)){if(az===o||az.ownerDocument===an&&S(an,az)){return -1}if(ay===o||ay.ownerDocument===an&&S(an,ay)){return 1}return U?(H(U,az)-H(U,ay)):0}return aA&4?-1:1}:function(az,ay){if(az===ay){r=true;return 0}var aF,aC=0,aE=az.parentNode,aB=ay.parentNode,aA=[az],aD=[ay];if(!aE||!aB){return az===o?-1:ay===o?1:aE?-1:aB?1:U?(H(U,az)-H(U,ay)):0}else{if(aE===aB){return j(az,ay)}}aF=az;while((aF=aF.parentNode)){aA.unshift(aF)}aF=ay;while((aF=aF.parentNode)){aD.unshift(aF)}while(aA[aC]===aD[aC]){aC++}return aC?j(aA[aC],aD[aC]):aA[aC]===an?-1:aD[aC]===an?1:0};return o};af.matches=function(av,e){return af(av,null,null,e)};af.matchesSelector=function(aw,ay){if((aw.ownerDocument||aw)!==o){u(aw)}ay=ay.replace(F,"='$1']");if(ae.matchesSelector&&!G[ay+" "]&&(!M||!M.test(ay))&&(!f||!f.test(ay))){try{var av=b.call(aw,ay);if(av||ae.disconnectedMatch||aw.document&&aw.document.nodeType!==11){return av}}catch(ax){}}return af(ay,o,null,[aw]).length>0};af.contains=function(e,av){if((e.ownerDocument||e)!==o){u(e)}return S(e,av)};af.escape=function(e){return(e+"").replace(R,l)};af.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};af.uniqueSort=function(aw){var ax,ay=[],e=0,av=0;r=!ae.detectDuplicates;U=!ae.sortStable&&aw.slice(0);aw.sort(z);if(r){while((ax=aw[av++])){if(ax===aw[av]){e=ay.push(av)}}while(e--){aw.splice(ay[e],1)}}U=null;return aw};d=af.getText=function(ay){var ax,av="",aw=0,e=ay.nodeType;if(!e){while((ax=ay[aw++])){av+=d(ax)}}else{if(e===1||e===9||e===11){if(typeof ay.textContent==="string"){return ay.textContent}else{for(ay=ay.firstChild;ay;ay=ay.nextSibling){av+=d(ay)}}}else{if(e===3||e===4){return ay.nodeValue}}}return av};ab=af.selectors={cacheLength:50,match:W,find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[3]=(e[3]||e[4]||e[5]||"");if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)}},filter:{TAG:function(av){var e=av.toLowerCase();return av==="*"?function(){return true}:function(aw){return aw.nodeName&&aw.nodeName.toLowerCase()===e}},CLASS:function(e){var av=ai[e+" "];return av||(av=new g("(^|"+Q+")"+e+"("+Q+"|$)"))&&ai(e,function(aw){return av.test(typeof aw.className==="string"&&aw.className||typeof aw.getAttribute!=="undefined"&&aw.getAttribute("class")||"")})},ATTR:function(aw,av,e){return function(ay){var ax=af.attr(ay,aw);if(ax==null){return av==="!="}if(!av){return true}ax+="";return av==="="?ax===e:av==="!="?ax!==e:av==="^="?e&&ax.indexOf(e)===0:av==="*="?e&&ax.indexOf(e)>-1:av==="$="?e&&ax.slice(-e.length)===e:av==="~="?(" "+ax.replace(D," ")+" ").indexOf(e)>-1:av==="|="?ax===e||ax.slice(0,e.length+1)===e+"-":false}}}};function C(){}C.prototype=ab.filters=ab.pseudos;ab.setFilters=new C();k=af.tokenize=function(ay,aD){var av,az,aB=[],aC,aA,aw,e,ax=aj[ay+" "];if(ax){return aD?0:ax.slice(0)}aA=ay;aw=[];e=ab.preFilter;while(aA){if(!av||(az=m.exec(aA))){if(az){aA=aA.slice(az[0].length)||aA}aw.push((aB=[]))}av=false;if((az=X.exec(aA))){av=az.shift();aB.push({value:av,type:az[0].replace(ah," ")});aA=aA.slice(av.length)}for(aC in ab.filter){if((az=W[aC].exec(aA))&&(!e[aC]||(az=e[aC](az)))){av=az.shift();aB.push({value:av,type:aC,matches:az});aA=aA.slice(av.length)}}if(!av){break}}return aD?aA.length:aA?af.error(ay):aj(ay,aw).slice(0)};function a(ax){var aw=0,av=ax.length,e="";for(;aw<av;aw++){e+=ax[aw].value}return e}function O(aA,ay,az){var e=ay.dir,ax=ay.next,aw=ax||e,aB=az&&aw==="parentNode",av=y++;return ay.first?function(aE,aD,aC){while((aE=aE[e])){if(aE.nodeType===1||aB){return aA(aE,aD,aC)}}return false}:function(aH,aF,aE){var aI,aC,aG,aD=[K,av];if(aE){while((aH=aH[e])){if(aH.nodeType===1||aB){if(aA(aH,aF,aE)){return true}}}}else{while((aH=aH[e])){if(aH.nodeType===1||aB){aG=aH[am]||(aH[am]={});aC=aG[aH.uniqueID]||(aG[aH.uniqueID]={});if(ax&&ax===aH.nodeName.toLowerCase()){aH=aH[e]||aH}else{if((aI=aC[aw])&&aI[0]===K&&aI[1]===av){return(aD[2]=aI[2])}else{aC[aw]=aD;if((aD[2]=aA(aH,aF,aE))){return true}}}}}}return false}}function x(e){return e.length>1?function(ay,ax,av){var aw=e.length;while(aw--){if(!e[aw](ay,ax,av)){return false}}return true}:e[0]}function J(av,ay,ax){var aw=0,e=ay.length;for(;aw<e;aw++){af(av,ay[aw],ax)}return ax}function N(e,av,aw,ax,aA){var ay,aD=[],az=0,aB=e.length,aC=av!=null;for(;az<aB;az++){if((ay=e[az])){if(!aw||aw(ay,ax,aA)){aD.push(ay);if(aC){av.push(az)}}}}return aD}function ar(aw,av,ay,ax,az,e){if(ax&&!ax[am]){ax=ar(ax)}if(az&&!az[am]){az=ar(az,e)}return ap(function(aK,aH,aC,aJ){var aM,aI,aE,aD=[],aL=[],aB=aH.length,aA=aK||J(av||"*",aC.nodeType?[aC]:aC,[]),aF=aw&&(aK||!av)?N(aA,aD,aw,aC,aJ):aA,aG=ay?az||(aK?aw:aB||ax)?[]:aH:aF;if(ay){ay(aF,aG,aC,aJ)}if(ax){aM=N(aG,aL);ax(aM,[],aC,aJ);aI=aM.length;while(aI--){if((aE=aM[aI])){aG[aL[aI]]=!(aF[aL[aI]]=aE)}}}if(aK){if(az||aw){if(az){aM=[];aI=aG.length;while(aI--){if((aE=aG[aI])){aM.push((aF[aI]=aE))}}az(null,(aG=[]),aM,aJ)}aI=aG.length;while(aI--){if((aE=aG[aI])&&(aM=az?H(aK,aE):aD[aI])>-1){aK[aM]=!(aH[aM]=aE)}}}}else{aG=N(aG===aH?aG.splice(aB,aG.length):aG);if(az){az(null,aH,aG,aJ)}else{ak.apply(aH,aG)}}})}function P(aA){var av,ay,aw,az=aA.length,aD=ab.relative[aA[0].type],aE=aD||ab.relative[" "],ax=aD?1:0,aB=O(function(aF){return aF===av},aE,true),aC=O(function(aF){return H(av,aF)>-1},aE,true),e=[function(aI,aH,aG){var aF=(!aD&&(aG||aH!==Y))||((av=aH).nodeType?aB(aI,aH,aG):aC(aI,aH,aG));av=null;return aF}];for(;ax<az;ax++){if((ay=ab.relative[aA[ax].type])){e=[O(x(e),ay)]}else{ay=ab.filter[aA[ax].type].apply(null,aA[ax].matches);if(ay[am]){aw=++ax;for(;aw<az;aw++){if(ab.relative[aA[aw].type]){break}}return ar(ax>1&&x(e),ax>1&&a(aA.slice(0,ax-1).concat({value:aA[ax-2].type===" "?"*":""})).replace(ah,"$1"),ay,ax<aw&&P(aA.slice(ax,aw)),aw<az&&P((aA=aA.slice(aw))),aw<az&&a(aA))}e.push(ay)}}return x(e)}function n(ax,aw){var e=aw.length>0,ay=ax.length>0,av=function(aI,aC,aH,aG,aL){var aD,aE,aJ,aN=0,aF="0",az=aI&&[],aO=[],aM=Y,aB=aI||ay&&ab.find.TAG("*",aL),aA=(K+=aM==null?1:Math.random()||0.1),aK=aB.length;if(aL){Y=aC===o||aC||aL}for(;aF!==aK&&(aD=aB[aF])!=null;aF++){if(ay&&aD){aE=0;if(!aC&&aD.ownerDocument!==o){u(aD);aH=!ao}while((aJ=ax[aE++])){if(aJ(aD,aC||o,aH)){aG.push(aD);break}}if(aL){K=aA}}if(e){if((aD=!aJ&&aD)){aN--}if(aI){az.push(aD)}}}aN+=aF;if(e&&aF!==aN){aE=0;while((aJ=aw[aE++])){aJ(az,aO,aC,aH)}if(aI){if(aN>0){while(aF--){if(!(az[aF]||aO[aF])){aO[aF]=V.call(aG)}}}aO=N(aO)}ak.apply(aG,aO);if(aL&&!aI&&aO.length>0&&(aN+aw.length)>1){af.uniqueSort(aG)}}if(aL){K=aA;Y=aM}return az};return e?ap(av):av}t=af.compile=function(e,aw){var ax,av=[],az=[],ay=G[e+" "];if(!ay){if(!aw){aw=k(e)}ax=aw.length;while(ax--){ay=P(aw[ax]);if(ay[am]){av.push(ay)}else{az.push(ay)}}ay=G(e,n(az,av));ay.selector=e}return ay};al=af.select=function(e,az,ay,av){var ax,aA=typeof e==="function"&&e,aw=!av&&k((e=aA.selector||e));ay=ay||[];(aA||t(e,aw))(av,az,!ao,ay,!az||az);return ay};ae.sortStable=am.split("").sort(z).join("")===am;ae.detectDuplicates=!!r;u();ae.sortDetached=Z(function(e){return e.compareDocumentPosition(o.createElement("fieldset"))&1});if(!Z(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild.getAttribute("href")==="#"})){A("type|href|height|width",function(av,e){return av.getAttribute(e,e.toLowerCase()==="type"?1:2)})}if(!ae.attributes||!Z(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return e.firstChild.getAttribute("value")===""})){A("value",function(av,e){if(av.nodeName.toLowerCase()==="input"){return av.defaultValue}})}if(!Z(function(e){return e.getAttribute("disabled")==null})){A(ag,function(av,e){var aw;return av[e]===true?e.toLowerCase():(aw=av.getAttributeNode(e))&&aw.specified?aw.value:null})}s.support=ae;s.all=af})(dynamsoft.lib);(function(m){var ae=Array.prototype,z=ae.slice,Y=ae.push,u=m.makeArray,h=document,f=h.documentElement;var t=20180115;if(m._dom_ver){if(m.isNumber(m._dom_ver)&&m._dom_ver>=t){return}}m._dom_ver=t;function O(al,am,ak){var aj=this;if(!(aj instanceof O)){return new O(al,am,ak)}if(!al){return aj}if(typeof al==="string"){m.error("Err 4001.");return aj}if(m.isArray(al)||al.isNodeList){Y.apply(aj,u(al));return aj}aj[0]=al;aj.length=1;return aj}var K;K=O.prototype={isNodeList:true,length:0,item:function(ak){var aj=this;if(m.isNumber(ak)){if(ak>=aj.length){return null}else{return new O(aj[ak])}}else{return new O(ak)}},slice:function(){return new O(z.apply(this,arguments))},getDOMNodes:function(){return z.call(this)},each:function(al,ak){var aj=this;m.each(aj,function(an,am){an=new O(an);return al.call(ak||an,an,am,aj)});return aj},getEL:function(){return this[0]},all:function(aj){var al,ak=this;if(ak.length>0){al=O.all(aj,ak)}else{al=new O()}return al},one:function(aj){var ak=this,am=ak.all(aj),al=am.length?am.slice(0,1):null;return al}};m.mix(O,{all:function(aj,al){var ak=al;if(ak&&ak.isNodeList){ak=al.getEL()}if(typeof aj==="string"){if((aj=m.trim(aj))&&aj.length>=3&&m.startsWith(aj,"<")&&m.endsWith(aj,">")){m.err("Err 4002.")}return new O(m.all(aj,ak))}if(aj.isNodeList){return aj}return new O(aj)},one:function(aj,ak){var al=O.all(aj,ak);return al.length?al.slice(0,1):null}});m.one=O.one;var R=m.support,V=m.all;var d,X,Z,N,x,n,Q=document.createElement("div"),ac=document.createElement("div");if(!ac.style){return}ac.style.cssText="float:left;opacity:.5";R.opacity=ac.style.opacity==="0.5";R.cssFloat=!!ac.style.cssFloat;ac.style.backgroundClip="content-box";ac.cloneNode(true).style.backgroundClip="";R.clearCloneStyle=ac.style.backgroundClip==="content-box";Q=document.createElement("div");Q.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute";ac.innerHTML="";Q.appendChild(ac);R.boxSizing=ac.style.boxSizing===""||ac.style.MozBoxSizing===""||ac.style.WebkitBoxSizing==="";m.mix(R,{reliableHiddenOffsets:function(){if(d==null){s()}return N},boxSizingReliable:function(){if(d==null){s()}return Z},pixelMarginRight:function(){if(d==null){s()}return X},pixelPosition:function(){if(d==null){s()}return d},reliableMarginRight:function(){if(d==null){s()}return x},reliableMarginLeft:function(){if(d==null){s()}return n}});function s(){var ak,aj;f.appendChild(Q);ac.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";d=Z=n=false;X=x=true;if(window.getComputedStyle){aj=window.getComputedStyle(ac);d=(aj||{}).top!=="1%";n=(aj||{}).marginLeft==="2px";Z=(aj||{width:"4px"}).width==="4px";ac.style.marginRight="50%";X=(aj||{marginRight:"4px"}).marginRight==="4px";ak=ac.appendChild(document.createElement("div"));ak.style.cssText=ac.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";ak.style.marginRight=ak.style.width="0";ac.style.width="1px";x=!parseFloat((window.getComputedStyle(ak)||{}).marginRight);ac.removeChild(ak)}ac.style.display="none";N=ac.getClientRects().length===0;if(N){ac.style.display="";ac.innerHTML="<table><tr><td></td><td>t</td></tr></table>";ac.childNodes[0].style.borderCollapse="separate";ak=ac.getElementsByTagName("td");ak[0].style.cssText="margin:0;border:0;padding:0;display:none";N=ak[0].offsetHeight===0;if(N){ak[0].style.display="";ak[1].style.display="none";N=ak[0].offsetHeight===0}}f.removeChild(Q)}var l,j,D=(/^margin/),w=/^(top|right|bottom|left)$/,ad=(/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source,P=new RegExp("^("+ad+")(?!px)[a-z%]+$","i"),r=new RegExp("^("+ad+")(.*)$","i");if(window.getComputedStyle){l=function(al){var ak,aj;ak=m.isFunction(al.getEL)?al.getEL():al;aj=ak.ownerDocument.defaultView;if(!aj||!aj.opener){aj=window}return aj.getComputedStyle(ak)};j=function(aq,ak,ap){var an,am,ao,aj,al=aq.style;ap=ap||l(aq);aj=ap?ap.getPropertyValue(ak)||ap[ak]:undefined;if((aj===""||aj===undefined)&&!B.contains(aq.ownerDocument,aq)){aj=B.style(aq,ak)}if(ap){if(!R.pixelMarginRight()&&P.test(aj)&&D.test(ak)){an=al.width;am=al.minWidth;ao=al.maxWidth;al.minWidth=al.maxWidth=al.width=aj;aj=ap.width;al.width=an;al.minWidth=am;al.maxWidth=ao}}return aj===undefined?aj:aj+""}}else{if(f.currentStyle){l=function(aj){return aj.currentStyle};j=function(ap,am,ao){var aq,ak,aj,al,an=ap.style;ao=ao||l(ap);al=ao?ao[am]:undefined;if(al==null&&an&&an[am]){al=an[am]}if(P.test(al)&&!w.test(am)){aq=an.left;ak=ap.runtimeStyle;aj=ak&&ak.left;if(aj){ak.left=ap.currentStyle.left}an.left=am==="fontSize"?"1em":al;al=an.pixelLeft+"px";an.left=aq;if(aj){ak.left=aj}}return al===undefined?al:al+""||"auto"}}}var g=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,q=(/<([\w:-]+)/),e=(/^\s+/),A=/<|&#?\w+;/,L=/^-ms-/,E=/-([\da-z])/gi,F=/^(none|table(?!-c[ea]).+)/,T=(/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/);var b=["Top","Right","Bottom","Left"];var W={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:R.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};var H,ab=["Webkit","O","Moz","ms"],M="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";var ac=document.createElement("div");if(!ac.style){return}H=ac.style;R.cssFloat=!!ac.style.cssFloat;var G=function(aj,ak){return ak.toUpperCase()};var B={type:function(aj){if(aj==null){return aj+""}return typeof aj==="object"||typeof aj==="function"?class2type[toString.call(aj)]||"object":typeof aj},cssHooks:{},htmlPrefilter:function(aj){return aj.replace(g,"<$1></$2>")},nodeName:function(ak,aj){return ak.nodeName&&ak.nodeName.toLowerCase()===aj.toLowerCase()},merge:function(an,al){var aj=+al.length,ak=0,am=an.length;while(ak<aj){an[am++]=al[ak++]}if(aj!==aj){while(al[ak]!==undefined){an[am++]=al[ak++]}}an.length=am;return an},camelCase:function(aj){return aj.replace(L,"ms-").replace(E,G)},cssProps:{"float":R.cssFloat?"cssFloat":"styleFloat"},cssNumber:{animationIterationCount:true,columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true}};function S(aj){if(aj in H){return aj}var al=aj.charAt(0).toUpperCase()+aj.slice(1),ak=ab.length;while(ak--){aj=ab[ak]+al;if(aj in H){return aj}}}function p(am,aj){var ak,an,al=0,ao=typeof am.getElementsByTagName!=="undefined"?am.getElementsByTagName(aj||"*"):typeof am.querySelectorAll!=="undefined"?am.querySelectorAll(aj||"*"):undefined;if(!ao){for(ao=[],ak=am.childNodes||am;(an=ak[al])!=null;al++){if(!aj||B.nodeName(an,aj)){ao.push(an)}else{B.merge(ao,p(an,aj))}}}return aj===undefined||aj&&B.nodeName(am,aj)?B.merge([am],ao):ao}function k(ak,am){var ar,ao,aq,au,aw,av,al,ap=ak.length,an=aa(am),aj=[],at=0;for(;at<ap;at++){ao=ak[at];if(ao||ao===0){if(m.type(ao)==="object"){B.merge(aj,ao.nodeType?[ao]:ao)}else{if(!A.test(ao)){aj.push(am.createTextNode(ao))}else{au=au||an.appendChild(am.createElement("div"));aw=(q.exec(ao)||["",""])[1].toLowerCase();al=W[aw]||W._default;au.innerHTML=al[1]+B.htmlPrefilter(ao)+al[2];ar=al[0];while(ar--){au=au.lastChild}if(!R.leadingWhitespace&&e.test(ao)){aj.push(am.createTextNode(e.exec(ao)[0]))}if(!R.tbody){ao=aw==="table"&&!rtbody.test(ao)?au.firstChild:al[1]==="<table>"&&!rtbody.test(ao)?au:0;ar=ao&&ao.childNodes.length;while(ar--){if(B.nodeName((av=ao.childNodes[ar]),"tbody")&&!av.childNodes.length){ao.removeChild(av)}}}B.merge(aj,au.childNodes);au.textContent="";while(au.firstChild){au.removeChild(au.firstChild)}au=an.lastChild}}}}if(au){an.removeChild(au)}at=0;while((ao=aj[at++])){aq=V.contains(ao.ownerDocument,ao);au=p(an.appendChild(ao),"script");if(aq){setGlobalEval(au)}}au=null;return an}function aa(al){var ak=M.split("|"),aj=al.createDocumentFragment();if(aj.createElement){while(ak.length){aj.createElement(ak.pop())}}return aj}var J=function(ao,an,ap,am){var al,ak,aj={};for(ak in an){aj[ak]=ao.style[ak];ao.style[ak]=an[ak]}al=ap.apply(ao,am||[]);for(ak in an){ao.style[ak]=aj[ak]}return al};function ah(an,ak,aj){var am=true,ao=ak==="width"?an.offsetWidth:an.offsetHeight,al=l(an),ap=R.boxSizing&&B.css(an,"boxSizing",false,al)==="border-box";if(ao<=0||ao==null){ao=j(an,ak,al);if(ao<0||ao==null){ao=an.style[ak]}if(P.test(ao)){return ao}am=ap&&(R.boxSizingReliable()||ao===an.style[ak]);ao=parseFloat(ao)||0}return(ao+y(an,ak,aj||(ap?"border":"content"),am,al))}function y(an,ak,aj,ap,am){var al=aj===(ap?"border":"content")?4:ak==="width"?1:0,ao=0;for(;al<4;al+=2){if(aj==="margin"){ao+=B.css(an,aj+b[al],true,am)}if(ap){if(aj==="content"){ao-=B.css(an,"padding"+b[al],true,am)}if(aj!=="margin"){ao-=B.css(an,"border"+b[al]+"Width",true,am)}}else{ao+=B.css(an,"padding"+b[al],true,am);if(aj!=="padding"){ao+=B.css(an,"border"+b[al]+"Width",true,am)}}}return ao}function U(aj){var ak=new RegExp("^(?:([+-])=|)("+ad+")([a-z%]*)$","i");return ak.exec(aj)}function C(aj,al,am){var ak=r.exec(al);return ak?Math.max(0,ak[1]-(am||0))+(ak[2]||"px"):al}function o(ak,aj,an,at){var au,al=1,ap=20,ar=at?function(){return at.cur()}:function(){return B.css(ak,aj,"")},ao=ar(),aq=an&&an[3]||(B.cssNumber[aj]?"":"px"),am=(B.cssNumber[aj]||aq!=="px"&&+ao)&&U(B.css(ak,aj));if(am&&am[3]!==aq){aq=aq||am[3];an=an||[];am=+ao||1;do{al=al||".5";am=am/al;B.style(ak,aj,am+aq)}while(al!==(al=ar()/ao)&&al!==1&&--ap)}if(an){am=+am||+ao||0;au=an[1]?am+(an[1]+1)*an[2]:+an[2];if(at){at.unit=aq;at.start=am;at.end=au}}return au}m.each(["height","width"],function(aj,ak){B.cssHooks[aj]={get:function(an,am,al){if(am){return F.test(B.css(an,"display"))&&an.offsetWidth===0?J(an,cssShow,function(){return ah(an,aj,al)}):ah(an,aj,al)}},set:function(an,ao,al){var am=al&&l(an);return C(an,ao,al?y(an,aj,al,R.boxSizing&&B.css(an,"boxSizing",false,am)==="border-box",am):0)}}});m.style=B.style=function(al,ak,aq,am){if(!al||al.nodeType===3||al.nodeType===8||!al.style){return}var ao,ap,ar,an=B.camelCase(ak),aj=al.style;ak=B.cssProps[an]||(B.cssProps[an]=S(an)||an);ar=B.cssHooks[ak]||B.cssHooks[an];if(aq!==undefined){ap=typeof aq;if(ap==="string"&&(ao=U(aq))&&ao[1]){aq=o(al,ak,ao);ap="number"}if(aq==null||aq!==aq){return}if(ap==="number"){aq+=ao&&ao[3]||(B.cssNumber[an]?"":"px")}if(!R.clearCloneStyle&&aq===""&&ak.indexOf("background")===0){aj[ak]="inherit"}if(!ar||!("set" in ar)||(aq=ar.set(al,aq,am))!==undefined){aj[ak]=aq}}else{if(ar&&"get" in ar&&(ao=ar.get(al,false,am))!==undefined){return ao}return aj[ak]}};m.css=B.css=function(ap,an,ak,ao){var am,aq,aj,al=B.camelCase(an);an=B.cssProps[al]||(B.cssProps[al]=S(al)||al);aj=B.cssHooks[an]||B.cssHooks[al];if(aj&&"get" in aj){aq=aj.get(ap,true,ak)}if(aq===undefined){aq=j(ap,an,ao)}if(aq==="normal"&&an in cssNormalTransform){aq=cssNormalTransform[an]}if(ak===""||ak){am=parseFloat(aq);return ak===true||isFinite(am)?am||0:aq}return aq};var a=" ",ai=/[\n\t\r]/g,ag=function(aj){return(a+aj+a).replace(ai,a)},af=function(an,ap){var am=an.className,aj,ak=ap.length,ao,al;if(am){aj=ag(am);ao=am;al=0;for(;al<ak;al++){if(aj.indexOf(a+ap[al]+a)<0){ao+=a+ap[al]}}ao=m.trim(ao)}else{ao=ap.join(" ")}an.className=ao},I=function(an,ap){var al=an.className,am,aj=ap.length,ak,ao;if(al&&aj){am=ag(al);ak=0;for(;ak<aj;ak++){ao=a+ap[ak]+a;while(am.indexOf(ao)>=0){am=am.replace(ao,a)}}an.className=m.trim(am)}};m.mix(K,{before:function(ak){var al=this.getEL(),aj=ak;if(typeof ak==="string"&&(ak=m.trim(ak))&&ak.length>=3&&m.startsWith(ak,"<")&&m.endsWith(ak,">")){aj=m.parseHTML(ak)[0]}al.insertBefore(aj,al.childNodes[0])},append:function(ak){var al=this.getEL(),aj=ak;if(typeof ak==="string"&&(ak=m.trim(ak))&&ak.length>=3&&m.startsWith(ak,"<")&&m.endsWith(ak,">")){aj=m.parseHTML(ak)[0]}al.appendChild(aj)},html:function(aj){this.getEL().innerHTML=aj},attr:function(al,aj){var ak=this.getEL();if(al=="class"){ak.className=aj}else{ak[al]=aj}},style:function(al,aj){var ak=this.getEL();return B.style(ak,al,aj)},css:function(aj){var ak=this.getEL();m.each(aj,function(al,am){B.style(ak,am,al)})},addClass:function(aj){var ak=this.getEL();af(ak,aj.split(a))},removeClass:function(aj){var ak=this.getEL();I(ak,aj.split(a))},parent:function(){var aj=this.getEL();return new O(aj.parentNode)},remove:function(){var aj=this.getEL();aj.parentNode.removeChild(aj)}});m.parseHTML=function(al,ak){if(!al||typeof al!=="string"){return null}if(typeof ak==="boolean"){ak=false}ak=ak||document;var aj=T.exec(al);if(aj){return[ak.createElement(aj[1])]}aj=k([al],ak);return B.merge([],aj.childNodes)}})(dynamsoft.lib);(function(d){var b=Array.prototype,a=Function.prototype;var e=20180115;if(d._polyfill_ver){if(d.isNumber(d._polyfill_ver)&&d._polyfill_ver>=e){return}}d._polyfill_ver=e;if(!d.isFunction(b.indexOf)){b.indexOf=function(h,j){var g;if(this==null){return -1}var l=Object(this);var f=l.length>>>0;if(f===0){return -1}var m=+j||0;if(Math.abs(m)===Infinity){m=0}if(m>=f){return -1}g=Math.max(m>=0?m:f-Math.abs(m),0);while(g<f){if(g in l&&l[g]===h){return g}g++}return -1}}if(!d.isFunction(a.bind)){a.bind=function(h){var g=this;if(1<arguments.length){var f=b.slice.call(arguments,1);return function(){return g.apply(h,arguments.length?f.concat(b.slice.call(arguments)):f)}}return function(){return arguments.length?g.apply(h,arguments):g.call(h)}}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}})(dynamsoft.lib);(function(a){var e=a.lib,d=a.navInfo,g=window.document,h,f;var j=20180115;if(e._event_ver){if(e.isNumber(e._event_ver)&&e._event_ver>=j){return}}e._event_ver=j;f=function(m){var l=m;if(l=="mousewheel"){l=d.bGecko?"DOMMouseScroll":"mousewheel"}return l};h={addEventListener:g.addEventListener?function(m,o,n){var l=f(o);if(m){m.addEventListener(l,n,false)}}:function(m,o,n){var l=f(o);if(m){m.attachEvent("on"+l,n)}},removeEventListener:g.removeEventListener?function(m,o,n){var l=f(o);if(m){m.removeEventListener(l,n,false)}}:function(m,o,n){var l=f(o);if(m){m.detachEvent("on"+l,n)}},getWheelDelta:function(l){l=l||window.event;var o,n=l.wheelDelta,m=l.detail;if(n){o=n/120}if(m){o=-(m%3===0?m/3:m)}return o}};e.mix(e,h);e.Events={registedClass:[],registedObjs:[]};var k=function(l){var n=l||window.event;var m=true;e.each(e.Events.registedObjs,function(o){e.each(e.Events.registedClass,function(p){if(o instanceof p){if(o.bFocus&&o.handlerKeyDown){m=o.handlerKeyDown(n);if(!m){return false}}}})});return m};e.addEventListener(document.documentElement,"keydown",k);e.stopPropagation=function(l){var m=l||window.event;if(m.preventDefault){m.preventDefault()}if(m.stopPropagation){m.stopPropagation()}m.returnValue=false;m.cancelBubble=true};var b={LEFT:0,MIDDLE:1,RIGHT:2};e.EnumMouseButton=b;e.detectButton=function(l){var m=l||window.event;if(m.which==null){return(m.button<2)?b.LEFT:((m.button==4)?b.MIDDLE:b.RIGHT)}else{return(m.which<2)?b.LEFT:((m.which==2)?b.MIDDLE:b.RIGHT)}};e.fireEvent=function(l,m){var n;if(g.createEvent){n=g.createEvent("HTMLEvents");n.initEvent(l,TRUE,TRUE);if(m.dispatchEvent){m.dispatchEvent(n)}}else{if(g.createEventObject){n=g.createEventObject();n.bubbles=TRUE;n.cancelable=TRUE;m.fireEvent(l,n)}else{n=new Event(l);if(m.dispatchEvent){m.dispatchEvent(n)}}}}})(dynamsoft);(function(u,f,q){var n=window,k=/^(?:about|app|app\-storage|.+\-extension|file|widget)$/,z=1,G=2,e=3,K=200,b=204,j=300,w=304,p=404,g=1223,x=500,H=-1022,J="The local service (Dynamsoft Service) is disconnected.",B="open error: ",y="send error: ",h=new u.Uri(location.href),F=h&&k.test(h.getScheme()),I=false,l=function(){try{return new n.XMLHttpRequest}catch(M){}return q},A=function(){try{var M=false;u.each(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],function(O){try{return(M=new n.ActiveXObject(O))}catch(P){u.error("new xhr error: "+P.message)}});return M}catch(N){}return q},t=(!F&&n.XMLHttpRequest)?("withCredentials" in (l()||[])):false,E=n.ActiveXObject?function(M){if(f.bIE&&(parseInt(f.strBrowserVersion)<=9)){return A()}if(!t&&M&&I){return new I}return !F&&l()||A()}:l,r=function(M){return I&&(M instanceof I)},C={url:false,onSuccess:false,onError:false,onComplete:false,method:"GET",async:true,xhrFields:false,mimeType:false,username:false,password:false,data:false,dataType:"text",headers:false,contentType:"application/x-www-form-urlencoded; charset=UTF-8",beforeSend:false,afterSend:false,timeout:0,crossDomain:false},o=/^(?:GET|HEAD)$/,a=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,L={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},D=u.nil,m,d;if(f.bIE&&parseInt(f.strBrowserVersion)<=10){D=u.noop}m={setRequestHeader:function(N,O){var M=this;M.headers[N]=O;return M},getAllResponseHeaders:function(){var M=this;return M.state===G?M.responseHeadersString:null},getNativeXhr:function(){var M=this;return M.nativeXhr},getResponseHeader:function(O){var N,M=this,P;O=O.toLowerCase();if(M.state===G){if(!(P=M.responseHeaders)){P=M.responseHeaders={};while(N=a.exec(M.responseHeadersString)){P[N[1].toLowerCase()]=N[2]}}N=P[O]}return N===q?null:N},overrideMimeType:function(N){var M=this;if(!M.state){M.mimeType=N}return M},abort:function(N){var M=this;N=N||"abort";M.state=e;M.status=0;M.statusText=N;if(M.nativeXhr){M.nativeXhr.abort()}M._callback();return M},_ioReady:function(N,Q){var O=this,M;if(O.state===G||O.state===e){return}if(O.state===z){O.state=G}O.readyState=4;if(N>=K&&N<j||N===w){if(N===w){Q="not modified";M=true}else{Q="success";M=true}}else{if(N<0){N=0}}try{if(N>=K){O.handleResponseData()}}catch(P){u.error(P.stack||P,"error");Q=P.message||"parser error"}O.status=N;O.statusText=Q;O._callback(M)},_callback:function(M){var O=this,T=O.statusText,S;if(S=O.timeoutTimer){clearTimeout(S);O.timeoutTimer=0}var R=M?"onSuccess":"onError",Q,N=[O.responseData,T,O],P=O.context;Q=O[R];if(u.isFunction(Q)){Q.apply(P,N)}Q=O.onComplete;if(u.isFunction(Q)){Q.apply(P,N)}O.responseData=null},handleResponseData:function(){var O=this,M,N=O.dataType,Q=O.nativeXhr;if(N==="blob"||N==="arraybuffer"){M=!!n.Blob?Q.response:Q.responseBody}else{if(N=="json"){if(Q.responseType&&Q.responseType.toLowerCase()=="json"){M=Q.response}else{M=Q.responseText?((n.JSON&&n.JSON.parse)?n.JSON.parse(Q.responseText):u.parse(Q.responseText)):{}}}else{if(N==="user-defined"){M=Q.response!==q?Q.response:Q.responseText}else{O.responseText=M=Q.responseText||"";try{var P=Q.responseXML;if(P&&P.documentElement){O.responseXML=P}}catch(R){}}}}O.responseData=M},sendInternal:function(){var X=this,ab=X,T,N,O,aa,Y,Z,P,U,S,R;N=X.method;O=X.url;aa=X.dataType;P=X.mimeType;if(!u.isString(O)){return}ab.nativeXhr=Y=E(X.crossDomain);if(!Y){return}try{ab.state=z;if(X.username){Y.open(N,O,X.async,X.username,X.password)}else{Y.open(N,O,X.async)}if((X.async||f.bIE)&&aa&&aa!="user-defined"&&("responseType" in Y)){try{Y.responseType=aa}catch(V){}}}catch(W){if(ab.state<2){u.error(W.stack||W,"error");ab._ioReady(-1,B+(u.isNumber(W.number)?"("+W.number+")":"")+(W.message||""))}else{u.error(W)}return}Z=X.xhrFields||{};if("withCredentials" in Z){if(!t){delete Z.withCredentials}}for(T in Z){try{Y[T]=Z[T]}catch(V){u.error(V)}}if(P&&Y.overrideMimeType){Y.overrideMimeType(P)}U=X.headers||{};var Q=U["X-Requested-With"];if(Q===false){delete U["X-Requested-With"]}if(typeof Y.setRequestHeader!=="undefined"){if(X.contentType){Y.setRequestHeader("Content-Type",X.contentType)}Y.setRequestHeader("Accept",aa&&L[aa]?L[aa]+(aa==="*"?"":", */*; q=0.01"):L["*"]);for(T in U){Y.setRequestHeader(T,U[T])}}S=!o.test(X.method);R=S&&X.data||null;if(S&&f.bIE&&parseInt(f.strBrowserVersion)<10){R=X.data}if(X.async&&X.timeout>0){ab.timeoutTimer=setTimeout(function(){ab.abort("timeout")},X.timeout*1000)}try{ab.state=z;if(u.isFunction(ab.beforeSend)){var M=ab.beforeSend(Y,ab);if(M===false){ab.abort("cancel");return}}Y.send(R);R=null;X.data=null;if(u.isFunction(ab.afterSend)){ab.afterSend(ab)}}catch(V){if(ab.state<2){u.error(V.stack||V,"error");ab._ioReady(-1,y+(V.message||""))}else{u.error(V)}}if(!X.async||Y.readyState===4){ab._xhrCallback()}else{if(r(Y)){Y.onload=function(){Y.readyState=4;Y.status=K;ab._xhrCallback()};Y.onerror=function(){Y.readyState=4;Y.status=x;ab._xhrCallback()}}else{Y.onreadystatechange=function(){ab._xhrCallback()}}}},_xhrCallback:function(N,S){var O=this,P=O.nativeXhr;try{if(P.readyState===4||S){if(r(P)){P.onerror=D;P.onload=D}else{P.onreadystatechange=D}if(S){if(P.readyState!==4){P.abort()}}else{if(!r(P)){O.responseHeadersString=P.getAllResponseHeaders()}var M=P.status,R;try{R=P.statusText}catch(Q){u.error("xhr statusText error: ");u.error(Q);R=""}O._ioReady(M,R)}}}catch(Q){u.error(Q.stack||Q,"error");if(Q.errorCode===H){throw {errorCode:H,errorString:J,toString:function(){return this.errorCode+": "+this.errorString}}}P.onreadystatechange=D;if(!S){O._ioReady(-1,Q.message||"process error")}}},_setupCfg:function(Q){var N=this,M,P,S,O,R;O=Q.url;if(u.startsWith(O,"http://")||u.startsWith(O,"https://")){R=new u.Uri(O)}else{if(u.startsWith(O,"//")){Q.url=O="http:"+O}R=h.resolve(O)}if(!Q.dataType){M="text"}else{M=Q.dataType.toLowerCase()}Q.dataType=M;if(!Q.method){Q.method="GET"}else{Q.method=Q.method.toUpperCase()}if(!("crossDomain" in Q)){Q.crossDomain=!R.isSameOriginAs(h)}S=Q.headers;for(P in S){if(u.isUndefined(S[P])){delete S[P]}}u.mix(N,Q);N.state=z}};function s(N){var M=this;if(!N||!u.isString(N.url)){u.log("the url is error.");return}if(!(M instanceof s)){return new s(N)}u.mix(M,C);u.mix(M,m);if(N instanceof s){N=N.config}M.config=N;M.config.context=M;M._setupCfg(N);M.sendInternal()}s._strOpenErr=B;s._strSendErr=y;s._strConnectionToServiceLostString=J;d={ajax:s,io:{get:function(N,O,P,M){return new s({method:"GET",url:N,onSuccess:O,onError:P,dataType:M})},post:function(N,P,O,Q,M){return new s({method:"POST",data:P,url:N,onSuccess:O,onError:Q,dataType:M})},put:function(N,P,O,Q,M){return new s({method:"PUT",data:P,url:N,onSuccess:O,onError:Q,dataType:M})}}};u.mix(u,d)})(dynamsoft.lib,dynamsoft.navInfo);(function(j){var n=20180115;if(j._json_ver){if(j.isNumber(j._json_ver)&&j._json_ver>=n){return}}j._json_ver=n;var m=(function(){var r={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t",'"':'\\"'},q={},s=/["\b\f\n\r\t\x00-\x1f]/g,p=/\\\\|\\\/|\\b|\\f|\\n|\\r|\\t|\\"|\\u[0-9a-zA-Z]{4}/g;j.each(r,function(t,u){q[t]=u});q["\\/"]="/";q["\\\\"]="\\";return{quote:function(t){return'"'+t.replace(s,function(u){var w;if(!(w=r[u])){w="\\u"+("0000"+u.charCodeAt(0).toString(16)).slice(0-4)}return w})+'"'},unQuote:function(t){return t.slice(1,t.length-1).replace(p,function(u){var w;if(!(w=q[u])){w=String.fromCharCode(parseInt(u.slice(2),16))}return w})}}})();function b(p){return p<10?"0"+p:p}function k(s,r,w,t,x,q,p){var u=r[s];if(u&&typeof u==="object"){if(typeof u.toJSON==="function"){u=u.toJSON(s)}else{if(u instanceof Date){u=isFinite(u.valueOf())?u.getUTCFullYear()+"-"+b(u.getUTCMonth()+1)+"-"+b(u.getUTCDate())+"T"+b(u.getUTCHours())+":"+b(u.getUTCMinutes())+":"+b(u.getUTCSeconds())+"Z":null}else{if(u instanceof String||u instanceof Number||u instanceof Boolean){u=u.valueOf()}}}}if(w!==undefined){u=w.call(r,s,u)}switch(typeof u){case"number":return isFinite(u)?String(u):"null";case"string":return m.quote(u);case"boolean":return String(u);case"object":if(!u){return"null"}if(j.isArray(u)){return o(u,w,t,x,q,p)}return g(u,w,t,x,q,p)}return undefined}function g(H,B,s,G,F,u){var w=u;u+=G;var x,r,z,t;if(s!==undefined){x=s}else{x=j.keys(H)}var E=[];for(z=0,r=x.length;z<r;z++){t=x[z];var q=k(t,H,B,s,G,F,u);if(q!==undefined){var y=m.quote(t);y+=":";if(G){y+=" "}y+=q;E[E.length]=y}}var C;if(!E.length){C="{}"}else{if(!G){C="{"+E.join(",")+"}"}else{var A=",\n"+u;var D=E.join(A);C="{\n"+u+D+"\n"+w+"}"}}return C}function o(D,u,q,C,B,r){var s=r;r+=C;var A=[];var x=D.length;var w=0;while(w<x){var p=k(String(w),D,u,q,C,B,r);if(p===undefined){A[A.length]="null"}else{A[A.length]=p}++w}var y;if(!A.length){y="[]"}else{if(!C){y="["+A.join(",")+"]"}else{var t="\n,"+r;var z=A.join(t);y="[\n"+r+z+"\n"+s+"]"}}return y}j.stringify=function(s,p,r){var u="";var q,t;if(p){if(typeof p==="function"){t=p}else{if(j.isArray(p)){q=p}}}if(typeof r==="number"){r=Math.min(10,r);u=new Array(r+1).join(" ")}else{if(typeof r==="string"){u=r.slice(0,10)}}return k("",{"":s},t,q,u,[],"")};var d={},e={SHIFT_TYPE:1,REDUCE_TYPE:2,ACCEPT_TYPE:0,TYPE_INDEX:0,PRODUCTION_INDEX:1,TO_INDEX:2},a;d.yy={unQuote:m.unQuote};a=function(p){var q=this;q.rules=[];j.mix(q,p);q.resetInput(q.input)};a.prototype={constructor:function(p){var q=this;q.rules=[];j.mix(q,p);q.resetInput(q.input)},resetInput:function(p){j.mix(this,{input:p,matched:"",stateStack:[a.STATIC.INITIAL],match:"",text:"",firstLine:1,lineNumber:1,lastLine:1,firstColumn:1,lastColumn:1})},getCurrentRules:function(){var p=this,q=p.stateStack[p.stateStack.length-1],r=[];q=p.mapState(q);j.each(p.rules,function(s){var t=s.state||s[3];if(!t){if(q==a.STATIC.INITIAL){r.push(s)}}else{if(j.inArray(q,t)){r.push(s)}}});return r},pushState:function(p){this.stateStack.push(p)},popState:function(){return this.stateStack.pop()},getStateStack:function(){return this.stateStack},showDebugInfo:function(){var r=this,t=a.STATIC.DEBUG_CONTEXT_LIMIT,p=r.matched,s=r.match,q=r.input;p=p.slice(0,p.length-s.length);var w=(p.length>t?"...":"")+p.slice(-t).replace(/\n/," "),u=s+q;u=u.slice(0,t)+(u.length>t?"...":"");return w+u+"\n"+new Array(w.length+1).join("-")+"^"},mapSymbol:function(r){var p=this,q=p.symbolMap;if(!q){return r}return q[r]||(q[r]=(++p.symbolId))},mapReverseSymbol:function(q){var p=this,s=p.symbolMap,r,t=p.reverseSymbolMap;if(!t&&s){t=p.reverseSymbolMap={};for(r in s){t[s[r]]=r}}if(t){return t[q]}else{return q}},mapState:function(r){var p=this,q=p.stateMap;if(!q){return r}return q[r]||(q[r]=(++p.stateId))},lex:function(){var A=this,y=A.input,s,x,p,u,B,z=A.getCurrentRules();A.match=A.text="";if(!y){return A.mapSymbol(a.STATIC.END_TAG)}for(s=0;s<z.length;s++){x=z[s];var w=x.regexp||x[1],q=x.token||x[0],r=x.action||x[2]||undefined;if(p=y.match(w)){B=p[0].match(/\n.*/g);if(B){A.lineNumber+=B.length}j.mix(A,{firstLine:A.lastLine,lastLine:A.lineNumber+1,firstColumn:A.lastColumn,lastColumn:B?B[B.length-1].length-1:A.lastColumn+p[0].length});var t;t=A.match=p[0];A.matches=p;A.text=t;A.matched+=t;u=r&&r.call(A);if(u===undefined){u=q}else{u=A.mapSymbol(u)}y=y.slice(t.length);A.input=y;if(u){return u}else{return A.lex()}}}j.error("lex error at line "+A.lineNumber+":\n"+A.showDebugInfo());return undefined}};a.STATIC={INITIAL:"I",DEBUG_CONTEXT_LIMIT:20,END_TAG:"$EOF"};var f=new a({rules:[[2,/^"(\\"|\\\\|\\\/|\\b|\\f|\\n|\\r|\\t|\\u[0-9a-zA-Z]{4}|[^\\"\x00-\x1f])*"/,0],[0,/^[\t\r\n\x20]/,0],[3,/^,/,0],[4,/^:/,0],[5,/^\[/,0],[6,/^\]/,0],[7,/^\{/,0],[8,/^\}/,0],[9,/^-?\d+(?:\.\d+)?(?:e-?\d+)?/i,0],[10,/^true|false/,0],[11,/^null/,0],[12,/^./,0]]});d.lexer=f;f.symbolMap={"$EOF":1,STRING:2,COMMA:3,COLON:4,LEFT_BRACKET:5,RIGHT_BRACKET:6,LEFT_BRACE:7,RIGHT_BRACE:8,NUMBER:9,BOOLEAN:10,NULL:11,INVALID:12,"$START":13,json:14,value:15,object:16,array:17,elementList:18,member:19,memberList:20};d.productions=[[13,[14]],[14,[15],function(){return this.$1}],[15,[2],function(){return this.yy.unQuote(this.$1)}],[15,[9],function(){return parseFloat(this.$1)}],[15,[16],function(){return this.$1}],[15,[17],function(){return this.$1}],[15,[10],function(){return this.$1==="true"}],[15,[11],function(){return null}],[18,[15],function(){return[this.$1]}],[18,[18,3,15],function(){this.$1[this.$1.length]=this.$3;return this.$1}],[17,[5,6],function(){return[]}],[17,[5,18,6],function(){return this.$2}],[19,[2,4,15],function(){return{key:this.yy.unQuote(this.$1),value:this.$3}}],[20,[19],function(){var p={};p[this.$1.key]=this.$1.value;return p}],[20,[20,3,19],function(){this.$1[this.$3.key]=this.$3.value;return this.$1}],[16,[7,8],function(){return{}}],[16,[7,20,8],function(){return this.$2}]];d.table={gotos:{"0":{"14":7,"15":8,"16":9,"17":10},"2":{"15":12,"16":9,"17":10,"18":13},"3":{"19":16,"20":17},"18":{"15":23,"16":9,"17":10},"20":{"15":24,"16":9,"17":10},"21":{"19":25}},action:{"0":{"2":[1,0,1],"5":[1,0,2],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"1":{"1":[2,2,0],"3":[2,2,0],"6":[2,2,0],"8":[2,2,0]},"2":{"2":[1,0,1],"5":[1,0,2],"6":[1,0,11],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"3":{"2":[1,0,14],"8":[1,0,15]},"4":{"1":[2,3,0],"3":[2,3,0],"6":[2,3,0],"8":[2,3,0]},"5":{"1":[2,6,0],"3":[2,6,0],"6":[2,6,0],"8":[2,6,0]},"6":{"1":[2,7,0],"3":[2,7,0],"6":[2,7,0],"8":[2,7,0]},"7":{"1":[0,0,0]},"8":{"1":[2,1,0]},"9":{"1":[2,4,0],"3":[2,4,0],"6":[2,4,0],"8":[2,4,0]},"10":{"1":[2,5,0],"3":[2,5,0],"6":[2,5,0],"8":[2,5,0]},"11":{"1":[2,10,0],"3":[2,10,0],"6":[2,10,0],"8":[2,10,0]},"12":{"3":[2,8,0],"6":[2,8,0]},"13":{"3":[1,0,18],"6":[1,0,19]},"14":{"4":[1,0,20]},"15":{"1":[2,15,0],"3":[2,15,0],"6":[2,15,0],"8":[2,15,0]},"16":{"3":[2,13,0],"8":[2,13,0]},"17":{"3":[1,0,21],"8":[1,0,22]},"18":{"2":[1,0,1],"5":[1,0,2],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"19":{"1":[2,11,0],"3":[2,11,0],"6":[2,11,0],"8":[2,11,0]},"20":{"2":[1,0,1],"5":[1,0,2],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"21":{"2":[1,0,14]},"22":{"1":[2,16,0],"3":[2,16,0],"6":[2,16,0],"8":[2,16,0]},"23":{"3":[2,9,0],"6":[2,9,0]},"24":{"3":[2,12,0],"8":[2,12,0]},"25":{"3":[2,14,0],"8":[2,14,0]}}};d.parse=function h(A){var C=this,p=C.lexer,u,H,G,K=C.table,D=K.gotos,t=K.action,s=C.productions,w=[null],x=[0];p.resetInput(A);while(1){u=x[x.length-1];if(!H){H=p.lex()}if(!H){j.log("it is not a valid input: "+A,"error");return false}G=t[u]&&t[u][H];if(!G){var y=[],F;if(t[u]){j.each(t[u],function(N,O){y.push(C.lexer.mapReverseSymbol(O))})}F="Syntax error at line "+p.lineNumber+":\n"+p.showDebugInfo()+"\nexpect "+y.join(", ");j.log(F);return false}switch(G[e.TYPE_INDEX]){case e.SHIFT_TYPE:x.push(H);w.push(p.text);x.push(G[e.TO_INDEX]);H=null;break;case e.REDUCE_TYPE:var L=s[G[e.PRODUCTION_INDEX]],B=L.symbol||L[0],r=L.action||L[2],E=L.rhs||L[1],J=E.length,I=0,M,z=w[w.length-J];C.$$=z;M=undefined;for(;I<J;I++){C["$"+(J-I)]=w[w.length-1-I]}if(r){M=r.call(C)}if(M!==undefined){z=M}else{z=C.$$}if(J){x=x.slice(0,-1*J*2);w=w.slice(0,-1*J)}x.push(B);w.push(z);var q=D[x[x.length-2]][x[x.length-1]];x.push(q);break;case e.ACCEPT_TYPE:return z}}return undefined};j.parser=d;function l(y,q,z){var t=y[q],u,x,w;if(typeof t==="object"){if(j.isArray(t)){u=0;x=t.length;var s=[];while(u<x){w=l(t,String(u),z);if(w!==undefined){s[s.length]=w}}t=s}else{var A=j.keys(t);for(u=0,x=A.length;u<x;u++){var r=A[u];w=l(t,r,z);if(w===undefined){delete t[r]}else{t[r]=w}}}}return z.call(y,q,t)}j.parse=function(t,p){var s=window,r=s.JSON;if(r&&r.parse){return r.parse(String(t))}var q=d.parse(String(t));if(p){return l({"":q},"",p)}else{return q}}})(dynamsoft.lib);(function(k,e){var h=20180115;if(k._dialog_ver){if(k.isNumber(k._dialog_ver)&&k._dialog_ver>=h){return}}k._dialog_ver=h;var f=window,t=document,j=!0,p=!1,n={},l=(e.bIE&&e.IEMode<8),g=l&&(e.IEMode<7),m=500000,a=1000,b=function(u){var y,x,w;y=t.body.scrollTop||t.documentElement.scrollTop;if(f.innerHeight){w=f.innerHeight}else{w=t.documentElement.clientHeight}x=y+(w-u.offsetHeight)/2;u.style.top=x+"px";u._dlgInfo.isTopOverridden=j},o=function(u,x){for(var w=0;w<u.length;++w){if(u[w]==x){return j}}return p},q=function(y){for(var z=0;z<t.styleSheets.length;++z){var E=t.styleSheets[z],B=p,w=p,D,F;try{B=E.cssRules;w=t.querySelectorAll}catch(A){}if(B&&w){for(var x=0;x<B.length;++x){D=B[x];F=p;try{F=w(D.selectorText)}catch(A){}if(F&&o(F,y)){var u=D.style.getPropertyValue("top"),C=D.style.getPropertyValue("bottom");if((u&&u!="auto")||(C&&C!="auto")){return j}}}}}return p},r=function(w){var u=p;if(f.getComputedStyle){u=f.getComputedStyle(w)}else{if(w.currentStyle){u=w.currentStyle}}if(u&&u.position!="absolute"){return p}if((w.style.top!="auto"&&w.style.top!="")||(w.style.bottom!="auto"&&w.style.bottom!="")){return p}return !q(w)};n.showDialog=function(A){var B=this,x;if(B.open){k.error("showDialog called on open dialog.");return}B.open=j;B.setAttribute("open","open");if(l){x=g?t.body:t.documentElement;B._dlgInfo.docOverflow=x.style.overflow;x.style.overflow="hidden"}if(r(B)){b(B)}if(A){B._dlgInfo.modal=j;n.dm.pushDialog(B);if(l){var w,u,z=p,y=p;w=B.currentStyle.left;u=B.currentStyle.top;if(w==="auto"){if(g){B.style.textAlign="center"}w=(x.clientWidth-B.currentStyle.width)/2}else{if(w.indexOf("%")>0){z=w;w=Number(w.replace("%","")*x.clientWidth/100)}else{w=Number(w.replace("px",""))}}if(!(w>0)){w=0}if(u==="auto"){u=(x.clientHeight-B.currentStyle.height)/2}else{if(u.indexOf("%")>0){y=u;u=Number(u.replace("%","")*x.clientHeight/100)}else{u=Number(u.replace("px",""))}}if(!(u>0)){u=0}setTimeout(function(){var D=B.style,C=B._dlgInfo.mask;C.style.backgroundColor="#000";C.style.filter="alpha(opacity=30)";D.position="absolute";D.left=w+"px";D.top=u+"px"},0);B._scrollFn=function(){var D=x.scrollTop+"px",G=x.scrollLeft+"px",C=n.dm.overlay,F=B._dlgInfo.mask,E=B.style;if((u+x.scrollTop+x.clientHeight)<x.scrollHeight){E.top=u+x.scrollTop+"px"}else{E.top=D}if(C){C.style.top=D}if(F){F.style.top=D}E.left=G;if(C){C.style.left=G}if(F){F.style.left=G}setTimeout(function(){B._resizeFn()},100)};B._resizeFn=function(){var G=g?t.body:t.documentElement,E=G.clientWidth+"px",F=G.clientHeight+"px",C=n.dm.overlay,D=B._dlgInfo.mask;C.style.width=E;if(D){D.style.width=E}C.style.height=F;if(D){D.style.height=F}setTimeout(function(){var I,K,H=B.style,J=g?t.body:t.documentElement;if(z){I=Number(z.replace("%","")*J.clientWidth/100);H.left=I+"px"}if(y){K=Number(y.replace("%","")*J.clientHeight/100);H.top=K+"px"}},0)};B._scrollFn();f.attachEvent("onscroll",B._scrollFn);f.attachEvent("onresize",B._resizeFn)}}};n.closeDialog=function(u){var x=this;if(!x.open){k.error("closeDialog called on closed dialog.")}x.open=p;x.removeAttribute("open");if(l){var w=g?t.body:t.documentElement;w.style.overflow=x._dlgInfo.docOverflow}if(typeof u!="undefined"){x.returnValue=u}if(x._dlgInfo.isTopOverridden){x.style.top="auto"}if(x._dlgInfo.modal){if(l){f.detachEvent("onscroll",x._scrollFn);f.detachEvent("onresize",x._resizeFn)}n.dm.removeDialog(this)}return x.returnValue};n.createMouseEvent=function(w){var u=t.createEvent("MouseEvents");u.initMouseEvent(w.type,w.bubbles,w.cancelable,f,w.detail,w.screenX,w.screenY,w.clientX,w.clientY,w.ctrlKey,w.altKey,w.shiftKey,w.metaKey,w.button,w.relatedTarget);return u};n.setup=function(u){var w=this;u.show=w.showDialog.bind(u,p);u.showModal=w.showDialog.bind(u,j);u.close=w.closeDialog.bind(u);u._dlgInfo={}};var s=function(){var w=this,u;w.pendingDialogStack=[];w.overlay=t.createElement(l?"iframe":"div");u=w.overlay.style;u.position=l?"absolute":"fixed";u.display="block";u.left=u.top=u.margin=u.padding=0;u.backgroundColor="#000";u.filter="alpha(opacity=30)";u.opacity=u.MozOpacity=0.3;u.zIndex=m;u.width="100%";if(l&&t.documentElement.clientHeight>0){u.height=t.documentElement.clientHeight+"px"}else{u.height="100%"}if(t.createEvent){k.addEventListener(w.overlay,"click",function(x){var y=n.createMouseEvent(x);t.body.dispatchEvent(y)})}},d=s.prototype;d._blockDocument=function(){if(!t.body.contains(this.overlay)){t.body.appendChild(this.overlay)}};d._unblockDocument=function(){t.body.removeChild(this.overlay)};d._updateStacking=function(){var z=this,u,x,w,y;x=z.pendingDialogStack;if(x.length==0){z._unblockDocument();return}z._blockDocument();y=m;k.each(x,function(A){y++;A._dlgInfo.mask.style.zIndex=y++;A.style.zIndex=y})};d.pushDialog=function(w){var x=this,u;if(x.pendingDialogStack.length>=a){k.error("Too many modal dialogs.");return}u=t.createElement("div");u.className="dynamsoft-backdrop";if(l){u.style.position="absolute"}if(t.createEvent){k.addEventListener(u,"click",function(y){if(w.dispatchEvent){var z=n.createMouseEvent(y);w.dispatchEvent(z)}})}w.parentNode.insertBefore(u,w.nextSibling);w._dlgInfo.mask=u;x.pendingDialogStack.push(w);x._updateStacking()};d.removeDialog=function(x){var y=this,w,u;w=k.isArray(y.pendingDialogStack)?y.pendingDialogStack.indexOf(x):-1;if(w==-1){return}y.pendingDialogStack.splice(w,1);u=x._dlgInfo.mask;u.parentNode.removeChild(u);x._dlgInfo.mask=null;y._updateStacking()};n.dm=new s();k.dialog=n})(dynamsoft.lib,dynamsoft.navInfo);(function(d,e){d.navInfo=dynamsoft.navInfo;d._uiMaxSize=100000;d.resourcesPath=d.resourcesPath||"DCSResources";d._dwsObjClientIdPrefix="dwsObject_";d._imgViewerClientIdPrefix="imageViewer_";d._dcoEditorClientIdPrefix="documentEditor_";d._getInstallPackageUrl=function(){if(d.navInfo.bWin){return d.resourcesPath+"/DynamsoftServiceSetup.exe"}else{if(d.navInfo.bMac){return d.resourcesPath+"/DynamsoftServiceSetup.pkg"}}return""};d._getProductKey=function(){return e.isString(d.productKey)?d.productKey:""};var a="6, 1, 0, 0907";var b=4;d._getFrontendSdkVersion=function(){return a};d._getFrontendSdkVersionWithDot=function(){var f=a;f=f.split(",").join(".");return f.split(" ").join("")};d._getFrontendSdkVersionWithoutComma=function(){var f=a;f=f.split(",").join("");return f.split(" ").join("")};d._getVersionStrForCommand=function(){var f=d._getFrontendSdkVersionWithoutComma();return["dcs/dcs_",d.bTrial?"trial_":"",f].join("")};d._enumSdkVersionComparisonResult={Unknown:0,Equal:1,FrontendHigher:2,BackendHigher:3,FrontendMiniVersionHigher:4,BackendMiniVersionHigher:5};d._getVersionInfoAry=function(f){if(!e.isString(f)){return null}var h=",";var j=f.split(h);if(isNaN(parseInt(j[0]))){return null}for(var g=0;g<b;g++){j[g]=parseInt(j[g]);if(isNaN(j[g])){j[g]=0}}return j};d._getSdkVersionComparisonResult=function(h){var k=d._enumSdkVersionComparisonResult,j=d._getVersionInfoAry(d._getFrontendSdkVersion()),l=d._getVersionInfoAry(h),f=k.Unknown;if(j===null||l===null){return f}if(j[0]>l[0]){f=k.FrontendHigher}else{if(j[0]<l[0]){f=k.BackendHigher}else{for(var g=1;g<b;g++){if(j[g]>l[g]){f=k.FrontendMiniVersionHigher;break}else{if(j[g]<l[g]){f=k.BackendMiniVersionHigher;break}}}}}if(f===k.Unknown){f=k.Equal}return f}})(dynamsoft.dcsEnv,dynamsoft.lib);dynamsoft.lib.ready(function(){dynamsoft.lib.install={_divInstallBody:"dwt-InstallBody",_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:false,bNeedUpgrade:false};dynamsoft.lib.install._strDynamsoftWithClose=['<div style="height:40px;width:350px;position:relative;">','<span><div class="DYNLogo" ','alt="Dynamsoft Corporation" border="0"></div>',"</span>",'<div style="height:30px;padding-left:205px; position:absolute; top:0; left:120px">','<a href="javascript: void(0)" style="text-decoration:none; padding:15px" class="ClosetblCanNotScan">X</a>',"</div></div>"].join("");dynamsoft.lib.install._strNonInstallDIV=['<div style="border:1px solid #CCCCCC;text-align:center;" id="',dynamsoft.lib.install._divDWTNonInstallContainerID,'"></div>'].join("")});function dynamsoft_onClickInstallButton(){var a=dynamsoft.lib.get("dwt-btn-install");if(a){a.style.display="none"}}dynamsoft.dcsEnv.showInstallDialog=function(b){var a;if(!b){a=['<div class="dwt-box-title"></div>','<div style="font-size: 14px;">',"This page is using a newer version of Dynamsoft Camera SDK than your local copy. Please download and upgrade now.","</div>",'<a id="dwt-btn-install" target="_blank" href="',dynamsoft.dcsEnv._getInstallPackageUrl(),'" onclick="dynamsoft_onClickInstallButton()"><div class="dwt-button"></div></a>','<div style="text-align:center"><i>* Please manually install it</i></div><p></p>']}else{a=['<div class="dwt-box-title">',"Dynamsoft Camera SDK ",parseInt(dynamsoft.dcsEnv._getFrontendSdkVersion())," is not installed</div>",'<div style="margin:20px;text-align:center"><a id="dwt-btn-install" target="_blank" href="',dynamsoft.dcsEnv._getInstallPackageUrl(),"",'" onclick="dynamsoft_onClickInstallButton()"><div class="dwt-button"></div></a>',"<i>* Please manually install it</i></div>"]}a.push("<div>");a.push("If you still see the dialog after the installation,<br />");a.push('please check <a target="_blank" href="http://developer.dynamsoft.com/dws/why-is-the-browser-prompting-me-to-install-dynamsoft-webcam-service-repeatedly">this article</a> for troubleshooting.');a.push("</div>");if(dynamsoft.dcsEnv.navInfo.bFirefox&&dynamsoft.dcsEnv.navInfo.bSSL){a.push('<div class="dwt-red" style="padding-top: 10px;">After installation, please RESTART your browser.</div>')}dynamsoft.dcsEnv.ShowDialog(392,230,a.join(""))};dynamsoft.dcsEnv.ShowDialog=function(e,g,h,a){var k,j=dynamsoft.lib.get("J_waiting");if(j){j.parentNode.removeChild(j)}var b=document.createElement("div");b.className="ds-dialog-wrap";b.style.width="100%";if(a){k=['<div id="J_waiting" class="ds-dialog" style="width:455px;">','<div class="ks-dialog-header"></div>','<div class="ks-dialog-body">','<div class="ks-dialog-content"><div id="',dynamsoft.lib.install._divInstallBody,'"></div></div></div>','<div class="ks-dialog-footer"></div>',"</div>"]}else{k=['<div id="J_waiting" class="ds-dialog">','<div class="ks-dialog-header"></div>','<div class="ks-dialog-body">','<div class="ks-dialog-content"><div id="',dynamsoft.lib.install._divInstallBody,'"></div></div></div>','<div class="ks-dialog-footer"></div>',"</div>"]}b.innerHTML=k.join("");if(a){var d=dynamsoft.lib.one(".D_ImageUIEditor")[0].parentNode;d.appendChild(b)}else{document.body.appendChild(b)}dynamsoft.lib.install._dlgFromImageEditor=a;dynamsoft.lib.install._dlgInstall=b;dynamsoft.lib.dialog.setup(dynamsoft.lib.install._dlgInstall);if(h===false){return}if(a){dynamsoft.lib.get(dynamsoft.lib.install._divInstallBody).innerHTML=['<div class="ds-dialog-body" style="height:'+g+"px;width:"+e+'px">',h,"</div>"].join("")}else{dynamsoft.lib.get(dynamsoft.lib.install._divInstallBody).innerHTML=['<div class="ds-dialog-body" style="height:'+g+'px">',dynamsoft.lib.install._strDynamsoftWithClose,h,"</div>"].join("")}j=dynamsoft.lib.get("J_waiting");j.style.width=e;dynamsoft.lib.install._dlgInstall.showModal();for(var f=0;f<document.links.length;f++){if(document.links[f].className=="ClosetblCanNotScan"){document.links[f].onclick=Dynamsoft__OnclickCloseInstallEx}}};dynamsoft.dcsEnv.OnDwsPreExecute=function(){dynamsoft.lib.detect.OnDwsPreExecute()};dynamsoft.dcsEnv.OnDwsPostExecute=function(){dynamsoft.lib.detect.OnDwsPostExecute()};function Dynamsoft__OnclickCloseInstallEx(a){var g=a||window.event;if(g){dynamsoft.lib.stopPropagation(g)}if(!dynamsoft.lib.install){return}var f=dynamsoft.lib.install._dlgInstall;if(f){f.close();if(dynamsoft.lib.install._dlgFromImageEditor){var d=dynamsoft.lib.one(".D_ImageUIEditor")[0].parentNode;d.removeChild(f)}else{document.body.removeChild(f)}dynamsoft.lib.install._dlgInstall=false}dynamsoft.lib.install.bNeedUpgrade=false;var b=dynamsoft.lib.get(dynamsoft.lib.install._divDWTNonInstallContainerID);if(b){b.parentNode.removeChild(b)}}(function(){dynamsoft.lib.mix(dynamsoft.lib.detect,{global_dlg:false,__dialog:false});dynamsoft.lib.detect.showMask=function(){if(!dynamsoft.dcsEnv.ScanDirectly){if(dynamsoft.lib.isFunction(OnDwsPreExecuteCallback)){OnDwsPreExecuteCallback()}else{dynamsoft.lib.detect.OnDwsPreExecute()}}};dynamsoft.lib.detect.OnDwsPreExecute=function(){if(dynamsoft.lib.detect.__dialog){return}var d=[dynamsoft.dcsEnv.resourcesPath,"/reference/loading.gif"].join(""),b=['<div style="margin:0 auto;width:100px;line-height:300px"><img src="',d,'" /></div>'].join("");var a=document.createElement("div");a.className="ds-dialog-wrap";a.innerHTML=b;document.body.appendChild(a);dynamsoft.lib.detect.__dialog=a;dynamsoft.lib.dialog.setup(dynamsoft.lib.detect.__dialog);dynamsoft.lib.detect.__dialog.showModal()};dynamsoft.lib.detect.hideMask=function(){if(!dynamsoft.dcsEnv.ScanDirectly){if(dynamsoft.lib.isFunction(OnDwsPostExecuteCallback)){OnDwsPostExecuteCallback()}else{dynamsoft.lib.detect.OnDwsPostExecute()}}};dynamsoft.lib.detect.OnDwsPostExecute=function(){var a=dynamsoft.lib.detect.__dialog;if(a){a.close();document.body.removeChild(a);dynamsoft.lib.detect.__dialog=false}}})();(function(g,d,b){var f=dynamsoft.navInfo,j=f.host,e,a,h=20180115,k=function(){if(dynamsoft.dcp){var l=dynamsoft.dcp.dcpJSVer;if(g.isNumber(l)){return l>=h}}return false};if(!d){d=dynamsoft.managerEnv={}}d.resourcesPath=d.resourcesPath||"Resources";d.IfUpdateService=d.IfUpdateService?true:false;if(k()){k=b;h=b;return}a={dcpStatus:0,bConnected:false,curPortIndex:0,bTrial:false,bConnectNumLimited:true,IMAXCONNECTCOUNT:2,EnumDCP_DetectStatus:{Init:0,Connected:1,DownloadingZip:2,DownloadedZip:3,DownloadFailed:4,CheckingManagerVer:15,CheckingServiceVer:16,NotInstalled:17,CheckedService:5,VerifyingZip:6,VerifiedZip:7,UpdatingService:8,UpdateSucceed:9,UpdateFailed:10,UpdateSkipped:11}};dynamsoft.dcp=e={ip:"127.0.0.1",ports:[[18625,18626],[18993,18994]],dcpJSVer:h,oldDWASMVerStr:"dwasm_13000404",oldDWASMVer:[13,0,0,"0404"],managerVersion:[13,3,0,"0115"],serviceVersion:[1,3,0,"0115"],detect:a,versionInfo:function(o){var n=0,l=function(p){if(g.isArray(p)&&p.length>1&&p[0]&&p[1]){a.curPort=e.ports[n%e.ports.length];var q=p[0].split(","),s=p[1].toLowerCase();if(e._compareVersion(q,e.oldDWASMVer)){a.bConnected=true;a.dcpStatus=a.EnumDCP_DetectStatus.Connected;e._sendStatusEvent(false,p[0]);if(g.isFunction(o)){setTimeout(o,0)}return true}}return false},m=function(q,r,p){++n;a.curPortIndex=n%e.ports.length;a.bConnected=false;if(a.bConnectNumLimited&&n>=a.IMAXCONNECTCOUNT){setTimeout(function(){o(q,r,p)},0);return true}return false};a.dcpStatus=a.EnumDCP_DetectStatus.CheckingManagerVer;this._postBase("VersionInfo",true,l,m)},_checkOldManagerVersion:function(m,l){a.dcpStatus=a.EnumDCP_DetectStatus.CheckingManagerVer;this._postBase("VersionInfo",true,m,l)},_checkManagerVersion:function(m,l){a.dcpStatus=a.EnumDCP_DetectStatus.CheckingManagerVer;this._postBase("VersionInfo",false,m,l)},_checkService:function(m,l){a.dcpStatus=a.EnumDCP_DetectStatus.CheckingServiceVer;this._postBase("DSVersion",false,m,l)},_checkUpdateFile:function(m,l){this._postBase("CheckUpdateFile",false,m,l)},_updateService:function(m,l){this._postBase("UpdateService",false,m,l)},_postBase:function(m,q,o,n){var p,r,l;if(!g.isFunction(o)||!g.isFunction(n)){return}p=function(w,t){var s=[e._getPreUrl(a.curPortIndex),q?"dcp/":e._getModuleName(),q?e.oldDWASMVerStr:e._getModuleVer(),"/",m,"?type=1&dsver=",e.serviceVersion.join(""),"&ts=",g.now()].join(""),u,x;if(q){x=e.oldDWASMVerStr}else{x="dwasm2_"+e._getModuleVer()}u=g.stringify({id:"1",method:m,version:x,parameter:[]});g.ajax({method:"POST",url:s,data:u,onSuccess:w,onError:t})};r=function(t,u,s){if(n(t,u,s)){return}setTimeout(function(){p(l,r)},1000)};l=function(t,w,s){var u=e._getJSON(t);if(u&&"result" in u){if(o(u.result)){return}}r(t,w,s)};p(l,r)},loadZip:function(l,o,n,p){var m;if(dynamsoft.managerEnv.IfUpdateService){m=[e._getPreUrl(a.curPortIndex),e._getModuleName(),e._getModuleVer(),"/LoadZipFromBytes?type=",o,"&dsver=",e.serviceVersion.join(""),"&ts=",g.now()].join("")}else{m=[e._getPreUrl(a.curPortIndex),"dcp/",e.oldDWASMVerStr,"/LoadZipFromBytes?type=0","&dsver=",e.serviceVersion.join(""),"&ts=",g.now()].join("")}new g.ajax({method:"POST",url:m,async:true,data:l,onSuccess:n,onError:p})},oldLoadZip:function(m,l,o,p){var n=[e._getPreUrl(a.curPortIndex),"dcp/",e.oldDWASMVerStr,"/LoadZipFromBytes?type=0","&dsver=",e.serviceVersion.join(""),"&ts=",g.now()].join("");new g.ajax({method:"POST",url:n,async:true,data:m,onSuccess:o,onError:p})},_getPreUrl:function(o){var l,m;if(f.bSSL){m="https://";l=e.ports[o][1]}else{m="http://";l=e.ports[o][0]}return[m,e.ip,":",l,"/"].join("")},_getJSON:function(l){return l?g.parse(l):!1},_getModuleName:function(){return"dcp/dwasm2_"},_getModuleVer:function(){return e.managerVersion.join("")},_compareVersion:function(m,l){if(g.isArray(m)&&m.length==4&&g.isArray(l)&&l.length>=4){return m[0]>l[0]||m[0]==l[0]&&m[1]>l[1]||m[0]==l[0]&&m[1]==l[1]&&m[2]>l[2]||m[0]==l[0]&&m[1]==l[1]&&m[2]==l[2]&&parseInt(m[3])>=parseInt(l[3])}else{if(g.isArray(m)&&m.length==1&&g.isArray(l)&&l.length>=1){return parseInt(m[0])>=parseInt(l[0])}}return false},_getDSUpdateZipUrl:function(){var m=dynamsoft.navInfo,n,l;n="Win";if(m.bMac){n="Mac"}else{if(m.bLinux){n="Linux"}}if(m.bFileSystem){l=""}else{l="?t="+g.now()}return[dynamsoft.managerEnv.resourcesPath,"/",n,"DSUpdate_",e.managerVersion.join("."),".zip",l].join("")},checkDcpForUpdate:function(q,l,s,t,o,n,D){var r=false,F=true,B=3,m=0,y=function(I){if(!(g.isArray(I)&&I.length>0&&I[0])){return false}var J=I[0].split(",");if(!dynamsoft.managerEnv.IfUpdateService){a.bConnected=true;a.dcpStatus=a.EnumDCP_DetectStatus.UpdateSkipped;s&&s();e._sendStatusEvent();setTimeout(D,0)}else{if(e._compareVersion(J,e.oldDWASMVer)){var H=e._getDSUpdateZipUrl();r=true;var L=function(M){a.dcpStatus=a.EnumDCP_DetectStatus.DownloadedZip;e._sendStatusEvent();var N=0;e.oldLoadZip(M,N,function(){setTimeout(function(){e._checkManagerVersion(u,p)},5000)},K)},K=function(N,O,M){e._funUpdateFailed(o,n,N,M.status);setTimeout(D,0)},G=function(N,P,M){a.dcpStatus=a.EnumDCP_DetectStatus.DownloadFailed;o&&o();var Q=M.status,O;if(Q==200){O=N}else{O="The update package can't be downloaded. The error code is "+Q+"."}n&&n(true,O);e._sendStatusEvent(true,O);setTimeout(D,0)};s&&s();t&&t();a.dcpStatus=a.EnumDCP_DetectStatus.DownloadingZip;e._sendStatusEvent();new g.ajax({method:"GET",url:H,async:true,dataType:"blob",onSuccess:L,onError:G})}else{if(F){a.dcpStatus=a.EnumDCP_DetectStatus.NotInstalled;s&&s();q&&q(responseData,statusText);e._sendStatusEvent();F=false}}}return true},w=function(G,H){++m;a.curPortIndex=m%e.ports.length;a.bConnected=false;if(a.bConnectNumLimited&&m>=a.IMAXCONNECTCOUNT){if(F){a.dcpStatus=a.EnumDCP_DetectStatus.NotInstalled;s&&s();q&&q(G,H);e._sendStatusEvent();F=false}}else{setTimeout(function(){e._checkOldManagerVersion(y,w)},1000)}return true},u=function(G){if(!(g.isArray(G)&&G.length>0&&G[0])){return false}var H=G[0].split(",");if(e._compareVersion(H,e.managerVersion)){if(dynamsoft.managerEnv.IfUpdateService){if(r){setTimeout(function(){e._checkUpdateZip(t,o,n,D)},0)}else{setTimeout(function(){e._checkService(E,x)},0)}}else{a.dcpStatus=a.EnumDCP_DetectStatus.UpdateSkipped;e._sendStatusEvent();setTimeout(D,0)}return true}return false},p=function(I,J,H){var G=1000;if(B<3){G=500}B--;if(B<0){e._funShowUpgradeDialogWhenUpdateFailed(o,n);setTimeout(D,0)}else{setTimeout(function(){e._checkManagerVersion(u,p)},G)}return true},E=function(H){if(!(g.isArray(H)&&H.length>0&&H[0])){return false}var G=H[0].split(",");if(e._compareVersion(G,e.serviceVersion)){a.bConnected=true;o&&o();a.dcpStatus=a.EnumDCP_DetectStatus.CheckedService;e._sendStatusEvent(false,H[0]);a.dcpStatus=a.EnumDCP_DetectStatus.UpdateSucceed;e._sendStatusEvent();setTimeout(D,0)}else{setTimeout(function(){e._checkUpdateZip(t,o,n,D)},0)}return true},x=function(H,I,G){e._funUpdateFailed(o,n,H,G.status);setTimeout(D,0);return true};var A=false,C=function(G){if(!(g.isArray(G)&&G.length>0&&G[0])){return false}var H=G[0].split(",");if(e._compareVersion(H,e.oldDWASMVer)){A=true;a.curPort=e.ports[m%e.ports.length];if(!dynamsoft.managerEnv.IfUpdateService){a.dcpStatus=a.EnumDCP_DetectStatus.UpdateSkipped;s&&s();e._sendStatusEvent();setTimeout(D,0)}else{s&&s();setTimeout(function(){e._checkService(E,x)},0)}}else{m=0;a.curPortIndex=0;setTimeout(function(){e._checkOldManagerVersion(y,w)},1000)}return true},z=function(G,H){++m;a.curPortIndex=m%e.ports.length;a.bConnected=false;if(a.bConnectNumLimited&&m>=a.IMAXCONNECTCOUNT){m=0;a.curPortIndex=0;setTimeout(function(){e._checkOldManagerVersion(y,w)},1000)}else{setTimeout(function(){e._checkManagerVersion(C,z)},1000)}return true};l&&l();e._checkManagerVersion(C,z)},_checkUpdateZip:function(p,w,o,x){var q=function(B,C,A){var D=-1;if(A){D=A.status}if(D==0){setTimeout(function(){e._checkService(u,r)},5000);return true}var z=e._getDSUpdateZipUrl();a.dcpStatus=a.EnumDCP_DetectStatus.DownloadingZip;e._sendStatusEvent();new g.ajax({method:"GET",url:z,async:true,dataType:"blob",onSuccess:l,onError:t});return true},t=function(A,C,z){a.dcpStatus=a.EnumDCP_DetectStatus.DownloadFailed;w&&w();var D=z.status,B;if(D==200){B=A}else{B="The update package can't be downloaded. The error code is "+D+"."}o&&o(true,B);e._sendStatusEvent(true,B);setTimeout(x,0);return true},s=function(A){if(!(g.isArray(A)&&A.length>1)){return false}if(A[1]==true){a.dcpStatus=a.EnumDCP_DetectStatus.VerifiedZip;e._sendStatusEvent();a.dcpStatus=a.EnumDCP_DetectStatus.UpdatingService;e._sendStatusEvent();setTimeout(function(){e._checkService(u,r)},5000)}else{var z=0;if("exception" in A){z=A.exception}if(z==-2373){e._funUpdateFailed(w,o,A,200);setTimeout(x,0);return true}setTimeout(q,0)}return true},l=function(z){var A=1;dynamsoft.dcp.loadZip(z,A,function(B){var D,C;try{if(g.isString(B)){C=g.parse(B.replace(/\0/g,""));if("result" in C){D=C.result}}}catch(E){}if(g.isArray(D)&&D.length>2&&D[2]==true){setTimeout(function(){e._checkService(u,r)},5000);return}e._funUpdateFailed(w,o,B,200);setTimeout(x,0)},n)},n=function(A,B,z){var C=-1;if(z){C=z.status}if(C==0){setTimeout(function(){e._checkService(u,r)},5000)}else{e._funUpdateFailed(w,o,A,z.status);setTimeout(x,0)}return true},y=function(z){if(!(g.isArray(z)&&z.length>0)){return false}if(z[0]==true){setTimeout(function(){e._checkService(u,r)},5000)}else{e._funUpdateFailed(w,o,z,200);setTimeout(x,0)}return true},m=3,u=function(A){if(!(g.isArray(A)&&A.length>0&&A[0])){return false}var z=A[0].split(",");if(e._compareVersion(z,e.serviceVersion)){a.bConnected=true;w&&w();a.dcpStatus=a.EnumDCP_DetectStatus.CheckedService;e._sendStatusEvent(false,A[0]);a.dcpStatus=a.EnumDCP_DetectStatus.UpdateSucceed;e._sendStatusEvent();setTimeout(x,0);return true}return false},r=function(A,B){var z=1000;if(m<3){z=500}m--;if(m<0){e._funShowUpgradeDialogWhenUpdateFailed(w,o);setTimeout(x,0);return true}setTimeout(function(){e._checkService(u,r)},z);return true};p&&p();a.dcpStatus=a.EnumDCP_DetectStatus.VerifyingZip;e._sendStatusEvent();e._checkUpdateFile(s,q)},_getStatusString:function(p,o){if(p==a.EnumDCP_DetectStatus.Init){return"Getting manager version"}else{if(p==a.EnumDCP_DetectStatus.Connected){var n;if(o){n=o}else{n=""}return"Getting manager version succeeded and the version is "+n}else{if(p==a.EnumDCP_DetectStatus.DownloadingZip){return"Downloading the update package"}else{if(p==a.EnumDCP_DetectStatus.DownloadedZip){return"Update package downloaded"}else{if(p==a.EnumDCP_DetectStatus.DownloadFailed){var m,l=".";if(o&&o.length>0){if(o.slice(o.length-1)=="."){l=""}m=" with the error: "+o}else{m=""}return"Update package failed to download"+m+l}else{if(p==a.EnumDCP_DetectStatus.CheckingManagerVer){return"Getting manager version"}else{if(p==a.EnumDCP_DetectStatus.CheckingServiceVer){return"Getting service version"}else{if(p==a.EnumDCP_DetectStatus.NotInstalled){return"Dynamsoft Service Not Installed"}else{if(p==a.EnumDCP_DetectStatus.UpdateSkipped){return"Update skipped"}else{if(p==a.EnumDCP_DetectStatus.CheckedService){var n;if(o){n=o}else{n=""}return"Getting service version succeeded and the version is "+n}else{if(p==a.EnumDCP_DetectStatus.VerifyingZip){return"Verifying the update package"}else{if(p==a.EnumDCP_DetectStatus.VerifiedZip){return"Update package verified"}else{if(p==a.EnumDCP_DetectStatus.UpdatingService){return"Updating the service"}else{if(p==a.EnumDCP_DetectStatus.UpdateSucceed){return"Update succeeded"}else{if(p==a.EnumDCP_DetectStatus.UpdateFailed){var m,l=".";if(o&&o.length>0){if(o.slice(o.length-1)=="."){l=""}m=" with the error: "+o}else{m=""}return"The update failed"+m+l}}}}}}}}}}}}}}}return""},_sendStatusEvent:function(m,n){var l=m?true:false;if(g.isFunction(j.OnGetServiceUpdateStatus)){j.OnGetServiceUpdateStatus(l,a.dcpStatus,e._getStatusString(a.dcpStatus,n))}},_getErr:function(m){var n,l="";try{if(g.isString(m)){n=m.replace(/\0/g,"");n=g.parse(n)}else{if(m){n=m}}if("description" in n){l=n.description}}catch(o){}return l},_funShowUpgradeDialogWhenUpdateFailed:function(m,l){a.bConnected=true;a.dcpStatus=a.EnumDCP_DetectStatus.UpdateFailed;m&&m();l&&l();e._sendStatusEvent(true);return true},_funUpdateFailed:function(m,l,n,q){a.bConnected=true;a.dcpStatus=a.EnumDCP_DetectStatus.UpdateFailed;m&&m();var o,p;if(q==200){o="The update failed.";p=e._getStatusString(a.dcpStatus,e._getErr(n))}else{o="The update failed. The error code is "+q;p=o}l&&l(true,o);e._sendStatusEvent(true,p);return true}};k=b;h=b;d=b})(dynamsoft.lib,dynamsoft.managerEnv);(function(e,a,d){a.IE_PERMISSION_DENIED_Err_Code=-2146828218;a.IE_Unknown_Err_Code=-2147024891;a.IP="127.0.0.1";a.IMAXCONNECTCOUNT=6;a.bConnectNumLimited=true;a.sdkVersionComparisonResult=d._enumSdkVersionComparisonResult.Unknown;a.isFullVersion=!1;a.portInfo={nonSslPorts:[18646,18987],sslPorts:[18647,18988]};a.orgPortInfo={nonSslPorts:[18620,18991],sslPorts:[18621,18992]};a.preUrl=[(d.navInfo.bSSL?"https":"http"),"://",a.IP,":"].join("");a.sendCommand=function(n,l,h,m,j,f,g,k){n=n||"POST";l=l||null;h=h||[a.preUrl,a.portInfo.curPort,"/",d._getVersionStrForCommand(),"/ts=",e.now()].join("");m=m||function(){};j=j||function(){};f=f||"json",k=k||0;e.ajax({method:n,data:l,url:h,onSuccess:m,onError:j,dataType:f,async:g,timeout:k})};a.asyncGetServiceInfo=function(g,h,n,f){var p=0,j=0,m=d.navInfo.bSSL?a.portInfo.sslPorts:a.portInfo.nonSslPorts;f=e.isNumber(f)?f:a.IMAXCONNECTCOUNT;var k=function(r){if(a.isValidResponseValue(r)&&e.isArray(r.result)){var q=r.result[0];a.sdkVersionComparisonResult=d._getSdkVersionComparisonResult(q);if(a.sdkVersionComparisonResult===d._enumSdkVersionComparisonResult.Equal){a.portInfo.curPort=m[p%m.length];a.bConnected=true;a.isFullVersion=!!r.result[1];if(e.isFunction(g)){setTimeout(function(){g()},0)}return}else{a.bConnected=false;if(e.isFunction(h)){setTimeout(function(){h()},0)}return}}else{o()}},o=function(){++p;a.bConnected=false;if(a.bConnectNumLimited&&p>=f){if(e.isFunction(h)){setTimeout(function(){h()},0)}return}j=p%m.length;setTimeout(function(){l([a.preUrl,m[j],"/",d._getVersionStrForCommand(),"/GetServiceInfo?ts=",e.now()].join(""),k,o)},n&&e.isNumber(n)?n:0)},l=function(q,s,r){a.sendCommand("GET",null,q,s,r,"json",!0,0.5)};l([a.preUrl,m[j],"/",d._getVersionStrForCommand(),"/GetServiceInfo?ts=",e.now()].join(""),k,o)};a.getSessionIdSync=function(){if(e.isString(a.sessionId)){return a.sessionId}var g={method:"GetSessionId",parameter:[a.getSessionTimeout()]},f=function(j){if(a.isValidResponseValue(j)&&e.isArray(j.result)&&e.isString(j.result[0])){a.sessionId=j.result[0]}else{a.sessionId=null}},h=function(){a.sessionId=null};a.sendCommand("POST",e.stringify(g),[a.preUrl,a.portInfo.curPort,"/",d._getVersionStrForCommand(),"/ts=",(new Date()).getTime()].join(""),f,h,"json",!1);return a.sessionId};a.checkServiceConnection=function(f,p){var m=d.navInfo.bSSL?a.portInfo.sslPorts:a.portInfo.nonSslPorts,k=a.bConnected&&a.portInfo.curPort?a.portInfo.curPort:m[0],q=m.indexOf(k)+1,g=[a.preUrl,k,"/",d._getVersionStrForCommand(),"/GetServiceInfo?ts=",e.now()].join(""),o=false,n=function(s){if(a.isValidResponseValue(s)&&e.isArray(s.result)){var r=s.result[0];a.sdkVersionComparisonResult=d._getSdkVersionComparisonResult(r);if(a.sdkVersionComparisonResult===d._enumSdkVersionComparisonResult.Equal||a.sdkVersionComparisonResult===d._enumSdkVersionComparisonResult.FrontendMiniVersionHigher||a.sdkVersionComparisonResult===d._enumSdkVersionComparisonResult.BackendMiniVersionHigher){a.isFullVersion=!!s.result[1];a.portInfo.curPort=k;if(!e.isString(a.sessionId)){a.sessionId=a.getSessionIdSync()}if(e.isString(a.sessionId)){o=true}else{j()}}else{j()}}else{j()}},h=function(r,s){j();if(p&&d.navInfo.bIE&&(parseInt(d.navInfo.strBrowserVersion)<=9)&&e.isString(s)&&(s.toLowerCase().indexOf("denied")!==-1||s.toLowerCase().indexOf(a.IE_PERMISSION_DENIED_Err_Code)!==-1||s.toLowerCase().indexOf(a.IE_Unknown_Err_Code)!==-1)){p.bNeedAddToLocalIntranet=true}},j=function(){a.isFullVersion=false;a.portInfo.curPort=undefined;o=false};f=e.isNumber(f)&&f>0?f:1;for(var l=0;l<f;l++){a.sendCommand("GET",null,g,n,h,"json",!1,0.5);if(o){break}else{k=m[(q+l)%m.length];g=[a.preUrl,k,"/",d._getVersionStrForCommand(),"/GetServiceInfo?ts=",e.now()].join("")}}return o};a.getInitInfo=function(k,h){var f=undefined,j=function(l){f=l},g=function(l,n,m){a.sendCommand("GET",null,l,n,m,"json",!1)};if(!a.bConnected||!a.portInfo.curPort||!a.sessionId){return f}else{g([a.preUrl,a.portInfo.curPort,"/",d._getVersionStrForCommand(),"/init?session=",a.sessionId,"&object=",k,"&imageviewer=",h,"&lang=",d._lang,"&ts=",e.now()].join(""),j,j)}return f};a.postSyncCommand=function(p,k,n,l,h){var g=!1,f="POST",o="json",j=!1,m=function(s,r){if(a.isValidResponseValue(s)){if(e.errorInfo.isUnknownCode(s.exception)){s.description=e.errorInfo.getUnknownString(s.exception,s.description);s.exception=EnumDCS_ErrorCode.Unknown}if((s.exception===EnumDCS_ErrorCode.ConnectionToServiceReset||s.exception===EnumDCS_ErrorCode.CameraOccupied)&&e.isString(s.description)){s.description=s.description.replace("Webcam","Camera")}if(s.exception==0){if(e.isFunction(n)){n(s)}g=!0}else{if(p instanceof e.sdk.DcsObject){if(s.exception===e.errorInfo.getLicenseVerificationFailedCode()&&s.result){p._setErrCodeErrString(s.exception,s.result[1]);if(!a.isFullVersion&&s.result[0]!==1&&e.isFunction(n)){n(s)}}else{p._setErrCodeErrString(s.exception,s.description)}}if(!(s.exception===e.errorInfo.getLicenseVerificationFailedCode()&&!a.isFullVersion&&s.result&&s.result[0]!==1)&&e.isFunction(l)){l(s)}g=!1}}else{if(e.isString(r)&&(p instanceof e.sdk.DcsObject)&&(r.toLowerCase()==="maximum call stack size exceeded"||r.toLowerCase()==="out of memory")){p._setErrCodeErrString(e.errorInfo.getConversionFailedCode(),e.errorInfo.getConversionFailedString());g=!1}}},q=function(r,s){if(p instanceof e.sdk.DcsObject){if(d.navInfo.bIE&&(parseInt(d.navInfo.strBrowserVersion)<=9)&&e.isString(s)&&(s.toLowerCase().indexOf("denied")!==-1||s.toLowerCase().indexOf(a.IE_PERMISSION_DENIED_Err_Code)!==-1||s.toLowerCase().indexOf(a.IE_Unknown_Err_Code)!==-1)){p._setErrCodeErrString(e.errorInfo.getOperationNotSupportedCode(),e.errorInfo.getOperationNotSupportedString())}else{a.throwServiceNotConnectException(p)}}if(e.isFunction(l)){l()}g=!1};h=h||[a.preUrl,a.portInfo.curPort,"/",d._getVersionStrForCommand(),"/ts=",e.now()].join("");k=k||null;a.sendCommand(f,k,h,m,q,o,j);return g};a.sendRemoveObjectCommand=function(g){var f={session:a.sessionId,object:g,method:"RemoveObject"};a.sendCommand("POST",e.stringify(f),null,null,null,"json",!0)};a.bIsSendingHeartBeat=false;var b=0;a.sendHeartBeatCommand=function(f){if(a.getSessionTimeout()==0){return}if(a.bIsSendingHeartBeat&&f){return}if(!a.bConnected){a.bIsSendingHeartBeat=false;return}if(!e.isString(a.sessionId)){a.bIsSendingHeartBeat=false;return}var g={session:a.sessionId,method:"HeartBeat"};a.bIsSendingHeartBeat=true;a.sendCommand("POST",e.stringify(g),null,function(){setTimeout(a.sendHeartBeatCommand,1000);b=0},function(){b+=1;if(b<a.IMAXCONNECTCOUNT){setTimeout(a.sendHeartBeatCommand,1000)}else{a.bIsSendingHeartBeat=false}},null,true)};a.isValidResponseValue=function(f){if(!f||!e.isObject(f)||!e.isNumber(f.exception)||!e.isString(f.description)){return false}return true};a.setServiceNotConnectErroInfo=function(f){a.bConnected=false;if(f instanceof e.sdk.DcsObject){f._setErrCodeErrString(e.errorInfo.getConnectionToServiceLostCode(),e.errorInfo.getConnectionToServiceLostString())}};a.throwServiceNotConnectException=function(f){a.setServiceNotConnectErroInfo(f);throw {errorCode:e.errorInfo.getConnectionToServiceLostCode(),errorString:e.errorInfo.getConnectionToServiceLostString(),toString:function(){return this.errorCode+": "+this.errorString}}};a.handleImageLoadingError=function(h,g){if(!h||!e.isString(g)){return}var f=function(k){if(a.isValidResponseValue(k)){h._setErrCodeErrString(k.exception,k.description)}},j=function(){a.setServiceNotConnectErroInfo(h)};a.sendCommand("GET",null,g,f,j,"json",!1)};a.getSessionTimeout=function(){var h=dynamsoft.dcsEnv.sessionTimeout,f=((0|1<<31)>>>0)-1,g=5;if(!e.isNumber(h)){h=20*60}h=Math.round(h);if(h>f){h=f}if(h>0&&h<g){h=g}if(h<0){h=0}return h};a.enumDownloadDcsModuleStatus={idle:0,downloading:1,success:2,fail:3};a.downloadDcsModuleStatus=a.enumDownloadDcsModuleStatus.idle;a.dcsModuleBinary=null;a.downloadDcsModule=function(g,f){var h=function(){var n;if(d.navInfo.bMac){n="MacDCS_"}else{n="WinDCS_"}var m=[d.resourcesPath,"/",n,d._getFrontendSdkVersionWithDot(),".zip","?ts=",e.now()].join(""),l=function(p){a.dcsModuleBinary=p;a.downloadDcsModuleStatus=a.enumDownloadDcsModuleStatus.success},o=function(){a.dcsModuleBinary=null;a.downloadDcsModuleStatus=a.enumDownloadDcsModuleStatus.fail};a.downloadDcsModuleStatus=a.enumDownloadDcsModuleStatus.downloading;var k={method:"GET",url:m,dataType:"blob",onSuccess:l,onError:o,async:true};if(d.navInfo.bIE&&parseInt(d.navInfo.strBrowserVersion)<10){k.contentType="text/plain; charset=x-user-defined";k.mimeType="text/plain; charset=x-user-defined";k.headers={"Accept-Charset":"x-user-defined"}}else{k.xhrFields={responseType:d.navInfo.bSafari?"arraybuffer":"blob"}}e.ajax(k)},j=function(){var k=setInterval(function(){if(a.downloadDcsModuleStatus===a.enumDownloadDcsModuleStatus.success){clearInterval(k);if(e.isFunction(g)){g()}}else{if(a.downloadDcsModuleStatus===a.enumDownloadDcsModuleStatus.fail){clearInterval(k);if(e.isFunction(f)){f()}}}},1000)};if(a.downloadDcsModuleStatus===a.enumDownloadDcsModuleStatus.idle||a.downloadDcsModuleStatus===a.enumDownloadDcsModuleStatus.fail){h();j()}else{if(a.downloadDcsModuleStatus===a.enumDownloadDcsModuleStatus.downloading){j()}else{if(e.isFunction(g)){g()}}}};a.checkOrgServiceConnection=function(f,l){var j=1,n=d.navInfo.bSSL?a.orgPortInfo.sslPorts:a.orgPortInfo.nonSslPorts,g=[a.preUrl,n[0],"/GetServiceInfo?ts=",e.now()].join(""),h=function(){if(e.isFunction(f)){f()}},m=function(){j++;if(j>n.length){if(e.isFunction(l)){l()}}else{setTimeout(function(){k([a.preUrl,n[1],"/GetServiceInfo?ts=",e.now()].join(""),h,m)},500)}},k=function(p,q,o){a.sendCommand("GET",null,p,q,o,"json",!0,0.5)};k(g,h,m)};a.asyncConnDcpUnitlReady=function(f){dynamsoft.dcp.versionInfo(function(){if(dynamsoft.dcp.detect.bConnected){if(e.isFunction(f)){setTimeout(f,0);return}}else{a.asyncConnDcpUnitlReady(f)}})}})(dynamsoft.lib,dynamsoft.lib.detect,dynamsoft.dcsEnv);var EnumDCS_ErrorCode={OK:0,ParameterNumberUnmatched:-1001,TypeNotValid:-1002,ValueOutOfRange:-1003,CameraNotFound:-1004,StateNotCorrect:-1005,CameraOccupied:-1006,OperationNotSupported:-1007,ValueNotValid:-1008,CameraNotAuthorized:-1009,MultipageNotSupported:-1010,AsyncTaskNotCompleted:-1011,HttpError:-1012,ContainerTypeNotValid:-1013,ContainerIdNotValid:-1014,LicenseVerificationFailed:-1015,OperationOutOfMemory:-1016,BufferIsFull:-1017,ObjectNotExist:-1018,ObjectExists:-1019,ObjectOccupied:-1020,AccessDenied:-1021,ConnectionToServiceLost:-1022,ConnectionToServiceReset:-1023,OperationSequenceError:-1024,DataFormatInvalid:-1025,JPEGCompressionError:-1026,OperationCancelled:-1027,DocumentNotExist:-1028,DocumentUndetected:-1029,ConversionFailed:-1501,SessionNotFound:-2597,CameraDisconnected:-2792,Unknown:-3001,DownloadDcsModuleFailed:-4001,SendDcsModuleFailed:-4002,ConnectDcsModuleFailed:-4003};(function(a){var b={isUnknownCode:function(d){if(d===EnumDCS_ErrorCode.Unknown){return true}for(var e in EnumDCS_ErrorCode){if(EnumDCS_ErrorCode[e]===d){return false}}return true},getOkCode:function(){return EnumDCS_ErrorCode.OK},getOkString:function(){return"Successful."},getParameterNumberUnmatchedCode:function(){return EnumDCS_ErrorCode.ParameterNumberUnmatched},getParameterNumberUnmatchedString:function(d){return d?"One or more parameters are missing.":"There are too many parameters."},getTypeNotValidCode:function(){return EnumDCS_ErrorCode.TypeNotValid},getTypeNotValidString:function(e,d){return["The type of ",(d?"event ":"parameter "),e," is invalid."].join("")},getObjectNotExistCode:function(){return EnumDCS_ErrorCode.ObjectNotExist},getObjectNotExistString:function(d){return["The object ",d," does not exist."].join("")},getContainerTypeNotValidCode:function(){return EnumDCS_ErrorCode.ContainerTypeNotValid},getContainerTypeNotValidString:function(d){return["The ",(d?d=="document"?"document editor":"image viewer":"video stream")," container must be a DIV element."].join("")},getContainerIdNotValidCode:function(){return EnumDCS_ErrorCode.ContainerIdNotValid},getContainerIdNotValidString:function(){return"The IDs for the video stream container and the image viewer container can not be the same."},getObjectOccupiedCode:function(){return EnumDCS_ErrorCode.ObjectOccupied},getObjectOccupiedString:function(d){return["The object ",d," is occupied."].join("")},getValueOutOfRangeCode:function(){return EnumDCS_ErrorCode.ValueOutOfRange},getValueOutOfRangeString:function(d){return["The value of parameter ",d," is out of range."].join("")},getValueNotValidCode:function(){return EnumDCS_ErrorCode.ValueNotValid},getValueNotValidString:function(d){return["The value of parameter ",d," is invalid."].join("")},getBufferIsFullCode:function(){return EnumDCS_ErrorCode.BufferIsFull},getBufferIsFullString:function(d){return["The ",(d?d=="document"?"document":"image":"image")," buffer is full."].join("")},getOperationSequenceErrorCode:function(){return EnumDCS_ErrorCode.OperationSequenceError},getOperationSequenceErrorString:function(){return"Operation out of expected sequence."},getConnectionToServiceLostCode:function(){return EnumDCS_ErrorCode.ConnectionToServiceLost},getConnectionToServiceLostString:function(){return"The local service (Dynamsoft Service) is disconnected."},getAccessDeniedCode:function(){return EnumDCS_ErrorCode.AccessDenied},getAccessDeniedString:function(e,g,d){var f=arguments.length;if(f==3&&d==true){return"The document is being edited now."}else{if(f==2&&g=="Document"){return["The access to document editor "+e+" is denied"].join("")}else{return["The access to image viewer "+e+" is denied"].join("")}}},getCameraNotFoundCode:function(){return EnumDCS_ErrorCode.CameraNotFound},getCameraNotFoundString:function(){return"There is no camera found on the machine."},getStateNotCorrectCode:function(){return EnumDCS_ErrorCode.StateNotCorrect},getStateNotCorrectString:function(){return"The camera capability [capability] can not be set because it is automatically adjusted."},getCameraOccupiedCode:function(){return EnumDCS_ErrorCode.CameraOccupied},getCameraOccupiedString:function(){return"The camera you are trying to access is currently occupied by another Dynamsoft Camera process"},getOperationNotSupportedCode:function(){return EnumDCS_ErrorCode.OperationNotSupported},getOperationNotSupportedString:function(d){return d?d=="Image"?"This operation is only supported under document mode.":d=="Document"?"This operation is only supported under image mode.":d=="HTML5"?"Your browser doesn't support HTML5, please use a modern browser like Chrome, Firefox, etc.":"Dynamsoft Camera JS library cannot be used in current Internet options settings.":"Dynamsoft Camera JS library cannot be used in current Internet options settings."},getCameraNotAuthorizedCode:function(){return EnumDCS_ErrorCode.CameraNotAuthorized},getCameraNotAuthorizedString:function(){return"You have disallowed access to the local cameras out of security concerns."},getMultipageNotSupportedCode:function(){return EnumDCS_ErrorCode.MultipageNotSupported},getMultipageNotSupportedString:function(){return"The formats BMP, JPEG, PNG only allow one page per file."},getAsyncTaskNotCompletedCode:function(){return EnumDCS_ErrorCode.AsyncTaskNotCompleted},getAsyncTaskNotCompletedString:function(d){return["The asynchronous task ",d," is not completed yet."].join("")},getHttpErrorCode:function(){return EnumDCS_ErrorCode.HttpError},getHttpErrorString:function(d){return["The server returned the error code ",d,"."].join("")},getLicenseVerificationFailedCode:function(){return EnumDCS_ErrorCode.LicenseVerificationFailed},getLicenseVerificationFailedString:function(){return""},getOperationOutOfMemoryCode:function(){return EnumDCS_ErrorCode.OperationOutOfMemory},getOperationOutOfMemoryString:function(d){return["There is not enough memory for the operation ",d,"."].join("")},getObjectExistsCode:function(){return EnumDCS_ErrorCode.ObjectExists},getObjectExistsString:function(d){return["The object ",d," already exists."].join("")},getConnectionToServiceResetCode:function(){return EnumDCS_ErrorCode.ConnectionToServiceReset},getConnectionToServiceResetString:function(){return"The connection to the local service (Dynamsoft Service) has been reset."},getDataFormatInvalidCode:function(){return EnumDCS_ErrorCode.DataFormatInvalid},getDataFormatInvalidString:function(d){return d?"The format of the image you are trying to download is invalid.":"The format of the image loaded from system clipboard must be DIB (Windows OS) or NSImage (MAC OS)."},getJPEGCompressionErrorCode:function(){return EnumDCS_ErrorCode.JPEGCompressionError},getJPEGCompressionErrorString:function(){return"Only 24-bit true color bmp and 8-bit gray-scaled image are supported for JPEG compression."},getOperationCancelledCode:function(){return EnumDCS_ErrorCode.OperationCancelled},getOperationCancelledString:function(d){return d?"The document cannot be edited when another document is being edited in the document editor.":"User cancelled the operation."},getSessionNotFoundCode:function(){return EnumDCS_ErrorCode.SessionNotFound},getSessionNotFoundString:function(){return"The specified session is not found."},getCameraDisconnectedCode:function(){return EnumDCS_ErrorCode.CameraDisconnected},getCameraDisconnectedString:function(){return"The camera is disconnected, please check."},getConversionFailedCode:function(){return EnumDCS_ErrorCode.ConversionFailed},getConversionFailedString:function(){return"The conversion to base64 string failed."},getUnknownCode:function(){return EnumDCS_ErrorCode.Unknown},getUnknownString:function(d,e){return["(",d,")",e].join("")},getDownloadDcsModuleFailedCode:function(){return EnumDCS_ErrorCode.DownloadDcsModuleFailed},getDownloadDcsModuleFailedString:function(){return"Failed to download the DCS module. Please check the network connection and try again later."},getSendDcsModuleFailedCode:function(){return EnumDCS_ErrorCode.SendDcsModuleFailed},getSendDcsModuleFailedString:function(){return"Failed to send the DCS module to Dynamsoft Service. Please check the network connection and try again later."},getConnectDcsModuleFailedCode:function(){return EnumDCS_ErrorCode.ConnectDcsModuleFailed},getConnectDcsModuleFailedString:function(){return"Failed to connect to the DCS module. Please check the network connection and try again later."},getDocumentNotExistCode:function(){return EnumDCS_ErrorCode.DocumentNotExist},getDocumentNotExistString:function(){return"There is no document in the document editor."},getDocumentUndetectedCode:function(){return EnumDCS_ErrorCode.DocumentUndetected},getDocumentUndetectedString:function(){return"There is no document detected."}};a.errorInfo=a.errorInfo||{};a.mix(a.errorInfo,b)})(dynamsoft.lib);dynamsoft.lib.sdk=dynamsoft.lib.sdk||{};(function(e,b,d){function a(f,h,k,g){var j=this;j._dwsObjectId=k;j._errorCode=0;j._errorString="";j.camera=new b.Camera(j);j.videoviewer=new b.VideoViewer(j,f);d._videoViewerDic[f]={dwsObject:j,videoViewer:j.videoviewer};j._imageViewerManager=new e.sdk.ImageViewerManager(j);j._imageViewerManager.addImageViewer(h,g);j._documentEditorManager=new e.sdk.DocumentEditorManager(j);j._bDestoryed=false}a.prototype._validateParamNum=function(g,f){if(g.length!=f){this._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(g.length<f));return false}this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());return true};e.each(["Number","Boolean","String","Array"],function(f){a.prototype["_validate"+f+"Type"]=function(g,h){if(!e["is"+f](h)){this._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString(g));return false}if(f=="Number"&&e.isNaN(h)){this._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString(g));return false}this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());return true}});a.prototype._validateValue=function(j,k,g,h){var l=this;if(h&&g.length==2){if(k>Math.max(g[0],g[1])||k<Math.min(g[0],g[1])){l._setErrCodeErrString(e.errorInfo.getValueOutOfRangeCode(),e.errorInfo.getValueOutOfRangeString(j));return false}l._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());return true}if(!h){for(var f=0;f<g.length;f++){if(k==g[f]){l._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());return true}}l._setErrCodeErrString(e.errorInfo.getValueNotValidCode(),e.errorInfo.getValueNotValidString(j));return false}};a.prototype._validateElExist=function(g,f){var h;try{h=!!(e.one("#"+g).getEL())}catch(j){h=false}if(h){if(!f){this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString())}}else{this._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString(g))}return h};a.prototype._validateDivDom=function(g,j,f){if(!this._validateElExist(g,f)){return false}var h=e.one("#"+g).getEL();if(h.nodeName.toUpperCase()!="DIV"){this._setErrCodeErrString(e.errorInfo.getContainerTypeNotValidCode(),e.errorInfo.getContainerTypeNotValidString(j));return false}else{if(!f){this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString())}return true}};a.prototype._validateImgViewerExist=function(j,f){var h=d._imageViewerDic[j],g=h&&h.dwsObject===this;if(g&&!f){this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString())}else{this._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("image viewer"))}return g&&!f};a.prototype._validateDocEditorExist=function(g,f){var j=d._documentEditorDic[g],h=j&&j.dwsObject===this;if(h&&!f){this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString())}else{this._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("document editor"))}return h&&!f};a.prototype._setErrCodeErrString=function(g,f){this._errorCode=g;this._errorString=f};a.prototype.getErrorCode=function(){if(this._bDestoryed){return false}return this._errorCode};a.prototype.getErrorString=function(){if(this._bDestoryed){return false}return this._errorString};a.prototype.getImageViewer=function(f){var j=this,h=null;if(j._bDestoryed){return false}if(!j._validateParamNum(arguments,1)||!j._validateStringType("imageContainerId",f)){return h}if(!j._validateDivDom(f,!0)){return h}var g=d._imageViewerDic[f];if(!g){j._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("image viewer"));return h}if(!j._validateDivDom(f,!0)){delete d._imageViewerDic[f];return h}if(g.dwsObject!==j){j._setErrCodeErrString(e.errorInfo.getAccessDeniedCode(),e.errorInfo.getAccessDeniedString(f));return h}h=g.imageViewer;return h};a.prototype.getAllImageViewers=function(){var h=this,g=[],f;if(h._bDestoryed){return false}if(!h._validateParamNum(arguments,0)){return null}for(i in d._imageViewerDic){f=d._imageViewerDic[i];if(f.dwsObject!==h){continue}g.push(f.imageViewer)}g.sort(function(k,j){return k._innerIndex-j._innerIndex});g.at=function(j){return this[j]};return g};a.prototype.addImageViewer=function(j){var l=this;if(l._bDestoryed){return false}if(!l._validateParamNum(arguments,1)||!l._validateStringType("imageContainerId",j)){return null}if(!l._validateDivDom(j,!0)){return null}var h=d._imageViewerDic[j];var g=d._documentEditorDic[j];var f=d._videoViewerDic[j];if(h){if(h.dwsObject===l){l._setErrCodeErrString(e.errorInfo.getObjectExistsCode(),e.errorInfo.getObjectExistsString(j))}else{l._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(j))}return null}if(g||f){l._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(j));return null}var k=l._imageViewerManager.addImageViewer(j);return k?(d._imageViewerDic[j]).imageViewer:null};a.prototype.removeImageViewer=function(g){var j=this,f=false;if(j._bDestoryed){return f}if(!j._validateParamNum(arguments,1)||!j._validateStringType("imageContainerId",g)){return f}if(!j._validateDivDom(g,!0)){return f}var h=d._imageViewerDic[g];if(!h){j._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("image viewer"));return f}if(h.dwsObject!==j){j._setErrCodeErrString(e.errorInfo.getAccessDeniedCode(),e.errorInfo.getAccessDeniedString(g));return f}if(h.imageViewer.io._validateImgIsHandlingAsyncOperation()){return f}f=j._imageViewerManager.removeImageViewer(g);return f};a.prototype.getDocumentEditor=function(f){var j=this,g=null;if(j._bDestoryed){return false}if(!j._validateParamNum(arguments,1)||!j._validateStringType("documentEditorContainerId",f)){return g}if(!j._validateDivDom(f,"document")){return g}var h=d._documentEditorDic[f];if(!h){j._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("document editor"));return g}if(!j._validateDivDom(f,!0)){delete d._documentEditorDic[f];return g}if(h.dwsObject!==j){j._setErrCodeErrString(e.errorInfo.getAccessDeniedCode(),e.errorInfo.getAccessDeniedString(f,"Document"));return g}g=h.documentEditor;return g};a.prototype.getAllDocumentEditors=function(){var h=this,g=[],f;if(h._bDestoryed){return false}if(!h._validateParamNum(arguments,0)){return null}for(i in d._documentEditorDic){f=d._documentEditorDic[i];if(f.dwsObject!==h){continue}g.push(f.documentEditor)}g.sort(function(k,j){return k._innerIndex-j._innerIndex});g.at=function(j){return this[j]};return g};a.prototype.addDocumentEditor=function(h){var l=this;if(l._bDestoryed){return false}if(!l._validateParamNum(arguments,1)||!l._validateStringType("documentEditorContainerId",h)){return null}if(!l._validateDivDom(h,"document")){return null}var g=d._documentEditorDic[h];var k=d._imageViewerDic[h];var f=d._videoViewerDic[h];if(g){if(g.dwsObject===l){l._setErrCodeErrString(e.errorInfo.getObjectExistsCode(),e.errorInfo.getObjectExistsString(h))}else{l._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(h))}return null}if(k||f){l._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(h));return null}if(d.navInfo.bEdge){if(!window.applicationCache){l._setErrCodeErrString(e.errorInfo.getOperationNotSupportedCode(),e.errorInfo.getOperationNotSupportedString("HTML5"));return false}}else{if(!d.navInfo.bHTML5Edition){l._setErrCodeErrString(e.errorInfo.getOperationNotSupportedCode(),e.errorInfo.getOperationNotSupportedString("HTML5"));return false}}var j=l._documentEditorManager.addDocumentEditor(h);return j?(d._documentEditorDic[h]).documentEditor:null};a.prototype.removeDocumentEditor=function(g){var j=this,f=false;if(j._bDestoryed){return f}if(!j._validateParamNum(arguments,1)||!j._validateStringType("documentEditorContainerId",g)){return f}if(!j._validateDivDom(g,"document")){return f}var h=d._documentEditorDic[g];if(!h){j._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("document editor"));return f}if(h.dwsObject!==j){j._setErrCodeErrString(e.errorInfo.getAccessDeniedCode(),e.errorInfo.getAccessDeniedString(g,"Document"));return f}f=j._documentEditorManager.removeDocumentEditor(g);return f};a.prototype.destroy=function(){var l=this,j;if(l._bDestoryed){return false}var f=!1;if(!l._validateParamNum(arguments,0)){return f}var g,k,p,m,n;for(j in d._imageViewerDic){k=d._imageViewerDic[j];if(!k||k.dwsObject!==l||!(k.imageViewer)){continue}p=k.imageViewer;if(p.io._isHandlingAsyncOperation()){l._setErrCodeErrString(e.errorInfo.getAsyncTaskNotCompletedCode(),e.errorInfo.getAsyncTaskNotCompletedString(p.io._isHandlingAsyncDownloadOperation()?"httpDownloadAsync":"httpUploadAsync"));return f}}var h={session:e.detect.sessionId,object:l._dwsObjectId,method:"Destroy"},o=function(r){if(e.detect.isValidResponseValue(r)){if(r.exception==0){f=!0}else{l._setErrCodeErrString(r.exception,r.description);f=!1}}},q=function(){e.detect.throwServiceNotConnectException(l);f=!1};e.detect.sendCommand("POST",e.stringify(h),null,o,q,"json",!1);if(f){e.detect.sendRemoveObjectCommand(l._dwsObjectId);for(j in d._videoViewerDic){g=d._videoViewerDic[j];if(!g||g.dwsObject!==l){continue}l.camera._destory();l.videoviewer._destory();delete d._videoViewerDic[j];break}for(j in d._imageViewerDic){k=d._imageViewerDic[j];if(!k||k.dwsObject!==l||!(k.imageViewer)){continue}p=k.imageViewer;p.ui._destory();p.image._destory();p.io._destory();delete d._imageViewerDic[j]}for(j in d._documentEditorDic){m=d._documentEditorDic[j];if(!m||m.dwsObject!==l||!(m.documentEditor)){continue}n=m.documentEditor;n.ui._destory();n.document._destory();delete d._documentEditorDic[j]}l._bDestoryed=true}return f};b.DcsObject=a})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.dcsEnv);(function(e,d,b){function a(f){var g=this;g._dwsObject=f;g._bDestoryed=false;e.sdk.ktCamera.apply(g)}a.prototype.playVideo=function(){var j=this;if(j._bDestoryed){return false}var g=!1;if(!j._dwsObject._validateParamNum(arguments,0)){return g}if(!j._dwsObject._validateDivDom(j._dwsObject.videoviewer._getVideoViewerId(),!1)){return g}var h={session:dynamsoft.lib.detect.sessionId,object:j._dwsObject._dwsObjectId,method:"PlayVideo",parameter:[d._getProductKey()]},f=function(){var k=j._dwsObject.getErrorCode(),l=j._dwsObject.getErrorString();j._dwsObject.videoviewer._showStream();j._dwsObject._setErrCodeErrString(k,l);j._dwsObject.videoviewer._documentDetected=true};g=e.detect.postSyncCommand(j._dwsObject,e.stringify(h),f,null);return g};a.prototype.captureImage=function(m){var n=this,g=!1;if(n._bDestoryed){return g}if(n._dwsObject.videoviewer._mode=="Document"){n._dwsObject._setErrCodeErrString(e.errorInfo.getOperationNotSupportedCode(),e.errorInfo.getOperationNotSupportedString("Document"));return g}if(!n._dwsObject._validateParamNum(arguments,1)||!n._dwsObject._validateStringType("imageViewer",m)){return g}if(!n._dwsObject._validateDivDom(n._dwsObject.videoviewer._getVideoViewerId(),!1)){return g}var k;try{k=e.one("#"+m).getEL()}catch(j){k=false}if(!k){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString(m));return g}if(k.nodeName.toUpperCase()!="DIV"){n._dwsObject._setErrCodeErrString(e.errorInfo.getContainerTypeNotValidCode(),e.errorInfo.getContainerTypeNotValidString(true));return g}if(!d._imageViewerDic[m]){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("imageViewer"));return g}if(d._imageViewerDic[m].dwsObject!==n._dwsObject){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(m));return g}var l=d._imageViewerDic[m].imageViewer;if(l.image.getCount()==l.image.getCapacity()){n._dwsObject._setErrCodeErrString(e.errorInfo.getBufferIsFullCode(),e.errorInfo.getBufferIsFullString());return g}if(l.io._validateImgIsHandlingAsyncOperation()){return g}var h={session:dynamsoft.lib.detect.sessionId,object:n._dwsObject._dwsObjectId,method:"CaptureImage",parameter:[d._getProductKey(),l._imgViewerId]},f=function(){var o=n._dwsObject.getErrorCode(),p=n._dwsObject.getErrorString();l.ui._addImageControl();n._dwsObject._setErrCodeErrString(o,p)};g=e.detect.postSyncCommand(n._dwsObject,e.stringify(h),f,null);return g};a.prototype.captureDocument=function(m){var n=this,g=!1;if(n._bDestoryed){return g}if(n._dwsObject.videoviewer._mode=="Image"){n._dwsObject._setErrCodeErrString(e.errorInfo.getOperationNotSupportedCode(),e.errorInfo.getOperationNotSupportedString("Image"));return g}if(!n._dwsObject._validateParamNum(arguments,1)||!n._dwsObject._validateStringType("imageViewer",m)){return g}if(!n._dwsObject._validateDivDom(n._dwsObject.videoviewer._getVideoViewerId(),!1)){return g}var k;try{k=e.one("#"+m).getEL()}catch(j){k=false}if(!k){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString(m));return g}if(k.nodeName.toUpperCase()!="DIV"){n._dwsObject._setErrCodeErrString(e.errorInfo.getContainerTypeNotValidCode(),e.errorInfo.getContainerTypeNotValidString(true));return g}if(!d._imageViewerDic[m]){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("imageViewer"));return g}if(d._imageViewerDic[m].dwsObject!==n._dwsObject){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(m));return g}var l=d._imageViewerDic[m].imageViewer;if(l.image.getCount()==l.image.getCapacity()){n._dwsObject._setErrCodeErrString(e.errorInfo.getBufferIsFullCode(),e.errorInfo.getBufferIsFullString());return g}if(l.io._validateImgIsHandlingAsyncOperation()){return g}var h={session:dynamsoft.lib.detect.sessionId,object:n._dwsObject._dwsObjectId,method:"CaptureDocument",parameter:[d._getProductKey(),l._imgViewerId,n._dwsObject.videoviewer._bAllow]},f=function(){var o=n._dwsObject.getErrorCode(),p=n._dwsObject.getErrorString();l.ui._addImageControl();n._dwsObject._setErrCodeErrString(o,p)};g=e.detect.postSyncCommand(n._dwsObject,e.stringify(h),f,null);return g};a.prototype.takeCameraOwnership=function(g){var k=this,h=!1;if(k._bDestoryed){return h}if(!k._dwsObject._validateParamNum(arguments,1)||!k._dwsObject._validateStringType("cameraName",g)){return h}if(g.length===0||g.length>64){k._dwsObject._setErrCodeErrString(e.errorInfo.getValueNotValidCode(),e.errorInfo.getValueNotValidString("cameraName"));return h}var j={session:dynamsoft.lib.detect.sessionId,object:k._dwsObject._dwsObjectId,method:"TakeCameraOwnership",parameter:[g]},f=function(l){k._dwsObject._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());if(!l.result[1]){k._dwsObject.videoviewer._StopStream()}};h=e.detect.postSyncCommand(k._dwsObject,e.stringify(j),f,null);return h};a.prototype._destory=function(){this._bDestoryed=true};e.sdk.Camera=a})(dynamsoft.lib,dynamsoft.dcsEnv,dynamsoft.lib.detect);(function(b,e,d){b.Camera._CameraProp=function(g,f){this.parent=g;this._camera=g;this._dwsObject=g._dwsObject;this.strProp=f};b.Camera._CameraProp.prototype.getCurrent=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetCurrent",[this.strProp]);if(!f){return null}return f.result[0]};b.Camera._CameraProp.prototype.setCurrent=function(g){if(!this.parent._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if((typeof g!="number")){this._dwsObject._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString("iValue"));return false}if(g<-2147483648||g>2147483647){this._dwsObject._setErrCodeErrString(e.errorInfo.getValueOutOfRangeCode(),e.errorInfo.getValueOutOfRangeString("iValue"));return false}var f=this.parent._communicateWithService("SetCurrent",[this.strProp,g]);if(!f){if(this._dwsObject.getErrorCode()==-1003){this._dwsObject._setErrCodeErrString(-1003,e.errorInfo.getValueOutOfRangeString("iValue"))}return false}return f.result[0]};b.Camera._CameraResolution=dynamsoft.lib.extend(dynamsoft.lib.sdk.Camera._CameraProp);b.Camera._CameraResolution.prototype.getCurrent=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetResolutionCurrent");if(!f){return null}return new b.Camera.prototype.Resolution(f.result[0],f.result[1])};b.Camera._CameraResolution.prototype.setCurrent=function(g){if(!this.parent._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if((typeof g.width!="number")||(typeof g.width!="number")){this._dwsObject._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString("resolution"));return false}if(g.width<0||g.width>2147483647||g.height<0||g.height>2147483647){this._dwsObject._setErrCodeErrString(e.errorInfo.getValueOutOfRangeCode(),e.errorInfo.getValueOutOfRangeString("resolution"));return false}var f=this.parent._communicateWithService("SetResolutionCurrent",[g.width,g.height]);if(!f){if(this._dwsObject.getErrorCode()==-1003){this._dwsObject._setErrCodeErrString(-1003,e.errorInfo.getValueOutOfRangeString("resolution"))}else{if(this._dwsObject.getErrorCode()==-1002){this._dwsObject._setErrCodeErrString(-1002,e.errorInfo.getTypeNotValidString("resolution"))}else{if(this._dwsObject.getErrorCode()==-1008){this._dwsObject._setErrCodeErrString(-1008,e.errorInfo.getValueNotValidString("resolution"))}}}return false}this._dwsObject.videoviewer._setObjImgSize(g.width,g.height);return f.result[0]};var a=function(g,f){return g.width-f.width};b.Camera._CameraResolution.prototype.getAllowedValues=function(){if(!this.parent._check()){return[]}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return[]}var h=this.parent._communicateWithService("GetResolutionAllowedValues");if(!h){return[]}var g=[];for(var f=0;f<h.result.length/2;++f){g[f]=new b.Camera.prototype.Resolution(h.result[2*f],h.result[2*f+1])}g=g.sort(a);g.at=function(j){return this[j]};return g};b.Camera._CameraUnautoProp=dynamsoft.lib.extend(dynamsoft.lib.sdk.Camera._CameraProp);b.Camera._CameraUnautoProp.prototype.getDefault=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetDefault",[this.strProp]);if(!f){return null}return f.result[0]};b.Camera._CameraUnautoProp.prototype.getMin=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetMin",[this.strProp]);if(!f){return null}return f.result[0]};b.Camera._CameraUnautoProp.prototype.getMax=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetMax",[this.strProp]);if(!f){return null}return f.result[0]};b.Camera._CameraAutoProp=dynamsoft.lib.extend(dynamsoft.lib.sdk.Camera._CameraUnautoProp);b.Camera._CameraAutoProp.prototype.getIfAuto=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetIfAuto",[this.strProp]);if(!f){return null}return f.result[0]};b.Camera._CameraAutoProp.prototype.setIfAuto=function(g){if(!this.parent._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if(typeof g!=="boolean"){this._dwsObject._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString("auto"));return false}var f=this.parent._communicateWithService("SetIfAuto",[this.strProp,g]);if(!f){return false}return f.result[0]};b.Camera._CameraAutoProp.prototype.getIfDefaultAuto=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetIfDefaultAuto",[this.strProp]);if(!f){return null}return f.result[0]};b.ktCamera=function(){this.resolution=new dynamsoft.lib.sdk.Camera._CameraResolution(this,"resolution");this.exposure=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"exposureTime");this.iris=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"iris");this.focus=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"focus");this.zoom=new dynamsoft.lib.sdk.Camera._CameraUnautoProp(this,"zoom");this.pan=new dynamsoft.lib.sdk.Camera._CameraUnautoProp(this,"pan");this.tilt=new dynamsoft.lib.sdk.Camera._CameraUnautoProp(this,"tilt");this.roll=new dynamsoft.lib.sdk.Camera._CameraUnautoProp(this,"roll");this.backlightCompensation=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"backlightCompensation");this.brightness=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"brightness");this.gain=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"gain");this.saturation=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"saturation");this.sharpness=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"sharpness");this.gamma=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"gamma");this.whiteBalanceTemperature=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"whiteBalanceTemperature");this.contrast=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"contrast");this.hue=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"hue")};b.Camera.prototype.Resolution=function(g,f){this.width=g;this.height=f};b.Camera.prototype._checkBeforeSelect=function(){this._dwsObject._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());return true};b.Camera.prototype._check=function(){if(!this._checkBeforeSelect()){return false}if(!e.one("#"+this._dwsObject.videoviewer._videoContainerId)||!e.one("#"+this._dwsObject.videoviewer._videoContainerId).getEL()){this._dwsObject._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("video viewer"));return false}return true};b.Camera.prototype._communicateWithService=function(l,k){var f={session:e.detect.sessionId,object:this._dwsObject._dwsObjectId,method:l,parameter:k?k:[]};var h=e.stringify(f);var g;var j=this;e.ajax({method:"POST",data:h,url:[e.detect.preUrl,e.detect.portInfo.curPort,"/",d._getVersionStrForCommand(),"/ts=",e.now()].join(""),onSuccess:function(m){g=m},onError:function(m){dynamsoft.lib.detect.throwServiceNotConnectException(j._dwsObject)},dataType:"json",async:false});if(!g){return null}if(g.exception!=0){switch(g.exception){case EnumDCS_ErrorCode.CameraOccupied:case EnumDCS_ErrorCode.ConnectionToServiceReset:if(e.isString(g.description)){g.description=g.description.replace("Webcam","Camera")}break;case -1002:g.exception=e.errorInfo.getTypeNotValidCode();g.description=e.errorInfo.getTypeNotValidString("iValue");break;case -1008:g.exception=e.errorInfo.getValueNotValidCode();g.description=e.errorInfo.getValueNotValidString("iValue");break;default:if(e.errorInfo.isUnknownCode(g.exception)){g.description=e.errorInfo.getUnknownString(g.exception,g.description);g.exception=EnumDCS_ErrorCode.Unknown}break}this._dwsObject._setErrCodeErrString(g.exception,g.description);return null}return g};b.Camera.prototype.getCameraList=function(){if(!this._checkBeforeSelect()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this._communicateWithService("GetCameraList");if(!f){return null}return f.result?f.result:[]};b.Camera.prototype.selectCamera=function(h){if(!this._checkBeforeSelect()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if(typeof h!=="string"){this._dwsObject._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString("CameraName"));return false}var g=this._communicateWithService("SelectCamera",[h]);if(!g){if(this._dwsObject.getErrorCode()==-1008){this._dwsObject._setErrCodeErrString(-1008,e.errorInfo.getValueNotValidString("CameraName"))}return false}var f=g.result[0];if(f&&!g.result[1]){this._dwsObject.videoviewer._StopStream()}return f};b.Camera.prototype.closeCamera=function(){if(!this._check()){return false}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return false}var g=this._communicateWithService("CloseCamera");if(!g){return false}var f=g.result[0];if(f){this._dwsObject.videoviewer._StopStream()}return f};b.Camera.prototype.stopVideo=function(){if(!this._check()){return false}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return false}var g=this._communicateWithService("StopVideo");if(!g){return false}var f=g.result[0];if(f){this._dwsObject.videoviewer._StopStream()}return f};b.Camera.prototype.pauseVideo=function(){if(!this._check()){return false}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return false}var g=this._communicateWithService("PauseVideo");if(!g){return false}var f=g.result[0];if(f){this._dwsObject.videoviewer._pauseStream()}this._dwsObject.videoviewer._documentDetected=false;this._dwsObject.videoviewer._objImage.src=this._dwsObject.videoviewer._getFrameUrl(true);return f}})(dynamsoft.lib.sdk,dynamsoft.lib,dynamsoft.dcsEnv);(function(f,a,e){var d=1000/35;function b(h,g){var k=this;k._dwsObject=h;k._videoContainerId=g;k._userVideoContainer=f.one("#"+g).getEL();f.empty(k._userVideoContainer);var j=f.getElDimensions(k._userVideoContainer,false);k._userVideoContainerWidth=j?j.clientWidth:k._userVideoContainer.clientWidth;k._userVideoContainerHeight=j?j.clientHeight:k._userVideoContainer.clientHeight;k._userVideoContainer.innerHTML='<div class="ds-dws-video-viewer-wrapper" oncontextmenu="return false;"></div>';k._videoContainerWrapper=f.one(".ds-dws-video-viewer-wrapper",k._userVideoContainer).getEL();k._videoContainerWrapper.style.width=k._userVideoContainerWidth+"px";k._videoContainerWrapper.style.height=k._userVideoContainerHeight+"px";k._initObjImg();k._objImgWidth=NaN;k._objImgHeight=NaN;k._bStreamStopped=false;k._bStreamPaused=false;k._bDestoryed=false;k._MAXLOADINGIMGCOUNT=4;k._curLoadingImgCount=0;k.EnumMode={Image:0,Document:1};k._mode="Image";k.pollDocument=null;k._documentDetected=false;k._MINCOLOR=0;k._MAXCOLOR=4294967295;k._documentBoundaryColor=1589110015;k._bAllow=false;k._documentBoundaryThickness=2;k._bIe9_10=e.navInfo.bIE&&(parseInt(e.navInfo.strBrowserVersion)===9||parseInt(e.navInfo.strBrowserVersion)===10);f.sdk.ktVideoViewer.apply(k)}b.prototype.ondocumentboundarydetected=null;b.prototype.setMode=function(h){var j=this;if(j._dwsObject._bDestoryed){return false}if(j._bDestoryed){j._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!f.one("#"+j._videoContainerId)||!f.one("#"+j._videoContainerId).getEL()){j._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!j._dwsObject._validateParamNum(arguments,1)||!j._dwsObject._validateNumberType("mode",h)){return false}if(h!=0&&h!==1){j._dwsObject._setErrCodeErrString(f.errorInfo.getValueNotValidCode(),f.errorInfo.getValueNotValidString(h));return false}for(var g in j.EnumMode){if(h==j.EnumMode[g]){j._mode=g}}if(j._mode=="Document"){j._documentDetected=true}return true};b.prototype.getMode=function(){var g=this;if(g._dwsObject._bDestoryed){return null}if(g._bDestoryed){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!f.one("#"+g._videoContainerId)||!f.one("#"+g._videoContainerId).getEL()){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!g._dwsObject._validateParamNum(arguments,0)){return null}return g._mode};b.prototype.setAllowCaptureUndetectedDocument=function(g){var h=this;if(h._dwsObject._bDestoryed){return false}if(h._bDestoryed){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!f.one("#"+h._videoContainerId)||!f.one("#"+h._videoContainerId).getEL()){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!h._dwsObject._validateParamNum(arguments,1)||!h._dwsObject._validateBooleanType("bAllow",g)){return false}if(g==true||g==false){h._bAllow=g}else{h._dwsObject._setErrCodeErrString(f.errorInfo.getValueNotValidCode(),f.errorInfo.getValueNotValidString(g))}return true};b.prototype.getAllowCaptureUndetectedDocument=function(){var g=this;if(g._dwsObject._bDestoryed){return null}if(g._bDestoryed){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!f.one("#"+g._videoContainerId)||!f.one("#"+g._videoContainerId).getEL()){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!g._dwsObject._validateParamNum(arguments,0)){return null}return this._bAllow};b.prototype.setDocumentBoundaryThickness=function(g){var h=this;if(h._dwsObject._bDestoryed){return false}if(h._bDestoryed){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!f.one("#"+h._videoContainerId)||!f.one("#"+h._videoContainerId).getEL()){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!h._dwsObject._validateParamNum(arguments,1)||!h._dwsObject._validateNumberType("thickness",g)||!h._dwsObject._validateValue("thickness",g,[0,100000],true)){return false}h._documentBoundaryThickness=Math.round(g);return true};b.prototype.getDocumentBoundaryThickness=function(){var g=this;if(g._dwsObject._bDestoryed){return null}if(g._bDestoryed){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!f.one("#"+g._videoContainerId)||!f.one("#"+g._videoContainerId).getEL()){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!g._dwsObject._validateParamNum(arguments,0)){return null}return g._documentBoundaryThickness};b.prototype.setDocumentBoundaryColor=function(g){var h=this;if(h._dwsObject._bDestoryed){return false}if(h._bDestoryed){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!f.one("#"+h._videoContainerId)||!f.one("#"+h._videoContainerId).getEL()){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!h._dwsObject._validateParamNum(arguments,1)||!h._dwsObject._validateNumberType("color",g)||!h._dwsObject._validateValue("color",g,[h._MINCOLOR,h._MAXCOLOR],true)){return false}h._documentBoundaryColor=g;return true};b.prototype.getDocumentBoundaryColor=function(){var g=this;if(g._dwsObject._bDestoryed){return null}if(g._bDestoryed){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!f.one("#"+g._videoContainerId)||!f.one("#"+g._videoContainerId).getEL()){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!g._dwsObject._validateParamNum(arguments,0)){return null}return g._documentBoundaryColor};b.prototype._initObjImg=function(){var g=this;g._objImage=new Image();g._objImage.className="ds-dws-img-obj";g._makeImgObjUndragable(g._objImage)};b.prototype._getVideoViewerId=function(){return this._videoContainerId};b.prototype._getVideoViewerEl=function(){try{return f.one("#"+this._videoContainerId).getEL()}catch(g){return false}};b.prototype._attachImage=function(){var h=this;if(!h._dwsObject._validateDivDom(h._getVideoViewerId(),!1,!0)){h._clearStreamProp();return}if(h._bStreamPaused){h._objImage.style.display="block"}if(h._bStreamStopped){h._objImage.style.display="none"}if((h._bStreamPaused&&h._objImage.parentNode)||h._bStreamStopped){return}h._objImage.onload="";h._objImage.onerror="";var g=f.now();h._curLoadingImgCount=0;h._objImage.onload=function(){var m=this;h._objImage.onload="";h._objImage.onerror="";h._positionImgObj(isNaN(h._objImgWidth)?(h._bIe9_10&&m.naturalWidth?m.naturalWidth:m.width):h._objImgWidth,isNaN(h._objImgHeight)?(h._bIe9_10&&m.naturalHeight?m.naturalHeight:m.height):h._objImgHeight);if(h._bStreamStopped){h._objImage.style.display="none"}h._curLoadingImgCount=0;var j=f.now();if(!h._bStreamPaused&&!h._bStreamStopped){var l=parseInt(j-g),k=parseInt(d-l);setTimeout(function(){h._getFrame()},(f.isNaN(k)||k<=0)?0:k)}};h._objImage.onerror=function(){var j=this;++h._curLoadingImgCount;f.log("Stream "+j.src+" error.");j.style.display="none";if(h._curLoadingImgCount>=h._MAXLOADINGIMGCOUNT){h._clearStreamProp();a.handleImageLoadingError(h._dwsObject,j.src)}else{j.src=h._getFrameUrl(true)}};h._objImage.src=h._getFrameUrl(true)};b.prototype._repositionImgObj=function(){var g=this;if(g._bStreamPaused&&g._objImage&&g._objImage.width>0&&g._objImage.height>0){g._positionImgObj(g._objImage.width,g._objImage.height)}};b.prototype._positionImgObj=function(j,l,k){var m=this,h=0,g=0;k=k||m._objImage;if(!k){return}if(j/m._userVideoContainerWidth>l/m._userVideoContainerHeight){h=m._userVideoContainerWidth;g=l*m._userVideoContainerWidth/j}else{g=m._userVideoContainerHeight;h=j*m._userVideoContainerHeight/l}if(h<=0||isNaN(h)||g<=0||isNaN(g)){k.style.display="none";return}k.style.position="absolute";k.style.top=(m._userVideoContainerHeight-g)/2+"px";k.style.left=(m._userVideoContainerWidth-h)/2+"px";k.style.width=h+"px";k.style.height=g+"px";k.style.display="block";if(!k.parentNode){m._videoContainerWrapper.appendChild(k)}};b.prototype._showStream=function(){var g=this;g._bStreamStopped=false;g._bStreamPaused=false;if(e.navInfo.bIE){if(g._objImage&&g._objImage.parentNode){g._objImage.setAttribute("onmousedown","");g._objImage.setAttribute("unselectable","");g._objImage.setAttribute("draggable","");g._objImage.parentNode.removeChild(g._objImage)}g._initObjImg()}if(g._objImage){g._objImage.style.display="none"}g._objImgWidth=NaN;g._objImgHeight=NaN;g._getFrame(true);g._ifDocumentDetected()};b.prototype._ifDocumentDetected=function(){var g=this;g.pollDocument=setInterval(function(){if(g._bStreamStopped||g._bStreamPaused||g._bDestoryed){return false}if(g._dwsObject.getErrorCode()==-1022){return false}if(!f.isFunction(g.ondocumentboundarydetected)){return false}if(!g._documentDetected){return false}var h=g._GetDocBoundaryInfoFromVideo();if(h.length&&h.length==10&&g._mode=="Document"){g.ondocumentboundarydetected()}},500)};b.prototype._GetDocBoundaryInfoFromVideo=function(){var k=this,h;var j={session:a.sessionId,object:k._dwsObject._dwsObjectId,method:"GetDocBoundaryInfo"},g=function(l){h=l.result};f.detect.postSyncCommand(k._dwsObject,f.stringify(j),g,null);return h};b.prototype._getFrameUrl=function(h){var g=this;return[a.preUrl,a.portInfo.curPort,"/",e._getVersionStrForCommand(),"/stream?session=",a.sessionId,"&object=",g._dwsObject._dwsObjectId,"&width=",f.isNumber(g._userVideoContainerWidth)?g._userVideoContainerWidth:0,"&height=",f.isNumber(g._userVideoContainerHeight)?g._userVideoContainerHeight:0,"&mode=",g._mode.toLowerCase(),"&documentBoundaryThickness=",g._documentBoundaryThickness,"&documentBoundaryColor=",g._documentBoundaryColor,h?("&ts="+f.now()):""].join("")};b.prototype._getFrame=function(){var g=this;setTimeout(function(){g._attachImage()},0)};b.prototype._pauseStream=function(){var g=this;g._bStreamPaused=true;g._bStreamStopped=false;g._objImage.style.display="block"};b.prototype._StopStream=function(){var g=this;g._bStreamPaused=false;g._bStreamStopped=true;if(g._objImage){g._objImage.style.display="none"}};b.prototype._clearStreamProp=function(){var g=this;g._bStreamPaused=false;g._bStreamStopped=false};b.prototype._makeImgObjUndragable=function(g){g.setAttribute("onmousedown","return false;");g.setAttribute("unselectable","on");g.setAttribute("draggable","false")};b.prototype._setObjImgSize=function(h,g){this._objImgWidth=h;this._objImgHeight=g};b.prototype._destory=function(){var g=this;g._clearStreamProp();g._removeUserVideoContainerEvents();f.empty(g._videoContainerWrapper);f.empty(g._userVideoContainer);g._bDestoryed=true};f.sdk.VideoViewer=b})(dynamsoft.lib,dynamsoft.lib.detect,dynamsoft.dcsEnv);(function(a,d,b){a.ktVideoViewer=function(){var e=this;this._origDispaly="";this.onmouseclick=null;this.onmouserightclick=null;this.onmousedoubleclick=null;this.timer=null;this.isOnClickWait=false;this._onLeftclickWraper=function(f){e._onLeftclick.apply(e,[f])};d.addEventListener(this._userVideoContainer,"click",this._onLeftclickWraper);if(!dynamsoft.dcsEnv.navInfo.bHTML5Edition){d.addEventListener(this._userVideoContainer,"dblclick",this._onLeftclickWraper)}this._onRightclickWraper=function(f){e._onRightclick.apply(e,[f])};d.addEventListener(this._userVideoContainer,"contextmenu",this._onRightclickWraper)};a.VideoViewer.prototype._onLeftclick=function(e){e=d.switchEvent(e);if(e.which!=1){return}if(!this.isOnClickWait){this.isOnClickWait=true;var f=this;this.timer=setTimeout(function(){f.isOnClickWait=false;if(f.onmouseclick){f.onmouseclick.apply(f._userVideoContainer,[e])}},500)}else{this.isOnClickWait=false;clearTimeout(this.timer);if(this.onmousedoubleclick){this.onmousedoubleclick.apply(this._userVideoContainer,[e])}}};a.VideoViewer.prototype._onRightclick=function(e){e=d.switchEvent(e);if(this.onmouserightclick){this.onmouserightclick.apply(this._userVideoContainer,[e])}};a.VideoViewer.prototype._removeUserVideoContainerEvents=function(){d.removeEventListener(this._userVideoContainer,"click",this._onLeftclickWraper);d.removeEventListener(this._userVideoContainer,"contextmenu",this._onRightclickWraper)};a.VideoViewer.prototype._check=function(){this._dwsObject._setErrCodeErrString(d.errorInfo.getOkCode(),d.errorInfo.getOkString());var e=true;if(!d.one("#"+this._videoContainerId)||!d.one("#"+this._videoContainerId).getEL()){this._dwsObject._setErrCodeErrString(d.errorInfo.getObjectNotExistCode(),d.errorInfo.getObjectNotExistString("video viewer"));e=false}return e};a.VideoViewer.prototype._parseInt=function(e){return Math.round(parseFloat(e))};a.VideoViewer.prototype.getWidth=function(){if(!this._check()){return false}return this._userVideoContainer.style.width?this._parseInt(this._userVideoContainer.style.width):this._userVideoContainer.clientWidth};a.VideoViewer.prototype.setWidth=function(e){if(!this._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}e=this._parseInt(e);if(!e&&e!=0){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("width"));return false}else{if(e>b._uiMaxSize||e<1){this._dwsObject._setErrCodeErrString(d.errorInfo.getValueOutOfRangeCode(),d.errorInfo.getValueOutOfRangeString("width"));return false}}this._userVideoContainerWidth=e;this._userVideoContainer.style.width=e+"px";this._videoContainerWrapper.style.width=e+"px";this._repositionImgObj();return true};a.VideoViewer.prototype.getHeight=function(){if(!this._check()){return null}return this._userVideoContainer.style.height?this._parseInt(this._userVideoContainer.style.height):this._userVideoContainer.clientHeight};a.VideoViewer.prototype.setHeight=function(e){if(!this._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}e=this._parseInt(e);if(!e&&e!=0){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("height"));return false}else{if(e>b._uiMaxSize||e<1){this._dwsObject._setErrCodeErrString(d.errorInfo.getValueOutOfRangeCode(),d.errorInfo.getValueOutOfRangeString("height"));return false}}this._userVideoContainerHeight=e;this._userVideoContainer.style.height=e+"px";this._videoContainerWrapper.style.height=e+"px";this._repositionImgObj();return true};a.VideoViewer.prototype.getVideoQuality=function(){if(!this._check()){return null}var e={session:d.detect.sessionId,object:this._dwsObject._dwsObjectId,method:"GetVideoQuality"};var g=d.stringify(e);var f;var h=this;d.ajax({method:"POST",data:g,url:[d.detect.preUrl,d.detect.portInfo.curPort,"/",b._getVersionStrForCommand(),"/ts=",d.now()].join(""),onSuccess:function(j){f=j},onError:function(j){h._dwsObject._setErrCodeErrString(d.errorInfo.getConnectionToServiceLostCode(),d.errorInfo.getConnectionToServiceLostString())},dataType:"json",async:false});if(!f){return false}if(f.exception!=0){this._dwsObject._setErrCodeErrString(f.exception,f.description);return null}return f.result[0]};a.VideoViewer.prototype.setVideoQuality=function(h){if(!this._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if((typeof h!="number")){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("quality"));return false}h=this._parseInt(h);if(!h&&h!=0){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("quality"));return false}else{if(h>100||h<1){this._dwsObject._setErrCodeErrString(d.errorInfo.getValueOutOfRangeCode(),d.errorInfo.getValueOutOfRangeString("quality"));return false}}var e={session:d.detect.sessionId,object:this._dwsObject._dwsObjectId,method:"SetVideoQuality",parameter:[h]};var g=d.stringify(e);var f;var j=this;d.ajax({method:"POST",data:g,url:[d.detect.preUrl,d.detect.portInfo.curPort,"/",b._getVersionStrForCommand(),"/ts=",d.now()].join(""),onSuccess:function(k){f=k},onError:function(k){j._dwsObject._setErrCodeErrString(d.errorInfo.getConnectionToServiceLostCode(),d.errorInfo.getConnectionToServiceLostString())},dataType:"json",async:false});if(!f){return false}if(f.exception!=0){this._dwsObject._setErrCodeErrString(f.exception,f.description);return null}return f.result[0]};a.VideoViewer.prototype.getBackgroundColor=function(){if(!this._check()){return null}return d.colorStrToInt(this._userVideoContainer.style.backgroundColor?this._userVideoContainer.style.backgroundColor:d.currentStyle(this._userVideoContainer,"background-color"))};a.VideoViewer.prototype.setBackgroundColor=function(e){if(!this._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if((typeof e!="number")){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("backgroundColor"));return false}e=this._parseInt(e);if(!e&&e!=0){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("backgroundColor"));return false}else{if(e>4294967295||e<0){this._dwsObject._setErrCodeErrString(d.errorInfo.getValueOutOfRangeCode(),d.errorInfo.getValueOutOfRangeString("backgroundColor"));return false}}this._userVideoContainer.style.backgroundColor=d.IntToColorStr(e);return true};a.VideoViewer.prototype.show=function(){if(!this._check()){return false}if(arguments.length>0){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(false));return false}if(this._userVideoContainer.style.display=="none"){this._userVideoContainer.style.display=this._origDispaly}else{this._origDispaly=this._userVideoContainer.style.display;if(this._origDispaly=="none"){this._origDispaly=""}}return true};a.VideoViewer.prototype.hide=function(){if(!this._check()){return false}if(arguments.length>0){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(false));return false}this._origDispaly=this._userVideoContainer.style.display;if(this._origDispaly=="none"){this._origDispaly=""}this._userVideoContainer.style.display="none";return true}})(dynamsoft.lib.sdk,dynamsoft.lib,dynamsoft.dcsEnv);(function(e,d,b){function a(f){if(f&&f._imageViewerManager){return}this._dwsObject=f}a.prototype.addImageViewer=function(g,f){var l=this,h=!0;if(!e.isString(f)||f.indexOf(d._imgViewerClientIdPrefix)==-1){f=d._imgViewerClientIdPrefix+e.getRandom();var j={session:dynamsoft.lib.detect.sessionId,object:l._dwsObject._dwsObjectId,method:"AddImageViewer",parameter:[f]};h=dynamsoft.lib.detect.postSyncCommand(l._dwsObject,e.stringify(j),null,null)}if(h){var k=new b.ImageViewer(l._dwsObject,g,f);d._imageViewerDic[g]={dwsObject:l._dwsObject,imageViewer:k,imgViewerClientId:f};k.ui.setImageViewMode(1,1)}return h};a.prototype.removeImageViewer=function(g){var l=this,f=false,k=d._imageViewerDic[g],j=k.imageViewer,h={session:dynamsoft.lib.detect.sessionId,object:l._dwsObject._dwsObjectId,method:"RemoveImageViewer",parameter:[j._imgViewerId]};f=dynamsoft.lib.detect.postSyncCommand(l._dwsObject,e.stringify(h),null,null);if(f){j.ui._destory(true);j.image._destory(true);j.io._destory(true);delete d._imageViewerDic[g]}return f};b.ImageViewerManager=a})(dynamsoft.lib,dynamsoft.dcsEnv,dynamsoft.lib.sdk);(function(d,b){function a(g,f,e){var h=this;this._innerIndex=d.guid();h._dwsObject=g;h._imgViewerId=e;h.image=new b.Image(g,h);h.ui=new b.UI(g,h,f);h.io=new b.IO(g,h)}b.ImageViewer=a})(dynamsoft.lib,dynamsoft.lib.sdk);(function(o,l,s,b){var a=[],g={None:4,FitToWindow:0},q={UP:0,DOWN:1,LEFT:2,RIGHT:3},j={ZOOMIN:0,ZOOMOUT:1};LENGTHCONSTANT=s._uiMaxSize,MINZOOM=0.02,MAXZOOM=65;function f(C,x,B){var z=this;z._dwsObject=C;z._imageViewer=x;z._imageContainerId=B;z._userImageContainer=o.one("#"+B).getEL();o.empty(z._userImageContainer);var A=o.getElDimensions(z._userImageContainer,false);z._userImageViewerWidth=A?A.clientWidth:z._userImageContainer.clientWidth;z._userImageViewerHeight=A?A.clientHeight:z._userImageContainer.clientHeight;z._userImageContainer.innerHTML='<div class="ds-dws-img-viewer-wrapper" oncontextmenu="return false;"><div class="ds-dws-img-viewer-container ds-dws-display-inline-block"></div></div>';z._imageContainerWrapper=o.one(".ds-dws-img-viewer-wrapper",z._userImageContainer).getEL();z._imageContainerWrapper.style.width=z._userImageViewerWidth+"px";z._imageContainerWrapper.style.height=z._userImageViewerHeight+"px";z._imageContainerWrapper.style.position="relative";z._bFocus=false;var y=function(){z._bFocus=true};o.addEventListener(z._imageContainerWrapper,"mouseover",y);var u=function(){z._bFocus=false};o.addEventListener(z._imageContainerWrapper,"mouseout",u);var w=function(){return false};o.addEventListener(z._imageContainerWrapper,"selectstart",w);var t=function(E){E=E||window.event;if(!z._bFocus||z._bSingleMode||z._bVerticalMode){return true}var F=o.getWheelDelta(E);o.stopPropagation(E);z._imageContainerWrapper.scrollLeft-=F*120;return false};o.addEventListener(z._imageContainerWrapper,"mousewheel",t);var D=function(){if(!z._bFocus||!z._bSingleMode||!z._fitToWindowType){return true}z._calImgCtrlActualCentralPoint();return false};o.addEventListener(z._imageContainerWrapper,"scroll",D);z._onImgContainerWrapperScroll=D;f.prototype._removeImgContainerWrapperEvents=function(){o.removeEventListener(this._imageContainerWrapper,"mouseover",y);o.removeEventListener(this._imageContainerWrapper,"mouseout",u);o.removeEventListener(this._imageContainerWrapper,"selectstart",w);o.removeEventListener(this._imageContainerWrapper,"mousewheel",t);o.removeEventListener(this._imageContainerWrapper,"scroll",D)};z._imageContainerBox=o.one(".ds-dws-img-viewer-container",z._imageContainerWrapper).getEL();z._imageContainerBox.style.position="relative";z._imageMargin=-1;z._calcImageMargin=-1;z._borderWidth=1;z._selectedImageBorderWidth=1;z._calcSelectedImageBorderWidth=1;z._selectedBorderColor=2107821823;z._mouseShape=false;z.EnumFitToWindowType=g;z._fitToWindowType=g.FitToWindow;z._imagesPerRow=0;z._imagesPerColumn=0;z._bSingleMode=false;z._bVerticalMode=true;z._iControlWidth=0;z._iControlHeight=0;z._aryImageControls=[];z.imgSelector=null;z._onimageareaselected=null;z._onimageareadeselected=null;z.onmouseclick=null;z.onmouserightclick=null;z.onmousedoubleclick=null;z.onmousemove=null;z._displayMode="";z._scrollToImgCtrlIndexAfterShowed=-1;z._bAdjustNonFitToWindowImgCtrlAfterShowed=false;z._zoom=1;z._bDestoryed=false;z._bRemoved=false;z._ratio=0;a.push(z)}f.prototype._getImgViewerId=function(){return this._imageContainerId};f.prototype._getImgViewerEl=function(){try{return o.one("#"+this._imageContainerId).getEL()}catch(t){return false}};f.prototype.setSelectionRectAspectRatio=function(t){var u=this;if(u._bDestoryed){return false}if(!u._dwsObject._validateDivDom(u._getImgViewerId(),!0)){return false}if(!u._dwsObject._validateImgViewerExist(u._getImgViewerId(),u._bRemoved)){return false}if(!u._dwsObject._validateParamNum(arguments,1)||!u._dwsObject._validateNumberType("value",t)||!u._dwsObject._validateValue("value",t,[0,10000],true)){return false}u._ratio=t;return true};f.prototype.getSelectionRectAspectRatio=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._ratio};f.prototype.getMargin=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return(t._imageMargin<1)?t._calcImageMargin:t._imageMargin};f.prototype.setMargin=function(w){var x=this;if(x._bDestoryed){return false}if(!x._dwsObject._validateDivDom(x._getImgViewerId(),!0)){return false}if(!x._dwsObject._validateImgViewerExist(x._getImgViewerId(),x._bRemoved)){return false}if(!x._dwsObject._validateParamNum(arguments,1)||!x._dwsObject._validateNumberType("iValue",w)){return false}w=Math.round(w);if(w<1){x._dwsObject._setErrCodeErrString(o.errorInfo.getValueOutOfRangeCode(),o.errorInfo.getValueOutOfRangeString("iValue"));return false}if(!x._dwsObject._validateValue("iValue",w,[1,LENGTHCONSTANT],true)){return false}if(x._imageMargin==w){return true}x._imageMargin=w;var t=x._imageContainerWrapper.scrollLeft,u=x._imageContainerWrapper.scrollTop;x._refresh();x._setScrollBarPosition(u,t);return true};f.prototype.getWidth=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._userImageViewerWidth};f.prototype.setWidth=function(u){var w=this;if(w._bDestoryed){return false}if(!w._dwsObject._validateDivDom(w._getImgViewerId(),!0)){return false}if(!w._dwsObject._validateImgViewerExist(w._getImgViewerId(),w._bRemoved)){return false}if(!w._dwsObject._validateParamNum(arguments,1)||!w._dwsObject._validateNumberType("iValue",u)){return false}u=Math.round(u);if(u<1){w._dwsObject._setErrCodeErrString(o.errorInfo.getValueOutOfRangeCode(),o.errorInfo.getValueOutOfRangeString("iValue"));return false}if(!w._dwsObject._validateValue("iValue",u,[1,LENGTHCONSTANT],true)){return false}if(w._userImageViewerWidth==u){return true}w._userImageViewerWidth=u;var t=w._getFirstVisibleElemIndex();w._userImageContainer.style.width=u+"px";w._imageContainerWrapper.style.width=u+"px";w._refresh();w._scrollToImgCtrl(t);return true};f.prototype.getHeight=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._userImageViewerHeight};f.prototype.setHeight=function(u){var w=this;if(w._bDestoryed){return false}if(!w._dwsObject._validateDivDom(w._getImgViewerId(),!0)){return false}if(!w._dwsObject._validateImgViewerExist(w._getImgViewerId(),w._bRemoved)){return false}if(!w._dwsObject._validateParamNum(arguments,1)||!w._dwsObject._validateNumberType("iValue",u)){return false}u=Math.round(u);if(u<1){w._dwsObject._setErrCodeErrString(o.errorInfo.getValueOutOfRangeCode(),o.errorInfo.getValueOutOfRangeString("iValue"));return false}if(!w._dwsObject._validateValue("iValue",u,[1,LENGTHCONSTANT],true)){return false}if(w._userImageViewerHeight==u){return true}w._userImageViewerHeight=u;var t=w._getFirstVisibleElemIndex();w._userImageContainer.style.height=u+"px";w._imageContainerWrapper.style.height=u+"px";w._refresh();w._scrollToImgCtrl(t);return true};f.prototype.getSelectedImageBorderWidth=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._selectedImageBorderWidth};f.prototype.setSelectedImageBorderWidth=function(w){var x=this;if(x._bDestoryed){return false}if(!x._dwsObject._validateDivDom(x._getImgViewerId(),!0)){return false}if(!x._dwsObject._validateImgViewerExist(x._getImgViewerId(),x._bRemoved)){return false}if(!x._dwsObject._validateParamNum(arguments,1)||!x._dwsObject._validateNumberType("iValue",w)){return false}w=Math.round(w);if(w<1){x._dwsObject._setErrCodeErrString(o.errorInfo.getValueOutOfRangeCode(),o.errorInfo.getValueOutOfRangeString("iValue"));return false}if(!x._dwsObject._validateValue("iValue",w,[1,LENGTHCONSTANT],true)){return false}if(x._selectedImageBorderWidth==w||x._calcSelectedImageBorderWidth==w){return true}x._selectedImageBorderWidth=w;var t=x._imageContainerWrapper.scrollLeft,u=x._imageContainerWrapper.scrollTop;x._refresh();x._setScrollBarPosition(u,t);return true};f.prototype.getMouseShape=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._mouseShape};f.prototype.setMouseShape=function(u){var w=this;if(w._bDestoryed){return false}if(!w._dwsObject._validateDivDom(w._getImgViewerId(),!0)){return false}if(!w._dwsObject._validateImgViewerExist(w._getImgViewerId(),w._bRemoved)){return false}if(!w._dwsObject._validateParamNum(arguments,1)||!w._dwsObject._validateBooleanType("iValue",u)){return false}if(w._mouseShape==u){return true}w._mouseShape=u;for(var t=0;t<w._aryImageControls.length;t++){w._aryImageControls[t].setMouseShape(u)}return true};f.prototype.getFitToWindowType=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._fitToWindowType};f.prototype.setFitToWindowType=function(t){var u=this;if(u._bDestoryed){return false}if(!u._dwsObject._validateDivDom(u._getImgViewerId(),!0)){return false}if(!u._dwsObject._validateImgViewerExist(u._getImgViewerId(),u._bRemoved)){return false}if(!u._dwsObject._validateParamNum(arguments,1)||!u._dwsObject._validateNumberType("iValue",t)){return false}t=Math.round(t);if(!u._dwsObject._validateValue("iValue",t,[0,4],false)){return false}if(u._fitToWindowType==t){return true}u._fitToWindowType=t;if(u._bSingleMode){u._refresh()}return true};f.prototype.getZoom=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._zoom};f.prototype.setZoom=function(t){var u=this;if(u._bDestoryed){return false}if(!u._dwsObject._validateDivDom(u._getImgViewerId(),!0)){return false}if(!u._dwsObject._validateImgViewerExist(u._getImgViewerId(),u._bRemoved)){return false}if(!u._dwsObject._validateParamNum(arguments,1)||!u._dwsObject._validateNumberType("iValue",t)){return false}if(!u._dwsObject._validateValue("iValue",t,[MINZOOM,MAXZOOM],true)){return false}if(u._zoom==t){return true}u._zoom=t;if(!u._bSingleMode||u._fitToWindowType!=g.None){return true}u._refresh();u._bAdjustNonFitToWindowImgCtrlAfterShowed=u._bIsImageViewerHiden();return true};var e="getBackgroundColor",d="setBackgroundColor",m="getSelectedImageBorderColor",p="setSelectedImageBorderColor",n=0,h=4294967295;o.each([e,d,m,p],function(t){f.prototype[t]=function(){var u=this;if(u._bDestoryed){return false}if(!u._dwsObject._validateDivDom(u._getImgViewerId(),!0)){return(t==e||t==m)?undefined:false}if(!u._dwsObject._validateImgViewerExist(u._getImgViewerId(),u._bRemoved)){return(t==e||t==m)?undefined:false}if(t==e||t==m){if(!u._dwsObject._validateParamNum(arguments,0)){return null}}if(t==d||t==p){if(!u._dwsObject._validateParamNum(arguments,1)||!u._dwsObject._validateNumberType("iValue",arguments[0])||!u._dwsObject._validateValue("iValue",arguments[0],[n,h],true)){return false}}if(t==e){return o.colorStrToInt(u._userImageContainer.style.backgroundColor?u._userImageContainer.style.backgroundColor:o.currentStyle(u._userImageContainer,"background-color"))}if(t==d){u._userImageContainer.style.backgroundColor=o.IntToColorStr(arguments[0]);return true}if(t==m){return u._selectedBorderColor}if(t==p){u._selectedBorderColor=arguments[0];u._refresh();return true}}});o.each(["getContainerId","show","hide"],function(t){f.prototype[t]=function(){var w=this;if(w._bDestoryed){return t=="getContainerId"?null:false}var u=w._getImgViewerId();if(!w._dwsObject._validateDivDom(u,!0)){return t=="getContainerId"?null:!1}if(!w._dwsObject._validateImgViewerExist(w._getImgViewerId(),w._bRemoved)){return t=="getContainerId"?null:!1}if(!w._dwsObject._validateParamNum(arguments,0)){return t=="getContainerId"?null:!1}if(t=="getContainerId"){return u}if(t=="show"){w._displayMode=(w._displayMode=="none")?"":w._displayMode;if(w._userImageContainer.style.display=="none"){w._userImageContainer.style.display=w._displayMode}else{w._displayMode=w._userImageContainer.style.display}if(w._scrollToImgCtrlIndexAfterShowed!=-1){w._scrollToImgCtrl(w._scrollToImgCtrlIndexAfterShowed)}w._scrollToImgCtrlIndexAfterShowed=-1;if(w._bAdjustNonFitToWindowImgCtrlAfterShowed&&w._bSingleMode&&w._fitToWindowType){w._showNonFitToWinImgCtrl()}w._bAdjustNonFitToWindowImgCtrlAfterShowed=false}if(t=="hide"){if(w._userImageContainer.style.display!="none"){w._displayMode=w._userImageContainer.style.display}w._userImageContainer.style.display="none";w._displayMode=(w._displayMode=="none")?"":w._displayMode}return !0}});f.prototype._bIsImageViewerHiden=function(){return this._userImageContainer.style.display=="none"};f.prototype.setImageViewMode=function(w,z){var A=this;if(A._bDestoryed){return false}if(!A._dwsObject._validateDivDom(A._getImgViewerId(),!0)){return false}if(!A._dwsObject._validateImgViewerExist(A._getImgViewerId(),A._bRemoved)){return false}if(!A._dwsObject._validateParamNum(arguments,2)||!A._dwsObject._validateNumberType("column",w)||!A._dwsObject._validateNumberType("row",z)){return false}w=Math.round(w);z=Math.round(z);if((w==-1&&z!=-1)||(w>0&&z!=-1&&z<=0)){A._dwsObject._setErrCodeErrString(o.errorInfo.getValueNotValidCode(),o.errorInfo.getValueNotValidString("row"));return false}if((z==-1&&w!=-1&&w<=0)||(z>0&&w<=0)){A._dwsObject._setErrCodeErrString(o.errorInfo.getValueNotValidCode(),o.errorInfo.getValueNotValidString("column"));return false}if(w==0&&z==0){A._dwsObject._setErrCodeErrString(o.errorInfo.getValueNotValidCode(),o.errorInfo.getValueNotValidString("column"));return false}if(w<-1){A._dwsObject._setErrCodeErrString(o.errorInfo.getValueNotValidCode(),o.errorInfo.getValueNotValidString("column"));return false}if(z<-1){A._dwsObject._setErrCodeErrString(o.errorInfo.getValueNotValidCode(),o.errorInfo.getValueNotValidString("row"));return false}var y=A._bSingleMode,u=A._bVerticalMode,x=A._imagesPerRow,t=A._imagesPerColumn;if(w==-1&&z==-1){A._bSingleMode=true;A._bVerticalMode=false;A._imagesPerColumn=1;A._imagesPerRow=1}else{if(w>0&&z==-1){A._bSingleMode=false;A._bVerticalMode=false;A._imagesPerColumn=w;A._imagesPerRow=1}else{if(w>0&&z>0){A._bSingleMode=false;A._bVerticalMode=true;A._imagesPerColumn=w;A._imagesPerRow=z}}}if(y==A._bSingleMode&&u==A._bVerticalMode&&t==A._imagesPerColumn&&x==A._imagesPerRow){return true}A._refresh();if(!A._bSingleMode){A._scrollToImgCtrl(0)}else{A._imageViewer.image._innerSetIndexInfo(null,null,A._imageViewer.image.getIndex(),[A._imageViewer.image.getIndex()],false,false)}return true};f.prototype._addImageControl=function(u){var x=this;var t=x._imageViewer.image._innerIncCount();if(x.imgSelector){x.imgSelector.hide();x.imgSelector.clearRect();x.imgSelector=null;if(x._onimageareadeselected&&typeof x._onimageareadeselected=="function"){setTimeout(function(){that._onimageareadeselected(index)},0)}}x._imageViewer.image._innerSetIndexInfo(null,null,t-1,[t-1],false,false);var w=new l.ImageControl(x._dwsObject,x._mouseShape,x._imageViewer);w.imageIndex=x._imageViewer.image.getIndex();w.iImageViewerWidth=x._userImageViewerWidth;w.iImageViewerHeight=x._userImageViewerHeight;w.borderWidth=x._borderWidth;w.selectionBorderWidth=x._calcSelectedImageBorderWidth;w.selectionBorderColor=x._selectedBorderColor;x._attachImgControlEventHandlers(w);x._aryImageControls.push(w);x._refresh();x._imageContainerBox.appendChild(w.outerDiv);x._scrollToImgCtrl(w.imageIndex);u=u||[b.preUrl,b.portInfo.curPort,"/",s._getVersionStrForCommand(),"/img?session=",b.sessionId,"&object=",x._dwsObject._dwsObjectId,"&imageviewer=",x._imageViewer._imgViewerId,"&index=",x._imageViewer.image.getIndex()].join("");w.attachImage(u)};f.prototype._involkeUserMouseEventHandler=function(t,w){var u=this;if(!o.isFunction(u[t])&&!o.isNull(u[t])){u._dwsObject._setErrCodeErrString(o.errorInfo.getTypeNotValidCode(),o.errorInfo.getTypeNotValidString(t,!0))}else{if(!o.isNull(u[t])){u._dwsObject._setErrCodeErrString(o.errorInfo.getOkCode(),o.errorInfo.getOkString());setTimeout(function(){u[t](w.index,w.mouseX,w.mouseY)},0)}}};f.prototype._attachImgControlEventHandlers=function(u){if(!(u instanceof o.sdk.ImageControl)){return}var t=this;u.onMouseClick=function(w){t._onMouseClick(w);t._involkeUserMouseEventHandler("onmouseclick",w)};u.onMouseDoubleClick=function(w){t._involkeUserMouseEventHandler("onmousedoubleclick",w)};u.onMouseRightClick=function(w){t._involkeUserMouseEventHandler("onmouserightclick",w)};u.onMouseMove=function(w){t._involkeUserMouseEventHandler("onmousemove",w)};u.onImageAreaSelected=function(z){var x=z.imgSelector;var A=t._imageViewer.image._getIndex();var y=t._imageViewer.image._getSelectedIndices().slice().sort(function(C,B){return C-B});var w=z.index;t._imageViewer.image._innerSetIndexInfo(A,y,w,[w],true,false);t.imgSelector=z.imgSelector;if(!o.isFunction(t._onimageareaselected)&&!o.isNull(t._onimageareaselected)){t._dwsObject._setErrCodeErrString(o.errorInfo.getTypeNotValidCode(),o.errorInfo.getTypeNotValidString("_onimageareaselected",!0));return}if(!o.isNull(t._onimageareaselected)){setTimeout(function(){t._onimageareaselected(x.imgCtrl.imageIndex,x.actualImgRect.left,x.actualImgRect.top,x.actualImgRect.right,x.actualImgRect.bottom)},0)}};u.onImageDraggingFinished=function(){t._calImgCtrlActualCentralPoint()};u.onImageAreaDeSelected=function(){if(!(t.imgSelector instanceof o.sdk.ImageSelector)||t.imgSelector.bDestroy||!(t.imgSelector.isValidSelector())||t.imgSelector.imgCtrl.imageIndex<0||t.imgSelector.imgCtrl.imageIndex>t._imageViewer.image._getCount()-1){if(t.imgSelector){t.imgSelector.hide()}t.imgSelector=null;return}if(!o.isFunction(t._onimageareadeselected)&&!o.isNull(t._onimageareadeselected)){t._dwsObject._setErrCodeErrString(o.errorInfo.getTypeNotValidCode(),o.errorInfo.getTypeNotValidString("_onimageareadeselected",!0));t.imgSelector.hide();t.imgSelector=null;return}var w=t.imgSelector.imgCtrl.imageIndex;t.imgSelector.hide();t.imgSelector.clearRect();t.imgSelector=null;if(!o.isNull(t._onimageareadeselected)){setTimeout(function(){t._onimageareadeselected(w)},0)}};u.onImageDragging=function(w){t._setScrollBarPosition(t._imageContainerWrapper.scrollTop+w.deltaY,t._imageContainerWrapper.scrollLeft+w.deltaX)}};f.prototype._onMouseClick=function(y){var D=this;var A=0,G=0,K=y.index,u=D._imageViewer.image._getIndex(),z=D._imageViewer.image._getSelectedIndices().slice().sort(function(M,L){return M-L}),w=-1,J=D._imageViewer.image._getSelectedIndices().slice().sort(function(M,L){return M-L}),I=J.indexOf(K),t=y.e.ctrlKey,F=y.e.shiftKey,E=y.e.metaKey;var C=function(L){var M=D._aryImageControls[L];if(M&&M.imgSelector){M.imgSelector.bNeedResize=!0}};if(I==-1){if(t||F||E||J.length<1){J.push(K)}else{if(J.length==1){if(J[0]==K){C(K);return}J[0]=K}else{J=[];J.push(K)}}}else{if((t||E)&&J.length>1){J.splice(I,1)}else{if(F){J.push(K)}else{if(J.length==1&&u==K){C(K);return}J=[];J.push(K)}}}if(F){var H=J[0],B=J[J.length-1];J=[];if(B==H){J.push(parseInt(H))}else{if(B>H){G=B-H+1;for(A=0;A<G;A++){J.push(parseInt(H+A))}}else{G=H-B+1;J.push(parseInt(H));for(A=0;A<G-1;A++){J.push(parseInt(B+A))}}}}J.sort(function(M,L){return M-L});if(J.indexOf(K)!=-1){w=K}else{if(J.indexOf(u)==-1){var x=J.length;for(A=0;A<J.length;A++){if(J[A]>u){x=A;break}}w=(x<J.length)?J[x]:J[A-1]}else{w=u}}D._imageViewer.image._innerSetIndexInfo(u,z,w,J,true,false)};f.prototype.getImageSelectedAreaInfo=function(){var t=this;if(t._bDestoryed){return false}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}if(!(t.imgSelector instanceof o.sdk.ImageSelector)||t.imgSelector.bDestroy||!(t.imgSelector.isValidSelector())||t.imgSelector.imgCtrl.imageIndex<0||t.imgSelector.imgCtrl.imageIndex>t._imageViewer.image._getCount()-1){return null}return new k(t.imgSelector.imgCtrl.imageIndex,t.imgSelector.actualImgRect.left,t.imgSelector.actualImgRect.top,t.imgSelector.actualImgRect.right,t.imgSelector.actualImgRect.bottom)};f.prototype._performLeftKeyOperation=function(){this._performArrowKeyOpertion(q.LEFT)};f.prototype._performRightKeyOperation=function(){this._performArrowKeyOpertion(q.RIGHT)};f.prototype._performUpKeyOperation=function(){var t=this;if(!t._bSingleMode&&!t._fitToWindowType&&!t._bVerticalMode){return}t._performArrowKeyOpertion(q.UP)};f.prototype._performDownKeyOperaton=function(){var t=this;if(!t._bSingleMode&&!t._fitToWindowType&&!t._bVerticalMode){return}t._performArrowKeyOpertion(q.DOWN)};f.prototype._performPageUpKeyOperation=function(){var t=this;if(!t._bSingleMode&&!t._fitToWindowType&&!t._bVerticalMode){return}t._performPageUpDownOperation(true)};f.prototype._performPageDownKeyOperation=function(){var t=this;if(!t._bSingleMode&&!t._fitToWindowType&&!t._bVerticalMode){return}t._performPageUpDownOperation(false)};f.prototype._performHomeKeyOperation=function(){this._setScrollBarPosition(0,0)};f.prototype._performEndKeyOperation=function(){var t=this;if(t._bSingleMode){t._setScrollBarPosition(t._imageContainerWrapper.scrollHeight,t._imageContainerWrapper.scrollWidth)}else{if(t._bVerticalMode){t._setScrollBarPosition(t._imageContainerWrapper.scrollHeight,0)}else{t._setScrollBarPosition(0,t._imageContainerWrapper.scrollWidth)}}};f.prototype._performPageUpDownOperation=function(t){var x=this;if(!x._bSingleMode){var u=x._getFirstVisibleElemIndex(),w;if(t){w=u-x._imagesPerColumn*x._imagesPerRow;w=w<0?0:w}else{w=u+x._imagesPerColumn*x._imagesPerRow;w=(w>x._imageViewer.image._count-1)?(x._imageViewer.image._count-1):w}x._scrollToImgCtrl(w)}else{if(x._fitToWindowType){if(t){x._imageContainerWrapper.scrollTop-=(x._userImageViewerHeight-x._imageMargin)}else{x._imageContainerWrapper.scrollTop+=(x._userImageViewerHeight-x._imageMargin)}}}};f.prototype._performArrowKeyOpertion=function(y){var z=this;if(!z._bSingleMode){var w=-1,t=z._imageViewer.image.getIndex(),x=z._aryImageControls[t],u;switch(y){case q.UP:w=t-z._imagesPerColumn;break;case q.DOWN:w=t+z._imagesPerColumn;break;case q.LEFT:w=t-1;break;case q.RIGHT:w=t+1;break;default:break}u=z._aryImageControls[w];if(!x||!u){return}z._imageViewer.image._innerSetIndexInfo(t,z._imageViewer.image.getSelectedIndices(),w,[w],true,true)}else{if(z._fitToWindowType){switch(y){case q.UP:z._setScrollBarPosition(z._imageContainerWrapper.scrollTop-z._imageContainerWrapper.scrollHeight*0.05,undefined);break;case q.DOWN:z._setScrollBarPosition(z._imageContainerWrapper.scrollTop+z._imageContainerWrapper.scrollHeight*0.05,undefined);break;case q.LEFT:z._setScrollBarPosition(undefined,z._imageContainerWrapper.scrollLeft-z._imageContainerWrapper.scrollWidth*0.05);break;case q.RIGHT:z._setScrollBarPosition(undefined,z._imageContainerWrapper.scrollLeft+z._imageContainerWrapper.scrollWidth*0.05);break;default:break}z._calImgCtrlActualCentralPoint()}}};f.prototype._performZoomOpertion=function(t){if(t!=j.ZOOMIN&&t!=j.ZOOMOUT){return}var w=this;if(t===j.ZOOMIN&&w._zoom===MAXZOOM||t===j.ZOOMOUT&&w._zoom===MINZOOM){return}var u=w._zoom*((t==j.ZOOMIN)?1.2:0.8);if(u<MINZOOM){w._zoom=MINZOOM}else{if(u>MAXZOOM){w._zoom=MAXZOOM}else{w._zoom=u}}w._refresh()};f.prototype._keydownEventHandler=function(u){var t=true,w=this;if(!w._bFocus){return t}switch(u.keyCode){case 37:t=false;w._performLeftKeyOperation();break;case 39:t=false;w._performRightKeyOperation();break;case 38:t=false;w._performUpKeyOperation();break;case 40:t=false;w._performDownKeyOperaton();break;case 33:t=false;w._performPageUpKeyOperation();break;case 34:t=false;w._performPageDownKeyOperation();break;case 35:t=false;w._performEndKeyOperation();break;case 36:t=false;w._performHomeKeyOperation();break;case 82:break;case 107:t=false;w._performZoomOpertion(j.ZOOMIN);break;case 109:t=false;w._performZoomOpertion(j.ZOOMOUT);break;default:break}if(!t){o.stopPropagation(u)}return t};var r=function(u){u=u||window.event;var t=true;o.each(a,function(w){if(w instanceof dynamsoft.lib.sdk.UI){if(w._bFocus){t=w._keydownEventHandler(u);if(!t){return false}}else{return t}}});return t};o.addEventListener(document.documentElement,"keydown",r);f.prototype._refreshIndexInfo=function(C,F,w,x,A,t){var z=this,E,y,B=[],u=z._imageContainerWrapper.scrollLeft,D=z._imageContainerWrapper.scrollTop;for(y=0;y<F.length;y++){if(x.indexOf(F[y])==-1){continue}B.push(F[y])}if(t){B=[]}for(y=0;y<F.length;y++){E=z._aryImageControls[F[y]];if(null!=E&&B.indexOf(F[y])==-1){E.bIfCurrentIndex=false;E.refresh(z._iControlWidth,z._iControlHeight);E.setSelect(false)}}for(y=0;y<x.length;y++){E=z._aryImageControls[x[y]];if(null!=E&&B.indexOf(x[y])==-1){if(x[y]==w){E.bIfCurrentIndex=true}E.refresh(z._iControlWidth-(z._calcSelectedImageBorderWidth-z._borderWidth)*2,z._iControlHeight-(z._calcSelectedImageBorderWidth-z._borderWidth)*2);E.setSelect(true)}}if(!z._bSingleMode&&z._bVerticalMode&&z._getHowManyRows()<=z._imagesPerRow||!z._bSingleMode&&!z._bVerticalMode&&z._imageViewer.image._count<=z._imagesPerColumn){z._refresh()}if(A){z._setImgCtrlVisible(w)}else{z._setScrollBarPosition(D,u)}};f.prototype._refreshWhenCountReduced=function(w){var z=this,t=z._imageViewer.image.getCount(),y=w-t,x;if(y<=0){return}for(var u=w-1;u>=t;u--){x=z._aryImageControls[u];if(x){z._aryImageControls.splice(u,1);x.destroy()}}z._refresh()};f.prototype._setScrollBarPosition=function(u,t){if(u!=undefined||u!=null){this._imageContainerWrapper.scrollTop=u}if(t!=undefined||t!=null){this._imageContainerWrapper.scrollLeft=t}};f.prototype._scrollToImgCtrl=function(t){var w=this;if(w._bSingleMode||t<0||t>=w._aryImageControls.length){return}var u=o.all(".ds-dws-img-container",w._imageContainerBox)[t];if(!u){return}if(w._bIsImageViewerHiden()){w._scrollToImgCtrlIndexAfterShowed=t}if(w._bVerticalMode){w._setScrollBarPosition(u.offsetTop-w._calcImageMargin,undefined)}else{w._setScrollBarPosition(undefined,u.offsetLeft-w._calcImageMargin)}};f.prototype._setImgCtrlVisible=function(t){var x=this;if(x._bSingleMode||t<0||t>=x._aryImageControls.length){return}var u=x._getVisibleElemIndices();if(u.length==0){return}if(u.indexOf(t)==-1){if(t<u[u.length-1]){x._scrollToImgCtrl(t)}else{var w=x._bVerticalMode?(parseInt((t+x._imagesPerColumn)/x._imagesPerColumn)-x._imagesPerRow)*x._imagesPerColumn:(parseInt((t+x._imagesPerRow)/x._imagesPerRow)-x._imagesPerColumn)*x._imagesPerRow;w=w<0?0:w;w=w>=x._aryImageControls.length?(x._aryImageControls.length-1):w;x._scrollToImgCtrl(w)}}else{x._scrollToImgCtrl(u[0])}};f.prototype._getFirstVisibleElemIndex=function(){var A=this;if(A._imageViewer.image._count==0){return -1}if(A._bSingleMode){return A._imageViewer.image.getIndex()}else{if(A._bVerticalMode){var y=A._imageContainerWrapper.scrollHeight,x=A._imageContainerWrapper.scrollTop,w;if(x<=0||y<=0){return 0}w=Math.round(x*A._getHowManyRows()/y);return w*A._imagesPerColumn}else{var t=A._imageContainerWrapper.scrollWidth,u=A._imageContainerWrapper.scrollLeft,z;if(u<=0||t<=0){return 0}z=Math.round(u*A._getHowManyCols()/t);return z*A._imagesPerRow}}};f.prototype._getVisibleElemIndices=function(){var t=this._getFirstVisibleElemIndex(),w=[];for(var u=0;u<this._imagesPerRow*this._imagesPerColumn;u++){w.push(t+u)}return w};f.prototype._getHowManyRows=function(){return parseInt((this._imageViewer.image._count+this._imagesPerColumn-1)/this._imagesPerColumn)};f.prototype._getHowManyCols=function(){return parseInt((this._imageViewer.image._count+this._imagesPerRow-1)/this._imagesPerRow)};f.prototype._getScrollBarWidth=function(){if(s.navInfo.scrollBarWidth){return s.navInfo.scrollBarWidth}var w=document.createElement("p");w.style.width="100%";w.style.height="200px";var x=document.createElement("div");x.style.position="absolute";x.style.top="0px";x.style.left="0px";x.style.visibility="hidden";x.style.width="200px";x.style.height="150px";x.style.overflow="hidden";x.appendChild(w);document.body.appendChild(x);var u=w.offsetWidth;x.style.overflow="scroll";var t=w.offsetWidth;if(u==t){t=x.clientWidth}document.body.removeChild(x);s.navInfo.scrollBarWidth=u-t;return s.navInfo.scrollBarWidth};f.prototype._calcControlsSize=function(){var A=this;if(A._imageMargin!=-1){A._calcImageMargin=A._imageMargin}if(!A._bSingleMode){var y=A._getScrollBarWidth();if(A._bVerticalMode){if(A._getHowManyRows()<=A._imagesPerRow){y=0}if(A._imageMargin==-1){var x=parseInt(A._userImageViewerHeight/(A._imagesPerRow*10));var z=parseInt((A._userImageViewerWidth-y)/(A._imagesPerColumn*10));var w=Math.min(x,z);if(A._calcImageMargin<=0){A._calcImageMargin=parseInt(w)}else{A._calcImageMargin=parseInt(A._calcImageMargin<w?A._calcImageMargin:w)}}}else{if(A._imageViewer.image._count<=A._imagesPerColumn){y=0}if(A._imageMargin==-1){var x=parseInt((A._userImageViewerHeight-y)/(A._imagesPerRow*10));var z=parseInt((A._userImageViewerWidth)/(A._imagesPerColumn*10));var w=x<z?x:z;if(A._calcImageMargin<=0){A._calcImageMargin=parseInt(w)}else{A._calcImageMargin=parseInt(A._calcImageMargin<w?A._calcImageMargin:w)}}}if(A._imagesPerColumn==A._imagesPerRow&&A._imagesPerRow==1){A._calcImageMargin=0}var t=0;var u=0;if(A._bVerticalMode==true){t=A._userImageViewerHeight-A._calcImageMargin;u=A._userImageViewerWidth-y-A._calcImageMargin}else{t=A._userImageViewerHeight-y-A._calcImageMargin;u=A._userImageViewerWidth-A._calcImageMargin}A._iControlWidth=parseInt(u/A._imagesPerColumn-A._calcImageMargin)-2*A._borderWidth;A._iControlHeight=parseInt(t/A._imagesPerRow-A._calcImageMargin)-2*A._borderWidth;if(A._iControlWidth<0||A._iControlHeight<0){if(A._iControlWidth<A._iControlHeight){A._iControlWidth=0;A._calcImageMargin=parseInt((A._userImageViewerWidth-(A._bVerticalMode?y:0)-2*A._borderWidth*A._imagesPerColumn)/(A._imagesPerColumn+1));t=A._userImageViewerHeight-(A._bVerticalMode?0:y)-A._calcImageMargin;A._iControlHeight=parseInt(t/A._imagesPerRow-A._calcImageMargin)-2*A._borderWidth}else{A._iControlHeight=0;A._calcImageMargin=parseInt((A._userImageViewerHeight-(A._bVerticalMode?0:y)-2*A._borderWidth*A._imagesPerRow)/(A._imagesPerRow+1));u=A._userImageViewerWidth-(A._bVerticalMode?y:0)-A._calcImageMargin;A._iControlWidth=parseInt(u/A._imagesPerColumn-A._calcImageMargin)-2*A._borderWidth}}}else{A._calcImageMargin=0;A._iControlWidth=A._userImageViewerWidth-2*A._borderWidth;A._iControlHeight=A._userImageViewerHeight-2*A._borderWidth}A._iControlWidth=(A._iControlWidth<0)?0:A._iControlWidth;A._iControlHeight=(A._iControlHeight<0)?0:A._iControlHeight};f.prototype._getImgCtrlWithCurIndex=function(){return this._aryImageControls[this._imageViewer.image._index]};f.prototype._calImgCtrlActualCentralPoint=function(){var y=this,w=y._getImgCtrlWithCurIndex();if(!(w instanceof l.ImageControl)){return}if(!(w.bSingleMode&&!w.bIfFitWindow&&w.bIfCurrentIndex)){return}var u={x:0,y:0},t=(w.curImageWidth>y._userImageViewerWidth)?y._getScrollBarWidth():0,x=(w.curImageHeight>y._userImageViewerHeight)?y._getScrollBarWidth():0;u.x=y._imageContainerWrapper.scrollLeft+(y._userImageViewerWidth-t)/2;u.y=y._imageContainerWrapper.scrollTop+(y._userImageViewerHeight-x)/2;w.actaulCentralPoint.x=u.x/w.curImageWidth*w.origImageWidth;w.actaulCentralPoint.y=u.y/w.curImageHeight*w.origImageHeight;if(w.curImageWidth<=y._userImageViewerWidth){w.actaulCentralPoint.x=w.origImageWidth/2}if(w.curImageHeight<=y._userImageViewerHeight){w.actaulCentralPoint.y=w.origImageHeight/2}if(w.actaulCentralPoint.x<0||w.actaulCentralPoint.x>w.origImageWidth){w.actaulCentralPoint.x=0}if(w.actaulCentralPoint.y<0||w.actaulCentralPoint.y>w.origImageHeight){w.actaulCentralPoint.y=0}};f.prototype._showImgCtrlAfterZoom=function(){var A=this,x=A._getImgCtrlWithCurIndex();if(!(x instanceof l.ImageControl)){return}if(!(x.bSingleMode&&!x.bIfFitWindow&&x.bIfCurrentIndex)||x.actaulCentralPoint.x==-1||x.actaulCentralPoint.y==-1){return}var u={},y,w,t=(x.curImageWidth>A._userImageViewerWidth)?A._getScrollBarWidth():0,z=(x.curImageHeight>A._userImageViewerHeight)?A._getScrollBarWidth():0;u.x=x.actaulCentralPoint.x/x.origImageWidth*x.curImageWidth;u.y=x.actaulCentralPoint.y/x.origImageHeight*x.curImageHeight;y=u.x-(A._userImageViewerWidth-t)/2;w=u.y-(A._userImageViewerHeight-z)/2;A._setScrollBarPosition(w,y);if(x.curImageWidth<=A._userImageViewerWidth){x.actaulCentralPoint.x=x.origImageWidth/2}if(x.curImageHeight<=A._userImageViewerHeight){x.actaulCentralPoint.y=x.origImageHeight/2}};f.prototype._showNonFitToWinImgCtrl=function(t,w){var u=this;o.removeEventListener(u._imageContainerWrapper,"scroll",u._onImgContainerWrapperScroll);if(t){u._calImgCtrlActualCentralPoint()}u._showImgCtrlAfterZoom();if(o.isFunction(w)){w()}u._imageContainerWrapper.style.overflow="hidden";setTimeout(function(){u._imageContainerWrapper.style.overflow="auto";setTimeout(function(){o.addEventListener(u._imageContainerWrapper,"scroll",u._onImgContainerWrapperScroll)},100)},50)};f.prototype._refresh=function(){var z=this;z._calcControlsSize();var B=(z._imagesPerColumn*6>z._iControlWidth/3)?z._iControlWidth/3:z._imagesPerColumn*6;if(z._bSingleMode){z._imageContainerBox.style.padding="0px";z._imageContainerBox.style.width="";z._imageContainerBox.style.height="";z._imageContainerBox.style.whiteSpace="";z._imageContainerWrapper.style.overflowX=!z._fitToWindowType?"hidden":"auto";z._imageContainerWrapper.style.overflowY=!z._fitToWindowType?"hidden":"auto"}else{z._imageContainerWrapper.style.overflow="hidden";z._imageContainerBox.style.padding=z._calcImageMargin/2+"px";if(z._bVerticalMode){z._imageContainerBox.style.width=z._userImageViewerWidth+B-z._calcImageMargin+"px";z._imageContainerBox.style.height="";z._imageContainerBox.style.whiteSpace="";z._imageContainerWrapper.scrollLeft=0}else{z._imageContainerBox.style.width="";z._imageContainerBox.style.height=z._userImageViewerHeight-z._calcImageMargin+"px";z._imageContainerBox.style.whiteSpace="nowrap";z._setScrollBarPosition(0)}}var u=Math.min(z._iControlWidth,z._iControlHeight),C;z._calcSelectedImageBorderWidth=(u<=2*z._selectedImageBorderWidth)?u/2:z._selectedImageBorderWidth;z._calcSelectedImageBorderWidth=(z._calcSelectedImageBorderWidth<1)?1:z._calcSelectedImageBorderWidth;C=z._calcSelectedImageBorderWidth-z._borderWidth;for(var y=0;y<z._aryImageControls.length;y++){var A=z._aryImageControls[y],t;A.iImageControlMargin=z._calcImageMargin;A.bIfCurrentIndex=A.imageIndex==z._imageViewer.image._getIndex();A.bSingleMode=z._bSingleMode;A.bIfFitWindow=!z._fitToWindowType;A.selectionBorderWidth=z._calcSelectedImageBorderWidth;A.selectionBorderColor=z._selectedBorderColor;A.zoom=z._zoom;if(!A.bIfCurrentIndex||!z._bSingleMode||!z._fitToWindowType){A.actaulCentralPoint.x=-1;A.actaulCentralPoint.y=-1}t=z._imageViewer.image._selectedIndices.indexOf(A.imageIndex)!=-1;A.refresh(z._iControlWidth-(t?C*2:0),z._iControlHeight-(t?C*2:0));A.setSelect(t);if(!z._bSingleMode){z._imageContainerWrapper.style.overflowX="hidden";z._imageContainerWrapper.style.overflowY="hidden";if(z._bVerticalMode){var x=parseInt((y+z._imagesPerColumn)/z._imagesPerColumn)>z._imagesPerRow;if(x){z._imageContainerWrapper.style.overflowY="auto";z._imageContainerBox.style.width=z._userImageViewerWidth+B-z._calcImageMargin-z._getScrollBarWidth()+"px"}}else{var w=parseInt((y+z._imagesPerRow)/z._imagesPerRow)>z._imagesPerColumn;if(w){z._imageContainerWrapper.style.overflowX="auto";z._imageContainerBox.style.height=z._userImageViewerHeight-z._calcImageMargin-z._getScrollBarWidth()+"px"}}}}};f.prototype._destory=function(t){var x=this;for(var w=0;w<x._aryImageControls.length;w++){x._aryImageControls[w].destroy()}x._removeImgContainerWrapperEvents();var u=a.indexOf(x);if(u!=-1){a.splice(u,1)}o.empty(x._userImageContainer);if(!t){x._bDestoryed=true}else{x._bRemoved=true}};function k(u,y,x,w,t){this.index=u;this.left=y;this.top=x;this.right=w;this.bottom=t}f.prototype.ImageSelectedAreaInfo=k;l.ImageSelectedAreaInfo=k;l.UI=f})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.dcsEnv,dynamsoft.lib.detect);(function(h,f,d){var g={NEARESTNEIGHBOUR:1,BILINEAR:2,BICUBIC:3};function e(k,j){var l=this;l._dwsObject=k;l._imageViewer=j;l._capacity=1023;l._count=0;l._index=-1;l._selectedIndices=[];l._bEdit=false;l.EnumInterpolationMethod=g;l._bDestoryed=false;l._bRemoved=false}e.prototype.editDocument=function(p,m){var l=this;if(l._bDestoryed){return false}if(l._dwsObject._bDestoryed){return false}if(!l._dwsObject._validateParamNum(arguments,2)||!l._dwsObject._validateStringType("documentEditorContainerId",p)||!l._dwsObject._validateNumberType("index",m)){return false}if(m<0||m>l._getCount()-1){l._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return false}if(!l._dwsObject._validateDivDom(p,"document")){return false}var j=l._dwsObject.getDocumentEditor(p);if(!j||!l._dwsObject._validateDocEditorExist(p,j.ui._bRemoved)){return false}if(l._imageViewer.io._validateImgIsHandlingAsyncOperation()){return false}var k={session:d.sessionId,object:l._dwsObject._dwsObjectId,method:"EditDocument",parameter:[j._docEditorId,l._imageViewer._imgViewerId,m,l._bEdit]},n=function(s){j.documentCtrl.attachDocument()},q=function(s){};var r=h.detect.postSyncCommand(l._dwsObject,h.stringify(k),n,q);if(r){l._bEdit=false;j.imageViewer=l._imageViewer;return true}else{if(l._dwsObject.getErrorCode()==-3001){var o;if(h.isFunction(j.document.ondiscardmodified)){o=j.document.ondiscardmodified()}else{o=j.document.ondiscardmodified}if(o==true){l._dwsObject._setErrCodeErrString(h.errorInfo.getOperationCancelledCode(),h.errorInfo.getOperationCancelledString());return false}else{l._bEdit=true;l.editDocument(p,m);return true}}else{return false}}};e.prototype.getCapacity=function(){var j=this;if(j._bDestoryed){return null}if(!j._dwsObject._validateDivDom(j._imageViewer.ui._getImgViewerId(),!0)){return null}if(!j._dwsObject._validateImgViewerExist(j._imageViewer.ui._getImgViewerId(),j._bRemoved)){return null}if(!j._dwsObject._validateParamNum(arguments,0)){return null}return j._capacity};e.prototype._getCapacity=function(){return this._capacity};e.prototype.setCapacity=function(m){var n=this;if(n._bDestoryed){return false}if(!n._dwsObject._validateDivDom(n._imageViewer.ui._getImgViewerId(),!0)){return false}if(!n._dwsObject._validateImgViewerExist(n._imageViewer.ui._getImgViewerId(),n._bRemoved)){return false}if(!n._dwsObject._validateParamNum(arguments,1)||!n._dwsObject._validateNumberType("iValue",m)){return false}var k=((0|1<<31)>>>0)-1;m=Math.round(m);if(!n._dwsObject._validateValue("iValue",m,[1,k],true)){return false}var l={session:d.sessionId,object:n._dwsObject._dwsObjectId,method:"SetCapacity",parameter:[n._imageViewer._imgViewerId,m]};var j=h.detect.postSyncCommand(n._dwsObject,h.stringify(l),null,null);if(j){n._innerSetCapacity(m)}return j};e.prototype.getCount=function(){var j=this;if(j._bDestoryed){return null}if(!j._dwsObject._validateDivDom(j._imageViewer.ui._getImgViewerId(),!0)){return null}if(!j._dwsObject._validateImgViewerExist(j._imageViewer.ui._getImgViewerId(),j._bRemoved)){return null}if(!j._dwsObject._validateParamNum(arguments,0)){return null}return j._count};e.prototype._getCount=function(){return this._count};e.prototype.getIndex=function(){var j=this;if(j._bDestoryed){return null}if(!j._dwsObject._validateDivDom(j._imageViewer.ui._getImgViewerId(),!0)){return null}if(!j._dwsObject._validateImgViewerExist(j._imageViewer.ui._getImgViewerId(),j._bRemoved)){return null}if(!j._dwsObject._validateParamNum(arguments,0)){return null}return j._index};e.prototype._getIndex=function(){return this._index};e.prototype.setIndex=function(k){var l=this;if(l._bDestoryed){return false}if(!l._dwsObject._validateDivDom(l._imageViewer.ui._getImgViewerId(),!0)){return false}if(!l._dwsObject._validateImgViewerExist(l._imageViewer.ui._getImgViewerId(),l._bRemoved)){return false}if(!l._dwsObject._validateParamNum(arguments,1)||!l._dwsObject._validateNumberType("iValue",k)){return false}k=Math.round(k);if(!l._count){return l._dwsObject._validateValue("iValue",k,[-1],false)}else{if(k<0||k>=l._count){l._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("iValue"));return false}var j=l._imageViewer.ui;if(j.imgSelector){j.imgSelector.hide();j.imgSelector.clearRect();j.imgSelector=null;if(l._onimageareadeselected&&typeof l._onimageareadeselected=="function"){setTimeout(function(){that._onimageareadeselected(index)},0)}}l._innerSetIndexInfo(l._index,l._selectedIndices,k,[k],true,true);l._dwsObject._setErrCodeErrString(h.errorInfo.getOkCode(),h.errorInfo.getOkString());return true}};e.prototype.getSelectedIndices=function(){var j=this;if(j._bDestoryed){return null}if(!j._dwsObject._validateDivDom(j._imageViewer.ui._getImgViewerId(),!0)){return null}if(!j._dwsObject._validateImgViewerExist(j._imageViewer.ui._getImgViewerId(),j._bRemoved)){return null}if(!j._dwsObject._validateParamNum(arguments,0)){return null}return j._selectedIndices};e.prototype._getSelectedIndices=function(){return this._selectedIndices};e.prototype.setSelectedIndices=function(n){var p=this;if(p._bDestoryed){return false}if(!p._dwsObject._validateDivDom(p._imageViewer.ui._getImgViewerId(),!0)){return false}if(!p._dwsObject._validateImgViewerExist(p._imageViewer.ui._getImgViewerId(),p._bRemoved)){return false}if(!p._dwsObject._validateParamNum(arguments,1)||!p._dwsObject._validateArrayType("iValue",n)){return false}if((p._count==0&&n.length>0)||(p._count>0&&n.length==0)){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("iValue"));return false}for(var m=0;m<n.length;m++){if(!h.isNumber(n[m])){p._dwsObject._setErrCodeErrString(h.errorInfo.getTypeNotValidCode(),h.errorInfo.getTypeNotValidString("iValue"));return false}n[m]=Math.round(n[m]);if(n[m]<0||n[m]>p._count-1){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("iValue"));return false}}var o=n[n.length-1];var k=[];for(var l=0;l<n.length;l++){if(k.indexOf(n[l])===-1){k.push(n[l])}}p._innerSetIndexInfo(p._index,p._selectedIndices,o,k,true,true);return true};e.prototype.getImageInfo=function(j){var l=this,k=null;if(l._bDestoryed){return false}if(!l._dwsObject._validateDivDom(l._imageViewer.ui._getImgViewerId(),!0)){return k}if(!l._dwsObject._validateImgViewerExist(l._imageViewer.ui._getImgViewerId(),l._bRemoved)){return k}if(!l._dwsObject._validateParamNum(arguments,1)||!l._dwsObject._validateNumberType("index",j)){return k}j=Math.round(j);if(j<0||j>l._count-1){l._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return k}k=l._getImageInfo(j);return k};e.prototype._getImageInfo=function(j){var n=this,m=null,k={session:d.sessionId,object:n._dwsObject._dwsObjectId,method:"GetImageInfo",parameter:[n._imageViewer._imgViewerId,j]},l=function(o){if(h.isArray(o.result)&&o.result.length>=2){m=new f.ImageInfo(n,o.result[0],o.result[1])}else{m=new f.ImageInfo(n,-1,-1)}};h.detect.postSyncCommand(n._dwsObject,h.stringify(k),l,null);return m};e.prototype.getImagePartUrl=function(j){var l=this,k=null;if(l._bDestoryed){return false}if(!l._dwsObject._validateDivDom(l._imageViewer.ui._getImgViewerId(),!0)){return k}if(!l._dwsObject._validateImgViewerExist(l._imageViewer.ui._getImgViewerId(),l._bRemoved)){return k}if(!l._dwsObject._validateParamNum(arguments,1)||!l._dwsObject._validateNumberType("index",j)){return k}j=Math.round(j);if(j<0||j>l._count-1){l._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return k}k=["dcs://dcs_",dynamsoft.dcsEnv.bTrial?"trial_":"",dynamsoft.dcsEnv._getFrontendSdkVersionWithoutComma(),"/img?session=",d.sessionId,"&object=",l._dwsObject._dwsObjectId,"&imageviewer=",l._imageViewer._imgViewerId,"&index=",j,"&ts=",h.now()].join("");return k};e.prototype.remove=function(x){var q=this,y=!1,p;if(q._bDestoryed){return y}if(!q._dwsObject._validateDivDom(q._imageViewer.ui._getImgViewerId(),!0)){return y}if(!q._dwsObject._validateImgViewerExist(q._imageViewer.ui._getImgViewerId(),q._bRemoved)){return y}if(q._imageViewer.io._validateImgIsHandlingAsyncOperation()){return y}if(!q._dwsObject._validateParamNum(arguments,1)||!q._dwsObject._validateArrayType("indices",x)){return y}if(x.length===0){return !0}for(p=0;p<x.length;p++){if(!h.isNumber(x[p])){q._dwsObject._setErrCodeErrString(h.errorInfo.getTypeNotValidCode(),h.errorInfo.getTypeNotValidString("indices"));return y}x[p]=Math.round(x[p]);if(x[p]<0||x[p]>q._count-1){q._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("indices"));return y}}x.sort(function(z,j){return z-j});for(var n=0;n<x.length;n++){if(x[n+1]===x[n]){q._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("indices"));return y}}var o={session:d.sessionId,object:q._dwsObject._dwsObjectId,method:"ImageRemove",parameter:[q._imageViewer._imgViewerId,x]};y=h.detect.postSyncCommand(q._dwsObject,h.stringify(o),null,null);if(y){var k=q._index,l=q._selectedIndices.slice().sort(function(z,j){return z-j}),t,m,w,r,u=q._imageViewer.ui,s;for(t=x.length-1;t>=0;t--){w=x[t];s=u._aryImageControls[w];s.destroy();u._aryImageControls.splice(w,1);for(m=l.length-1;m>=0;m--){r=l[m];if(r>w){l[m]-=1}else{if(r===w){l.splice(m,1)}else{break}}}q._count-=1;if(k===w){if(k>q._count-1){k-=1}}else{if(k>w){k-=1}}}if(k<0){k=-1;l=[]}else{for(p=0;p<u._aryImageControls.length;p++){s=u._aryImageControls[p];s.imageIndex=p;s.bIfCurrentIndex=p===k}if(l.length===0){l=[k]}}q._innerSetIndexInfo(q._index,q._selectedIndices,k,l,true,false,true)}return y};var b=["rotateLeft","rotateRight","flip","mirror"];h.each(b,function(j){e.prototype[j]=function(){var p=this,k=!1;if(p._bDestoryed){return k}if(!p._dwsObject._validateDivDom(p._imageViewer.ui._getImgViewerId(),!0)){return k}if(!p._dwsObject._validateImgViewerExist(p._imageViewer.ui._getImgViewerId(),p._bRemoved)){return k}if(p._imageViewer.io._validateImgIsHandlingAsyncOperation()){return k}var m=arguments[0];if(!p._dwsObject._validateParamNum(arguments,1)||!p._dwsObject._validateNumberType("index",m)){return k}m=Math.round(m);if(m<0||m>p._count-1){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return k}var n={session:d.sessionId,object:p._dwsObject._dwsObjectId,method:h.upperCaseFirst(j),parameter:[p._imageViewer._imgViewerId,m]};k=h.detect.postSyncCommand(p._dwsObject,h.stringify(n),null,null);if(k){var o=p._imageViewer.ui._aryImageControls[m];o.imgSelector.calcActualImgRectAfterRotate(j==="rotateLeft"?h._enumImgEditType.RotateLeft:j==="rotateRight"?h._enumImgEditType.RotateRight:j==="flip"?h._enumImgEditType.Flip:j==="mirror"?h._enumImgEditType.Mirror:h._enumImgEditType.None);var l=p._getRefreshedImgUrl(m);o.attachImage(l)}return k}});h.each(["crop","cut"],function(j){e.prototype[j]=function(){var o=this,x=!1;if(o._bDestoryed){return x}if(!o._dwsObject._validateDivDom(o._imageViewer.ui._getImgViewerId(),!0)){return x}if(!o._dwsObject._validateImgViewerExist(o._imageViewer.ui._getImgViewerId(),o._bRemoved)){return x}if(o._imageViewer.io._validateImgIsHandlingAsyncOperation()){return x}var p=arguments[0],m=arguments[1],t=arguments[2],u=arguments[3],k=arguments[4];if(!o._dwsObject._validateParamNum(arguments,5)||!o._dwsObject._validateNumberType("index",p)||!o._dwsObject._validateNumberType("left",m)||!o._dwsObject._validateNumberType("top",t)||!o._dwsObject._validateNumberType("right",u)||!o._dwsObject._validateNumberType("bottom",k)){return x}p=Math.round(p);if(p<0||p>o._count-1){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return x}if(u<=0){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueOutOfRangeCode(),h.errorInfo.getValueOutOfRangeString("right"));return x}if(k<=0){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueOutOfRangeCode(),h.errorInfo.getValueOutOfRangeString("bottom"));return x}var w=o._getImageInfo(p);if(o._dwsObject.getErrorCode()!==h.errorInfo.getOkCode()){return x}var s=w?w._width:0,r=w?w._height:0;m=Math.round(m);t=Math.round(t);u=Math.round(u);k=Math.round(k);m=m<0?0:m;t=t<0?0:t;u=u>s?s:u;k=k>r?r:k;if(u<=m){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("right"));return x}if(k<=t){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("bottom"));return x}var n={session:d.sessionId,object:o._dwsObject._dwsObjectId,method:h.upperCaseFirst(j),parameter:[o._imageViewer._imgViewerId,p,m,t,u,k]};x=h.detect.postSyncCommand(o._dwsObject,h.stringify(n),null,null);if(x){var q=o._imageViewer.ui._aryImageControls[p];q.imgSelector["calcActualImgRectAfter"+dynamsoft.lib.upperCaseFirst(j)](m,t,u,k);var l=o._getRefreshedImgUrl(p);q.attachImage(l)}return x}});e.prototype.changeSize=function(p,k,r,m){var o=this,s=!1;if(o._bDestoryed){return s}if(!o._dwsObject._validateDivDom(o._imageViewer.ui._getImgViewerId(),!0)){return s}if(!o._dwsObject._validateImgViewerExist(o._imageViewer.ui._getImgViewerId(),o._bRemoved)){return s}if(o._imageViewer.io._validateImgIsHandlingAsyncOperation()){return s}if(!o._dwsObject._validateParamNum(arguments,4)||!o._dwsObject._validateNumberType("index",p)||!o._dwsObject._validateNumberType("width",k)||!o._dwsObject._validateNumberType("height",r)||!o._dwsObject._validateNumberType("interpolationMethod",m)){return s}p=Math.round(p);if(p<0||p>o._count-1){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return s}k=Math.round(k);r=Math.round(r);var l=((0|1<<31)>>>0)-1;if(k<=0||k>l){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueOutOfRangeCode(),h.errorInfo.getValueOutOfRangeString("width"));return s}if(r<=0||r>l){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueOutOfRangeCode(),h.errorInfo.getValueOutOfRangeString("height"));return s}if(m!==g.NEARESTNEIGHBOUR&&m!==g.BILINEAR&&m!==g.BICUBIC){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("interpolationMethod"));return s}var n={session:d.sessionId,object:o._dwsObject._dwsObjectId,method:"ChangeSize",parameter:[o._imageViewer._imgViewerId,p,k,r,m]};s=h.detect.postSyncCommand(o._dwsObject,h.stringify(n),null,null);if(s){var q=o._imageViewer.ui._aryImageControls[p],j=o._getRefreshedImgUrl(p);q.adjustCentralPointAfterImgSizeChanged(k,r);q.imgSelector.calcActualImgRectAfterChangeSize(k,r);q.attachImage(j)}return s};e.prototype.swap=function(l,k){var p=this,s=!1;if(p._bDestoryed){return s}if(!p._dwsObject._validateDivDom(p._imageViewer.ui._getImgViewerId(),!0)){return s}if(!p._dwsObject._validateImgViewerExist(p._imageViewer.ui._getImgViewerId(),p._bRemoved)){return s}if(p._imageViewer.io._validateImgIsHandlingAsyncOperation()){return s}if(!p._dwsObject._validateParamNum(arguments,2)||!p._dwsObject._validateNumberType("firstIndex",l)||!p._dwsObject._validateNumberType("secondIndex",k)){return s}l=Math.round(l);k=Math.round(k);if(l<0||l>p._count-1){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("firstIndex"));return s}if(k<0||k>p._count-1){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("secondIndex"));return s}if(l===k){return !0}var m={session:d.sessionId,object:p._dwsObject._dwsObjectId,method:"Swap",parameter:[p._imageViewer._imgViewerId,l,k]};s=h.detect.postSyncCommand(p._dwsObject,h.stringify(m),null,null);if(s){var r=p._imageViewer.ui._aryImageControls[l],n=p._getRefreshedImgUrl(l),j=p._imageViewer.ui._aryImageControls[k],q=p._getRefreshedImgUrl(k),o;if(p._imageViewer.ui.imgSelector===r.imgSelector){p._imageViewer.ui.imgSelector=j.imgSelector}else{if(p._imageViewer.ui.imgSelector===j.imgSelector){p._imageViewer.ui.imgSelector=r.imgSelector}}o=r.imgSelector.actualImgRect;r.imgSelector.actualImgRect=j.imgSelector.actualImgRect;j.imgSelector.actualImgRect=o;r.imgSelector.initElem(r.outerDiv);j.imgSelector.initElem(j.outerDiv);r.attachImage(n);j.attachImage(q)}return s};e.prototype.copyToImageViewer=function(l,m){var p=this,j=!1;if(p._bDestoryed){return j}if(!p._dwsObject._validateDivDom(p._imageViewer.ui._getImgViewerId(),!0)){return j}if(!p._dwsObject._validateImgViewerExist(p._imageViewer.ui._getImgViewerId(),p._bRemoved)){return j}if(p._imageViewer.io._validateImgIsHandlingAsyncOperation()){return j}if(!p._dwsObject._validateParamNum(arguments,2)||!p._dwsObject._validateNumberType("index",l)){return j}l=Math.round(l);if(l<0||l>p._count-1){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return j}if(m===null){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("targetImageViewer"));return j}if(!(m instanceof f.ImageViewer)){p._dwsObject._setErrCodeErrString(h.errorInfo.getTypeNotValidCode(),h.errorInfo.getTypeNotValidString("targetImageViewer"));return j}var k=null;for(var n in dynamsoft.dcsEnv._imageViewerDic){if(dynamsoft.dcsEnv._imageViewerDic[n].imageViewer!==m){continue}k=dynamsoft.dcsEnv._imageViewerDic[n]}if(!k){p._dwsObject._setErrCodeErrString(h.errorInfo.getObjectNotExistCode(),h.errorInfo.getObjectNotExistString("targetImageViewer"));return false}if(k.dwsObject!==p._dwsObject){p._dwsObject._setErrCodeErrString(h.errorInfo.getAccessDeniedCode(),h.errorInfo.getAccessDeniedString("targetImageViewer"));return false}if(!p._dwsObject._validateDivDom(m.ui._getImgViewerId(),!0)){return j}if(!p._dwsObject._validateImgViewerExist(m.ui._getImgViewerId(),m.ui._bRemoved)){return j}if(m.io._validateImgIsHandlingAsyncOperation()){return j}var o={session:d.sessionId,object:p._dwsObject._dwsObjectId,method:"CopyToImageViewer",parameter:[p._imageViewer._imgViewerId,l,m._imgViewerId]};j=h.detect.postSyncCommand(p._dwsObject,h.stringify(o),null,null);if(j){m.ui._addImageControl()}return j};e.prototype._getRefreshedImgUrl=function(j){var k=this;return[d.preUrl,d.portInfo.curPort,"/",dynamsoft.dcsEnv._getVersionStrForCommand(),"/img?session=",d.sessionId,"&object=",k._dwsObject._dwsObjectId,"&imageviewer=",k._imageViewer._imgViewerId,"&index=",j].join("")};e.prototype._innerSetIndexInfo=function(j,n,p,o,m,l,k){this._index=p;this._selectedIndices=o;if(m){this._imageViewer.ui._refreshIndexInfo(j,n,p,o,l,k)}};e.prototype._innerIncCount=function(){return ++this._count};e.prototype._innerDecCount=function(){return --this._count};e.prototype._innerSetCapacity=function(l){var p=this,q=p._count;p._capacity=l;if(q>l){p._count=l;p._imageViewer.ui._refreshWhenCountReduced(q);var j=p._imageViewer.image._index,m=p._imageViewer.image._selectedIndices.slice().sort(function(t,s){return t-s}),k=p._imageViewer.image._index,r=p._imageViewer.image._selectedIndices.slice().sort(function(t,s){return t-s}),o=false;if(j>p._count-1){k=p._count-1}for(var n=m.length-1;n>=0;n--){if(r[n]>p._count-1){r.splice(n,1);o=true}}if(k!=-1&&r.length==0){r=[k];o=true}if(k!=j||o){p._innerSetIndexInfo(j,m,k,r,true,true)}p._imageViewer.ui._setImgCtrlVisible(p._count-1)}};e.prototype._updatedImage=function(k){var m=this;var l=m._imageViewer.ui._aryImageControls[k];var j=m._getRefreshedImgUrl(k);l.attachImage(j)};e.prototype._destory=function(j){if(!j){this._bDestoryed=true}else{this._bRemoved=true}};function a(l,k,j){this._imgNS=l;this._width=k;this._height=j}h.each(["getWidth","getHeight"],function(j){a.prototype[j]=function(){var n=this,l=n._imgNS,k=l._dwsObject,m=l._imageViewer;if(n._bDestoryed){return null}if(!k._validateDivDom(m.ui._getImgViewerId(),!0)){return null}if(!k._validateImgViewerExist(m.ui._getImgViewerId(),l._bRemoved)){return null}if(!k._validateParamNum(arguments,0)){return null}return(h.endsWith(j,"Width"))?n._width:n._height}});h._enumImgEditType={None:-1,RotateLeft:0,RotateRight:1,Flip:2,Mirror:3};e.prototype.ImageInfo=a;f.Image=e;f.ImageInfo=a})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.lib.detect);(function(g,e,d,f){var a=[];function b(k,j,h){var l=this;l.dwsObject=k;l.imageViewer=h;l.imageIndex=-1;l.imageUrl="";l.origImageWidth=0;l.origImageHeight=0;l.curImageWidth=0;l.curImageHeight=0;l.iImageViewerWidth=0;l.iImageViewerHeight=0;l.iImageControlWidth=0;l.iImageControlHeight=0;l.iImageControlMargin=0;l.outerDiv=false;l.hintDiv=false;l.bSelect=false;l.borderWidth=1;l.borderColor=4008636159;l.selectionBorderWidth=1;l.selectionBorderColor=2107821823;l.objImage=false;l.bIfCurrentIndex=false;l.imageIndex=-1;l.bIfFitWindow=true;l.bSingleMode=false;l.zoom=1;l.lastClick=false;l.mouseShape=null;l.imgSelector=new g.sdk.ImageSelector(l,l.imageViewer);l.bDrawing=false;l.dragPosition={x:0,y:0};l.bDragging=false;a.push(l);l.init(j);l.left=1;l.top=1;l.MAXLOACOUNT=6;l.curLoadCount=0;l.actaulCentralPoint={x:-1,y:-1};l._bIe9_10=f.navInfo.bIE&&(parseInt(f.navInfo.strBrowserVersion)===9||parseInt(f.navInfo.strBrowserVersion)===10);l.bDestroy=false}b.prototype.setHintString=function(h){if(!g.isString(h)){return}var j=this;if(j.hintDiv.innerText){j.hintDiv.innerText=h}else{if(j.hintDiv.textContent){j.hintDiv.textContent=h}else{j.hintDiv.appendChild(document.createTextNode(h))}}};b.prototype.init=function(h){var j=this;j.outerDiv=document.createElement("div");j.outerDiv.className="ds-dws-img-container ds-dws-display-inline-block";j.hintDiv=document.createElement("div");j.hintDiv.className="ds-dws-img-hint-container";j.setHintString("Loading ...");j.hintDiv.style.display="none";j.outerDiv.appendChild(j.hintDiv);j.setMouseShape(h);j.initObjImg();j.bindEvents()};b.prototype.initObjImg=function(){var h=this;h.objImage=new Image();h.objImage.className="ds-dws-img-obj";h.objImage.setAttribute("onmousedown","return false;");h.objImage.setAttribute("unselectable","on");h.objImage.setAttribute("draggable","false")};b.prototype.refresh=function(j,h){var k=this;k.outerDiv.className="ds-dws-img-container ds-dws-display-inline-block";k.outerDiv.style.left="";k.outerDiv.style.top="";k.outerDiv.style.position="relative";if(!k.bSingleMode||(k.bSingleMode&&k.bIfCurrentIndex&&k.bIfFitWindow)){k.iImageControlWidth=j;k.iImageControlHeight=h;k.outerDiv.style.width=j+"px";k.outerDiv.style.height=h+"px"}else{if(k.bSingleMode&&!k.bIfFitWindow&&k.bIfCurrentIndex){k.iImageControlWidth=j;k.iImageControlHeight=h}}k.outerDiv.style.margin=k.iImageControlMargin/2+"px";if(k.bSingleMode&&!k.bIfCurrentIndex){k.outerDiv.className="ds-dws-img-container ds-dws-display-none"}k.show()};b.prototype.show=function(){var m=this;m.positionHintDiv();if(m.iImageControlWidth<=0||m.iImageControlHeight<=0){if(m.objImage){m.objImage.style.width="0px"}if(m.objImage){m.objImage.style.height="0px"}return}if(m.objImage.src&&m.objImage.parentNode&&m.objImage.style.display==""){var j,h;if(!m.bSingleMode||(m.bSingleMode&&m.bIfFitWindow&&m.bIfCurrentIndex)){if(m.origImageWidth/m.iImageControlWidth>m.origImageHeight/m.iImageControlHeight){j=m.iImageControlWidth;h=m.origImageHeight*m.iImageControlWidth/m.origImageWidth}else{h=m.iImageControlHeight;j=m.origImageWidth*m.iImageControlHeight/m.origImageHeight}m.positionObjImg(j,h)}else{if(m.bSingleMode&&!m.bIfFitWindow&&m.bIfCurrentIndex){j=m.origImageWidth*m.zoom;h=m.origImageHeight*m.zoom;m.iImageControlWidth=(j>m.imageViewer.ui._userImageViewerWidth?j:m.imageViewer.ui._userImageViewerWidth)-2*m.borderWidth;m.iImageControlHeight=(h>m.imageViewer.ui._userImageViewerHeight?h:m.imageViewer.ui._userImageViewerHeight)-2*m.borderWidth;if(m.iImageControlWidth<0||m.iImageControlHeight<0){return}m.outerDiv.style.width=m.iImageControlWidth+"px";m.outerDiv.style.height=m.iImageControlHeight+"px";m.curImageWidth=j;m.curImageHeight=h;m.imageViewer.ui._showNonFitToWinImgCtrl(m.actaulCentralPoint.x==-1||m.actaulCentralPoint.y==-1,function(){m.positionObjImg(j,h)})}}if(m.imgSelector){var l=(m.iImageControlHeight-h)/2,k=(m.iImageControlWidth-j)/2;m.imgSelector.imgRect.top=l;m.imgSelector.imgRect.left=k;m.imgSelector.imgRect.bottom=l+h-1;m.imgSelector.imgRect.right=k+j-1;m.imgSelector.orgImgInfo.width=m.origImageWidth;m.imgSelector.orgImgInfo.height=m.origImageHeight;m.imgSelector.resizeSelector()}m.outerDiv.style.overflow="visible"}};b.prototype.positionObjImg=function(j,h){var k=this;k.objImage.style.position="absolute";k.objImage.style.top=Math.round((k.iImageControlHeight-h)/2)+"px";k.objImage.style.left=Math.round((k.iImageControlWidth-j)/2)+"px";k.objImage.style.width=parseInt(j)+"px";k.objImage.style.height=parseInt(h)+"px";k.curImageWidth=j;k.curImageHeight=h};b.prototype.attachImage=function(h){var j=this;if(j.imgSelector){j.imgSelector.hide()}j.objImage.style.display="none";j.hintDiv.style.display="block";j.setHintString("Loading ...");j.positionHintDiv();if(j.objImage){j.objImage.onload="";j.objImage.onerror="";j.objImage.src=""}if(j.objImage&&j.objImage.parentNode){j.objImage.setAttribute("onmousedown","");j.objImage.parentNode.removeChild(j.objImage)}j.initObjImg();j.objImage.onload=function(){j.origImageWidth=j.curImageWidth=j._bIe9_10&&this.naturalWidth?this.naturalWidth:this.width;j.origImageHeight=j.curImageHeight=j._bIe9_10&&this.naturalHeight?this.naturalHeight:this.height;if(!this.parentNode){j.outerDiv.appendChild(this)}this.style.display="";j.show();j.hintDiv.style.display="none";j.outerDiv.style.overflow="visible"};j.objImage.onerror=function(){++j.curLoadCount;if(j.curLoadCount>j.MAXLOACOUNT){j.setHintString("Error ocurrs");d.handleImageLoadingError(j.dwsObject,this.src);if(this.parentNode){this.parentNode.removeChild(this)}}else{this.src=[h,"&ts=",g.now()].join("")}};j.curLoadCount=1;j.imageUrl=[h,"&ts=",g.now()].join("");setTimeout(function(){j.objImage.src=[h,"&ts=",g.now()].join("")},0)};b.prototype.positionHintDiv=function(){var l=this,j=g.getElDimensions(l.outerDiv,false),q=j?j.clientWidth:l.outerDiv.clientWidth,k=j?j.clientHeight:l.outerDiv.clientHeight,m=g.getElDimensions(l.hintDiv,false),o=m?m.clientWidth:l.hintDiv.clientWidth,n=m?m.clientHeight:l.hintDiv.clientHeight;var p=(k-n)/2,h=(q-o)/2;if(p<0){p=0}if(h<0){h=0}l.hintDiv.style.top=parseInt(p)+"px";l.hintDiv.style.left=parseInt(h)+"px";l.outerDiv.style.overflow="hidden"};b.prototype.refreshBorder=function(){var h=this;if(h.bSelect){h.outerDiv.style.border=h.selectionBorderWidth+"px solid";h.outerDiv.style.borderColor=g.IntToColorStr(h.selectionBorderColor)}else{h.outerDiv.style.border=h.borderWidth+"px solid";h.outerDiv.style.borderColor=g.IntToColorStr(h.borderColor)}};b.prototype.setSelect=function(h){this.bSelect=h;this.refreshBorder()};b.prototype.setMouseShape=function(h){var j=this;if(j.mouseShape==h){return}j.mouseShape=h;j.outerDiv.style.cursor=j.mouseShape?"pointer":"crosshair"};b.prototype.fireEvent=function(h,j){if(g.isFunction(this[h])){return this[h](j)}return true};b.prototype.finishDrawing=function(h){var j=this;j.bDrawing=false;j.imgSelector.calcActualImgRect();j.imgSelector.clear();if(j.imgSelector.isValidSelector()){j.fireEvent("onImageAreaSelected",{e:h,index:j.imageIndex,imgSelector:j.imgSelector})}};b.prototype.finishDragging=function(){var h=this;h.bDragging=false;h.dragPosition.x=0;h.dragPosition.y=0;h.fireEvent("onImageDraggingFinished")};b.prototype.bindEvents=function(){var l=this;var j=function(q){q=q||window.event;if(g.detectButton(q)!=g.EnumMouseButton.LEFT){return}var p=new Date(),o,r=l.getMapMousePositionToImageCoordinate(q);if(l.lastClick){o=p.getTime()-l.lastClick.getTime()}l.lastClick=p;if(o<500){l.fireEvent("onMouseDoubleClick",{index:l.imageIndex,mouseX:r.x,mouseY:r.y});l.lastClick=false;g.log("MouseDoubleClick")}else{if(q.which?q.which==3:q.button==2){}else{l.fireEvent("onMouseClick",{e:q,index:l.imageIndex,mouseX:r.x,mouseY:r.y})}}};g.addEventListener(l.outerDiv,"click",j);if(!f.navInfo.bHTML5Edition){g.addEventListener(l.outerDiv,"dblclick",j)}var m=function(o){o=o||window.event;if(g.detectButton(o)!=g.EnumMouseButton.LEFT){return}l.left=l.outerDiv.clientLeft;l.top=l.outerDiv.clientTop;var p;if(!l.mouseShape){p=g.getOffset(o,l,l.outerDiv);l.fireEvent("onImageAreaDeSelected");l.imgSelector.clickedX=p.x;l.imgSelector.clickedY=p.y;l.imgSelector.orgImgInfo.width=l.origImageWidth;l.imgSelector.orgImgInfo.height=l.origImageHeight;l.imgSelector.imgRect.top=l.objImage.offsetTop;l.imgSelector.imgRect.left=l.objImage.offsetLeft;l.imgSelector.imgRect.bottom=l.objImage.offsetTop+l.objImage.offsetHeight-1;l.imgSelector.imgRect.right=l.objImage.offsetLeft+l.objImage.offsetWidth-1;l.bDrawing=true}if(l.mouseShape&&l.bSingleMode&&!l.bIfFitWindow){p=g.getOffset(o,l,l.imageViewer.ui._userImageContainer);l.dragPosition.x=p.x;l.dragPosition.y=p.y;l.bDragging=true}};g.addEventListener(l.outerDiv,"mousedown",m);var n=function(o){if(!l.imgSelector.elem){l.imgSelector.initElem(l.outerDiv)}l.imgSelector.curX=o.x;l.imgSelector.curY=o.y;l.imgSelector.show()};var h=function(q){var r=l.getMapMousePositionToImageCoordinate(q);l.fireEvent("onMouseMove",{index:l.imageIndex,mouseX:r.x,mouseY:r.y});if(!l.bDrawing&&!l.bDragging){return}q=q||window.event;var s;if(l.bDrawing){s=g.getOffset(q,l,l.outerDiv);n(s)}else{if(l.bDragging){s=g.getOffset(q,l,l.imageViewer.ui._userImageContainer);var p=s.x-l.dragPosition.x,o=s.y-l.dragPosition.y;l.fireEvent("onImageDragging",{deltaX:-p,deltaY:-o});l.dragPosition.x=s.x;l.dragPosition.y=s.y}}};g.addEventListener(l.outerDiv,"mousemove",h);var k=function(o){o=o||window.event;if(g.detectButton(o)==g.EnumMouseButton.RIGHT){var p=l.getMapMousePositionToImageCoordinate(o);l.fireEvent("onMouseRightClick",{index:l.imageIndex,mouseX:p.x,mouseY:p.y})}if(g.detectButton(o)!=g.EnumMouseButton.LEFT){return}if(!l.mouseShape&&l.bDrawing){var q=g.getOffset(o,l,l.outerDiv);n(q);l.finishDrawing(o);if(l.selectionBorderWidth==1&&!(f.navInfo.bSafari)&&!(f.navInfo.bFirefox)){l.imgSelector.bNeedResize=false}}if(l.mouseShape&&l.bDragging){l.finishDragging()}};g.addEventListener(l.outerDiv,"mouseup",k);b.prototype.removeEvents=function(){g.removeEventListener(this.outerDiv,"click",j);if(!f.navInfo.bHTML5Edition){g.removeEventListener(this.outerDiv,"dblclick",j)}g.removeEventListener(this.outerDiv,"mousedown",m);g.removeEventListener(this.outerDiv,"mousemove",h);g.removeEventListener(this.outerDiv,"mouseup",k);this.objImage.setAttribute("onmousedown","")}};b.prototype.getMapMousePositionToImageCoordinate=function(j){j=j||window.event;if(!j){return}var k=this,h=g.getOffset(j,k,k.outerDiv);return k.imgSelector.MapCurMousePosToImgCoordinate(h.x,h.y)};b.prototype.adjustCentralPointAfterImgSizeChanged=function(l,h){var m=this;if(m.actaulCentralPoint.x===-1||m.actaulCentralPoint.y===-1||!m.bIfCurrentIndex||m.bIfFitWindow||!m.bSingleMode){return}var k=l/m.origImageWidth,j=h/m.origImageHeight;m.actaulCentralPoint.x*=k;m.actaulCentralPoint.y*=j};b.prototype.destroy=function(){var j=this;j.removeEvents();j.imgSelector.destroy();if(j.hintDiv&&j.hintDiv.parentNode){j.hintDiv.parentNode.removeChild(j.hintDiv)}if(j.objImage&&j.objImage.parentNode){j.objImage.parentNode.removeChild(j.objImage)}var h=a.indexOf(j);if(h!=-1){a.splice(h,1)}if(j.outerDiv.parentNode){j.outerDiv.parentNode.removeChild(j.outerDiv)}j.bDestroy=true};b.prototype._invokeMouseUpOutside=function(h){h=h||window.event;var n=this;if(!n.mouseShape&&n.bDrawing){var m=g.getOffset(h,n,n.outerDiv);if(isNaN(m.x)||isNaN(m.y)){return}var l=g.getElDimensions(n.outerDiv,false),j=l?l.clientWidth:n.outerDiv.clientWidth,k=l?l.clientHeight:n.outerDiv.clientHeight;if(m.x>=0&&m.x<=j&&m.y>=0&&m.y<=k){return}n.finishDrawing(h)}if(n.mouseShape&&n.bDragging){n.finishDragging()}};g.addEventListener(document,"mouseup",function(h){h=h||window.event;for(var j=0;j<a.length;j++){a[j]._invokeMouseUpOutside(h)}});e.ImageControl=b})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.lib.detect,dynamsoft.dcsEnv);(function(b){function a(e,d){var f=this;f.imgCtrl=e;f.imageViewer=d;f.clickedX=0;f.clickedY=0;f.curX=0;f.curY=0;f.orgImgInfo={width:0,height:0};f.imgRect={left:0,top:0,right:0,bottom:0};f.actualImgRect={left:0,top:0,right:0,bottom:0,toString:function(){return"left: "+this.left+". top: "+this.top+". right: "+this.right+". bottom: "+this.bottom}};f.userRect={left:0,top:0,right:0,bottom:0,toString:function(){return"left: "+this.left+". top: "+this.top+". right: "+this.right+". bottom: "+this.bottom}};f.intersectionRect={left:0,top:0,right:0,bottom:0,toString:function(){return"left: "+this.left+". top: "+this.top+". right: "+this.right+". bottom: "+this.bottom}};f.elem=null;f.parentElem=null;f.bNeedResize=true;f.bDestroy=false}a.prototype.initElem=function(d){var e=this;e.removeElem();e.elem=document.createElement("div");e.elem.className="ds-dws-img-selector";e.elem.style.display="none";if(d){e.parentElem=d;d.appendChild(e.elem)}};a.prototype.clear=function(){var d=this;d.clickedX=0;d.clickedY=0;d.curX=0;d.curY=0};a.prototype.clearRect=function(){var d=function(f){f.top=0;f.left=0;f.right=0;f.bottom=0},e=this;d(e.userRect);d(e.intersectionRect);d(e.actualImgRect)};a.prototype.removeElem=function(){var d=this;if(d.elem&&d.parentElem){d.parentElem.removeChild(d.elem);d.elem=null}};a.prototype.isValidSelector=function(){var h=this,e=h.intersectionRect.right-h.intersectionRect.left,g=h.intersectionRect.bottom-h.intersectionRect.top,d=h.actualImgRect.right-h.actualImgRect.left,f=h.actualImgRect.bottom-h.actualImgRect.top;return e>0&&g>0&&d>0&&f>0};a.prototype.show=function(){var d=this;d.calcUserRect();d.calcIntersectionRect();b.log("UserRect: "+d.userRect.toString());b.log("IntersectionRect: "+d.intersectionRect.toString());if(!(d.elem&&(d.intersectionRect.right-d.intersectionRect.left>0)&&(d.intersectionRect.bottom-d.intersectionRect.top>0))){d.hide();return}d.positionSelector()};a.prototype.positionSelector=function(){var h=this;h.intersectionRect.top=h.intersectionRect.top<0?0:h.intersectionRect.top;h.intersectionRect.top=(h.intersectionRect.top>h.imgRect.top)?h.intersectionRect.top:h.imgRect.top;h.intersectionRect.left=h.intersectionRect.left<0?0:h.intersectionRect.left;h.intersectionRect.left=(h.intersectionRect.left>h.imgRect.left)?h.intersectionRect.left:h.imgRect.left;if(h.intersectionRect.right>h.imgRect.right){h.intersectionRect.right=h.imgRect.right}if(h.intersectionRect.bottom>h.imgRect.bottom){h.intersectionRect.bottom=h.imgRect.bottom}var g=h.intersectionRect.top,f=h.intersectionRect.left,e=h.intersectionRect.right-h.intersectionRect.left,d=h.intersectionRect.bottom-h.intersectionRect.top;if(!h.elem){return}if(e>0&&d>0){h.elem.style.top=g+"px";h.elem.style.left=f+"px";h.elem.style.width=e+"px";h.elem.style.height=d+"px";h.elem.style.display="block"}else{h.hide()}};a.prototype.hide=function(){if(!this.elem){return}this.elem.style.display="none"};a.prototype.calcUserRect=function(){var g=this,f=0;if(g.curX<g.clickedX){g.curX+=1}if(g.curY<g.clickedY){g.curY+=1}var e=Math.abs(g.curX-g.clickedX),d=Math.abs(g.curY-g.clickedY);g.userRect.top=(g.curY<g.clickedY)?g.curY:g.clickedY;g.userRect.left=(g.curX<g.clickedX)?g.curX:g.clickedX;g.userRect.right=g.userRect.left+e;g.userRect.bottom=g.userRect.top+d;f=g.imageViewer.ui.getSelectionRectAspectRatio();if(f!=0){var e=g.userRect.right-g.userRect.left,d;if(g.curY>g.clickedY){d=e/f;g.userRect.bottom=g.userRect.top+d}else{d=e/f;g.userRect.top=g.userRect.bottom-d}}};a.prototype.calcIntersectionRect=function(){var d=this;d.intersectionRect.left=Math.max(d.userRect.left,d.imgRect.left);d.intersectionRect.right=Math.min(d.userRect.right,d.imgRect.right);d.intersectionRect.top=Math.max(d.userRect.top,d.imgRect.top);d.intersectionRect.bottom=Math.min(d.userRect.bottom,d.imgRect.bottom)};a.prototype.calcActualImgRect=function(){var d=this;if(d.intersectionRect.right<=d.intersectionRect.left||d.intersectionRect.bottom<=this.intersectionRect.top){d.clearRect();return}d.actualImgRect.top=((d.intersectionRect.top-d.imgRect.top+1)/(d.imgRect.bottom-d.imgRect.top+1)*d.orgImgInfo.height);if(d.intersectionRect.top===d.imgRect.top){d.actualImgRect.top=0}d.actualImgRect.top=d.actualImgRect.top<0?0:d.actualImgRect.top;d.actualImgRect.left=((d.intersectionRect.left-d.imgRect.left+1)/(d.imgRect.right-d.imgRect.left+1)*d.orgImgInfo.width);if(d.intersectionRect.left===d.imgRect.left){d.actualImgRect.left=0}d.actualImgRect.left=d.actualImgRect.left<0?0:d.actualImgRect.left;d.actualImgRect.bottom=((d.intersectionRect.bottom-d.intersectionRect.top+1)/(d.imgRect.bottom-d.imgRect.top+1)*d.orgImgInfo.height+d.actualImgRect.top);d.actualImgRect.bottom=d.actualImgRect.bottom>d.orgImgInfo.height?d.orgImgInfo.height:d.actualImgRect.bottom;d.actualImgRect.right=((d.intersectionRect.right-d.intersectionRect.left+1)/(d.imgRect.right-d.imgRect.left+1)*d.orgImgInfo.width+d.actualImgRect.left);d.actualImgRect.right=d.actualImgRect.right>d.orgImgInfo.width?d.orgImgInfo.width:d.actualImgRect.right;d.actualImgRect.top=Math.round(d.actualImgRect.top);d.actualImgRect.left=Math.round(d.actualImgRect.left);d.actualImgRect.bottom=Math.round(d.actualImgRect.bottom);d.actualImgRect.right=Math.round(d.actualImgRect.right);if(d.actualImgRect.top==d.orgImgInfo.height){--d.actualImgRect.top}if(d.actualImgRect.left==d.orgImgInfo.width){--d.actualImgRect.left}if(d.actualImgRect.bottom==d.actualImgRect.top){++d.actualImgRect.bottom}if(d.actualImgRect.right==d.actualImgRect.left){++d.actualImgRect.right}};a.prototype.calcActualImgRectAfterRotate=function(l){var k=this,d=k.actualImgRect.right-k.actualImgRect.left,g=k.actualImgRect.bottom-k.actualImgRect.top;if(d<=0||g<=0){return}var h=0,e=0,j={x:0,y:0};if(l===b._enumImgEditType.RotateLeft||l===b._enumImgEditType.RotateRight){h=k.actualImgRect.bottom-k.actualImgRect.top;e=k.actualImgRect.right-k.actualImgRect.left}else{if(l===b._enumImgEditType.Flip||l===b._enumImgEditType.Mirror){h=k.actualImgRect.right-k.actualImgRect.left;e=k.actualImgRect.bottom-k.actualImgRect.top}}switch(l){case b._enumImgEditType.RotateLeft:j.x=k.actualImgRect.right;j.y=k.actualImgRect.top;k.actualImgRect.top=k.orgImgInfo.width-j.x;k.actualImgRect.left=j.y;break;case b._enumImgEditType.RotateRight:j.x=k.actualImgRect.left;j.y=k.actualImgRect.bottom;k.actualImgRect.top=j.x;k.actualImgRect.left=k.orgImgInfo.height-j.y;break;case b._enumImgEditType.Flip:j.y=k.actualImgRect.bottom;k.actualImgRect.top=k.orgImgInfo.height-j.y;break;case b._enumImgEditType.Mirror:j.x=k.actualImgRect.right;k.actualImgRect.left=k.orgImgInfo.width-j.x;break}k.actualImgRect.bottom=k.actualImgRect.top+e;k.actualImgRect.right=k.actualImgRect.left+h;if(l===b._enumImgEditType.RotateLeft||l===b._enumImgEditType.RotateRight){var f=k.orgImgInfo.width;k.orgImgInfo.width=k.orgImgInfo.height;k.orgImgInfo.height=f}};a.prototype.isRectIntersected=function(j,f,m,k,g,d,l,h){var e={};e.left=Math.max(j,g);e.right=Math.min(m,l);e.top=Math.max(f,d);e.bottom=Math.min(k,h);return(e.right-e.left>0)&&(e.bottom-e.top>0)};a.prototype.calcActualImgRectAfterCut=function(g,f,e,d){var h=this;if(h.isRectIntersected(g,f,e,d,h.actualImgRect.left,h.actualImgRect.top,h.actualImgRect.right,h.actualImgRect.bottom)){h.actualImgRect.left=0;h.actualImgRect.right=0;h.actualImgRect.top=0;h.actualImgRect.bottom=0}};a.prototype.calcActualImgRectAfterCrop=function(g,f,e,d){var h=this;if(g<=h.actualImgRect.left&&f<=h.actualImgRect.top&&e>=h.actualImgRect.right&&d>=h.actualImgRect.bottom){h.actualImgRect.left-=g;h.actualImgRect.right-=g;h.actualImgRect.top-=f;h.actualImgRect.bottom-=f}else{h.actualImgRect.left=0;h.actualImgRect.right=0;h.actualImgRect.top=0;h.actualImgRect.bottom=0}};a.prototype.calcActualImgRectAfterChangeSize=function(g,d){var h=this,f=g/h.orgImgInfo.width,e=d/h.orgImgInfo.height;h.actualImgRect.top*=e;h.actualImgRect.bottom*=e;h.actualImgRect.left*=f;h.actualImgRect.right*=f};a.prototype.resizeSelector=function(){var d=this;if(!d.bNeedResize){d.bNeedResize=true;return}if(d.actualImgRect.right<=d.actualImgRect.left||d.actualImgRect.bottom<=this.actualImgRect.top){d.clearRect();return}d.intersectionRect.left=parseInt(d.actualImgRect.left/d.orgImgInfo.width*(d.imgRect.right-d.imgRect.left)+d.imgRect.left);d.intersectionRect.top=parseInt(d.actualImgRect.top/d.orgImgInfo.height*(d.imgRect.bottom-d.imgRect.top)+d.imgRect.top);d.intersectionRect.right=parseInt((d.actualImgRect.right-d.actualImgRect.left)/d.orgImgInfo.width*(d.imgRect.right-d.imgRect.left)+d.intersectionRect.left);d.intersectionRect.bottom=parseInt((d.actualImgRect.bottom-d.actualImgRect.top)/d.orgImgInfo.height*(d.imgRect.bottom-d.imgRect.top)+d.intersectionRect.top);d.positionSelector()};a.prototype.MapCurMousePosToImgCoordinate=function(h,g){var k=this,f={top:-1,left:-1,bottom:-1,right:-1},e={top:k.imgRect.top,left:k.imgRect.left,right:h,bottom:g},j=e.right-e.left,d=e.bottom-e.top;if(j<0||d<0||j>k.imgRect.right-k.imgRect.left||d>k.imgRect.bottom-k.imgRect.top){return{x:f.right,y:f.bottom}}f.top=((e.top-k.imgRect.top+1)/(k.imgRect.bottom-k.imgRect.top+1)*k.orgImgInfo.height);f.top=f.top<0?0:f.top;f.left=((e.left-k.imgRect.left+1)/(k.imgRect.right-k.imgRect.left+1)*k.orgImgInfo.width);f.left=f.left<0?0:f.left;f.bottom=((e.bottom-e.top+1)/(k.imgRect.bottom-k.imgRect.top+1)*k.orgImgInfo.height+f.top);if(parseInt(d)===0){f.bottom=0}f.bottom=f.bottom>k.orgImgInfo.height?k.orgImgInfo.height:f.bottom;f.right=((e.right-e.left+1)/(k.imgRect.right-k.imgRect.left+1)*k.orgImgInfo.width+f.left);if(parseInt(j)===0){f.right=0}f.right=f.right>k.orgImgInfo.width?k.orgImgInfo.width:f.right;f.bottom=parseInt(f.bottom)>k.orgImgInfo.height?k.orgImgInfo.height:parseInt(f.bottom);f.right=parseInt(f.right)>k.orgImgInfo.width?k.orgImgInfo.width:parseInt(f.right);return{x:f.right,y:f.bottom}};a.prototype.destroy=function(){this.removeElem();this.bDestroy=true};b.sdk.ImageSelector=a})(dynamsoft.lib);(function(n,m,w,z){var s={POST:0,PUT:1},b={BMP:0,JPEG:1,TIFF:2,PNG:3,PDF:4},j={BINARY:0,BASE64:1},x={AUTO:0,RLE:2,FAX3:3,T4:3,FAX4:4,T6:4,LZW:5,JPEG:7,PACKBITS:32773},k="get",y="set",t="iValue",A=["HTTPFormFields","JPEGQuality","TIFFCompressionType","HTTPResponse"],p=[],d=0,l=100;function f(C,B){var D=this;D._dwsObject=C;D._imgViewer=B;D._bRemoved=false;D._bDestoryed=false;D.EnumHttpMethod=s;D.EnumImageType=b;D.EnumUploadDataFormat=j;D.EnumTIFFCompressionType=x;D.pdfinfo=new m.PdfInfo(D);D._JPEGQuality=80;D._TIFFCompressionType=x.AUTO;D._HTTPFormFields={};D._HTTPResponse=null;D._bPropertiesChanged=!0;D._asyncDownloadErrCodeErrStrings={};D._asyncDownloadDocumentErrCodeErrStrings={};D._asyncUploadErrCodeErrStrings={};D._asyncTaskId=0}f.prototype._getPropNumInObj=function(D){var C=0;if(!D||!n.isObject(D)){return C}for(var B in D){C++}return C};f.prototype._isHandlingAsyncDownloadOperation=function(){return this._getPropNumInObj(this._asyncDownloadErrCodeErrStrings)>0||this._getPropNumInObj(this._asyncDownloadDocumentErrCodeErrStrings)>0};f.prototype._isHandlingAsyncOperation=function(){return this._getPropNumInObj(this._asyncDownloadErrCodeErrStrings)>0||this._getPropNumInObj(this._asyncUploadErrCodeErrStrings)>0||this._getPropNumInObj(this._asyncDownloadDocumentErrCodeErrStrings)>0};f.prototype._validateImgIsHandlingAsyncOperation=function(D){var B=this._dwsObject;var C=null;if(this._getPropNumInObj(this._asyncDownloadErrCodeErrStrings)>0){C="httpDownloadAsync"}else{if(this._getPropNumInObj(this._asyncUploadErrCodeErrStrings)>0){C="httpUploadAsync"}else{if(this._getPropNumInObj(this._asyncDownloadDocumentErrCodeErrStrings)>0){C="httpDownloadDocumentAsync"}}}if(C){B._setErrCodeErrString(n.errorInfo.getAsyncTaskNotCompletedCode(),n.errorInfo.getAsyncTaskNotCompletedString(C))}else{B._setErrCodeErrString(n.errorInfo.getOkCode(),n.errorInfo.getOkString())}return !!C};n.each(A,function(B){p.push(k+B);p.push(y+B)});p.splice(p.indexOf(y+"HTTPResponse"),1);n.each(p,function(B){f.prototype[B]=function(){var H=this,C=H._dwsObject;if(H._bDestoryed){return false}if(!C._validateDivDom(H._imgViewer.ui._getImgViewerId(),!0)){return(B.indexOf(k)===0)?undefined:false}if(!C._validateImgViewerExist(H._imgViewer.ui._getImgViewerId(),H._bRemoved)){return(B.indexOf(k)===0)?undefined:false}if(B.indexOf(k)===0){if(!C._validateParamNum(arguments,0)){return null}}else{if(!C._validateParamNum(arguments,1)){return false}if(B.indexOf("JPEGQuality")!==-1){if(!C._validateNumberType(t,arguments[0])){return false}arguments[0]=Math.round(arguments[0]);if(!C._validateValue(t,arguments[0],[d,l],true)){return false}}else{if(B.indexOf("TIFFCompressionType")!==-1){if(!C._validateNumberType(t,arguments[0])||!H._isValidValueInEnum(x,arguments[0],t)){return false}}else{if(B.indexOf("HTTPFormFields")!==-1){if(!dynamsoft.lib.isObject(arguments[0])){C._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString(t));return false}var E="";try{E=n.stringify(arguments[0])}catch(G){E=false}if(!E){C._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString(t));return false}}}}}var D=-1,F="";for(D=0;D<A.length;D++){if(B.indexOf(A[D])!==-1){F=A[D];break}}C._setErrCodeErrString(n.errorInfo.getOkCode(),n.errorInfo.getOkString());if(B.indexOf(k)===0){return H["_"+F]}else{if(B.indexOf("HTTPFormFields")===-1&&H["_"+F]!==arguments[0]){H._bPropertiesChanged=!0}H["_"+F]=arguments[0];return true}}});f.prototype._isValidValueInEnum=function(D,F,E){if(!n.isNumber(F)){this._dwsObject._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString(E));return false}var C,B=!1,G=this;for(C in D){if(D[C]===F){B=!0;break}}if(B){G._dwsObject._setErrCodeErrString(n.errorInfo.getOkCode(),n.errorInfo.getOkString())}else{G._dwsObject._setErrCodeErrString(n.errorInfo.getValueNotValidCode(),n.errorInfo.getValueNotValidString(E))}return B};f.prototype._getValidatedIndices=function(E){var B=null,D=this._imgViewer.image;if(!n.isArray(E)){return B}if(E.length===0){return B}for(var C=0;C<E.length;C++){if(!n.isNumber(E[C])){return B}E[C]=Math.round(E[C]);if(E[C]<0||E[C]>D._getCount()-1){return B}}B=E;return B};f.prototype._sendPropertiesToBackend=function(){var E=this,C=E._dwsObject,D={session:z.sessionId,object:C._dwsObjectId,method:"SetImageIoProperties",parameter:[E._imgViewer._imgViewerId,E._JPEGQuality,E._TIFFCompressionType,E.pdfinfo._getJsonObj()]};var B=z.postSyncCommand(C,n.stringify(D),null,null);E._bPropertiesChanged=!1;return B};f.prototype.convertToBase64=function(I,C){var F=this,H=F._dwsObject,E=null;if(F._bDestoryed){return false}if(!H._validateDivDom(F._imgViewer.ui._getImgViewerId(),!0)){return E}if(!H._validateImgViewerExist(F._imgViewer.ui._getImgViewerId(),F._bRemoved)){return E}if(F._validateImgIsHandlingAsyncOperation()){return E}if(!H._validateParamNum(arguments,2)||!H._validateArrayType("indices",I)||!H._validateNumberType("imageType",C)){return E}I=F._getValidatedIndices(I);if(I===null){F._dwsObject._setErrCodeErrString(n.errorInfo.getValueNotValidCode(),n.errorInfo.getValueNotValidString("indices"));return E}if(!F._isValidValueInEnum(b,C,"imageType")){return E}if(I.length>1&&(C!==b.TIFF&&C!=b.PDF)){F._dwsObject._setErrCodeErrString(n.errorInfo.getMultipageNotSupportedCode(),n.errorInfo.getMultipageNotSupportedString());return E}if(F._bPropertiesChanged||C==b.PDF&&(F.pdfinfo._pdfCreationDate===null||F.pdfinfo._pdfModifiedDate===null)){var B=F._sendPropertiesToBackend();if(!B){return E}}var D={session:z.sessionId,object:H._dwsObjectId,method:"ConvertToBase64",parameter:[F._imgViewer._imgViewerId,I,C]},G=function(K){if(n.isArray(K.result)&&K.result.length===1){E=K.result[0]}else{E=""}},J=!1;J=z.postSyncCommand(H,n.stringify(D),G,null);if(J){H._setErrCodeErrString(n.errorInfo.getOkCode(),n.errorInfo.getOkString())}return E};f.prototype.copyToClipboard=function(H,D,K,M,B){var G=this,L=G._dwsObject,C=G._imgViewer.image,F=G._imgViewer.ui,O=!1;if(G._bDestoryed){return O}if(!L._validateDivDom(F._getImgViewerId(),!0)){return O}if(!L._validateImgViewerExist(F._getImgViewerId(),G._bRemoved)){return O}if(G._validateImgIsHandlingAsyncOperation()){return O}if(arguments.length<1||arguments.length>1&&arguments.length<5){L._setErrCodeErrString(n.errorInfo.getParameterNumberUnmatchedCode(),n.errorInfo.getParameterNumberUnmatchedString(!0));return O}if(arguments.length>5){L._setErrCodeErrString(n.errorInfo.getParameterNumberUnmatchedCode(),n.errorInfo.getParameterNumberUnmatchedString(!1));return O}if(!L._validateNumberType("index",H)){return O}H=Math.round(H);if(H<0||H>C._getCount()-1){L._setErrCodeErrString(n.errorInfo.getValueNotValidCode(),n.errorInfo.getValueNotValidString("index"));return O}var N=C._getImageInfo(H);if(G._dwsObject.getErrorCode()!==n.errorInfo.getOkCode()){return O}var J=N?N._width:0,I=N?N._height:0;D=(D===undefined)?0:D;K=(K===undefined)?0:K;M=(M===undefined)?J:M;B=(B===undefined)?I:B;if(!L._validateNumberType("left",D)||!L._validateNumberType("top",K)||!L._validateNumberType("right",M)||!L._validateNumberType("bottom",B)){return O}D=Math.round(D);K=Math.round(K);M=Math.round(M);B=Math.round(B);if(M<=0){L._setErrCodeErrString(n.errorInfo.getValueOutOfRangeCode(),n.errorInfo.getValueOutOfRangeString("right"));return O}if(B<=0){L._setErrCodeErrString(n.errorInfo.getValueOutOfRangeCode(),n.errorInfo.getValueOutOfRangeString("bottom"));return O}if(D<0){D=0}if(K<0){K=0}if(M>J){M=J}if(B>I){B=I}if(M<=D){L._setErrCodeErrString(n.errorInfo.getValueNotValidCode(),n.errorInfo.getValueNotValidString("right"));return O}if(B<=K){L._setErrCodeErrString(n.errorInfo.getValueNotValidCode(),n.errorInfo.getValueNotValidString("bottom"));return O}var E={session:z.sessionId,object:L._dwsObjectId,method:"CopyToClipboard",parameter:[G._imgViewer._imgViewerId,H,D,K,M,B]};O=z.postSyncCommand(L,n.stringify(E),null,null);if(O){L._setErrCodeErrString(n.errorInfo.getOkCode(),n.errorInfo.getOkString())}return O};f.prototype.loadFromClipboard=function(){var G=this,D=G._dwsObject,E=G._imgViewer.ui,C=!1;if(G._bDestoryed){C}if(!D._validateDivDom(E._getImgViewerId(),!0)){return C}if(!D._validateImgViewerExist(E._getImgViewerId(),G._bRemoved)){return C}if(G._validateImgIsHandlingAsyncOperation()){return C}if(!D._validateParamNum(arguments,0)){return C}var F={session:z.sessionId,object:D._dwsObjectId,method:"LoadFromClipboard",parameter:[w._getProductKey(),G._imgViewer._imgViewerId]},B=function(){var H=D.getErrorCode(),I=D.getErrorString();E._addImageControl();D._setErrCodeErrString(H,I)};C=z.postSyncCommand(D,n.stringify(F),B,null);if(D.getErrorCode()===n.errorInfo.getDataFormatInvalidCode()){D._setErrCodeErrString(n.errorInfo.getDataFormatInvalidCode(),n.errorInfo.getDataFormatInvalidString(!1))}return C};var h="httpDownload",r="httpDownloadAsync";n.each([h,r],function(B){f.prototype[B]=function(){var F=this,M=F._dwsObject,G=F._imgViewer.ui,N=!1,E=n.errorInfo.getOkCode(),L=n.errorInfo.getOkString(),O=function(R,Q){E=R===undefined?M.getErrorCode():R;L=Q===undefined?M.getErrorString():Q};if(F._bDestoryed){return !1}M._setErrCodeErrString(n.errorInfo.getOkCode(),n.errorInfo.getOkString());if(M.getErrorCode()===n.errorInfo.getOkCode()&&!M._validateDivDom(G._getImgViewerId(),!0)){if(B===h){return N}else{O()}}if(M.getErrorCode()===n.errorInfo.getOkCode()&&!M._validateImgViewerExist(G._getImgViewerId(),F._bRemoved)){if(B===h){return N}else{O()}}if(B===h){if(M.getErrorCode()===n.errorInfo.getOkCode()&&!M._validateParamNum(arguments,1)){return N}}else{if(M.getErrorCode()===n.errorInfo.getOkCode()&&arguments.length<3){E=n.errorInfo.getParameterNumberUnmatchedCode();L=n.errorInfo.getParameterNumberUnmatchedString(!0);M._setErrCodeErrString(E,L)}if(M.getErrorCode()===n.errorInfo.getOkCode()&&arguments.length>4){E=n.errorInfo.getParameterNumberUnmatchedCode();L=n.errorInfo.getParameterNumberUnmatchedString(!1);M._setErrCodeErrString(E,L)}}var C=arguments[0],J=arguments[1],P=arguments[2],I=arguments[3]===undefined?null:arguments[3];if(M.getErrorCode()===n.errorInfo.getOkCode()&&!M._validateStringType("url",C)){if(B===h){return N}else{O()}}if(B===r){if(M.getErrorCode()===n.errorInfo.getOkCode()&&J!==null&&!n.isFunction(J)){M._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("onHttpDownloadSuccess"));O()}if(M.getErrorCode()===n.errorInfo.getOkCode()&&P!==null&&!n.isFunction(P)){M._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("onHttpDownloadFailure"))}if(M.getErrorCode()===n.errorInfo.getOkCode()&&I!==null&&!n.isFunction(I)){M._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("onHttpDownloading"));O()}}if(B===r&&M.getErrorCode()!==n.errorInfo.getOkCode()){if(n.isFunction(P)){setTimeout(function(){P(E,L,"")},0)}return null}if(C.trim().length===0){C="invalidUrl"}if(!n.startsWith(C,"http://")&&!n.startsWith(C,"https://")){C=(w.navInfo.bSSL?"https://":"http://")+C}var H=n.now();if(B===r){F._asyncDownloadErrCodeErrStrings[H]={ec:n.errorInfo.getOkCode(),es:n.errorInfo.getOkString()}}var D=function(S,U,R){var V=[z.preUrl,z.portInfo.curPort,"/",w._getVersionStrForCommand(),"/appendImageFromBytes?","session=",z.sessionId,"&object=",M._dwsObjectId,"&imageviewer=",F._imgViewer._imgViewerId,"&productkey=",w._getProductKey(),"&mode=","image","&ts=",n.now()].join(""),T=function(ae,ac,ag){if(B===h){N=M.getErrorCode()===n.errorInfo.getOkCode()}else{if(F._asyncDownloadErrCodeErrStrings[H]){M._setErrCodeErrString(F._asyncDownloadErrCodeErrStrings[H].ec,F._asyncDownloadErrCodeErrStrings[H].es)}if(M.getErrorCode()===n.errorInfo.getOkCode()){if(n.isFunction(J)){setTimeout(function(){J()},0)}}else{O();if(n.isFunction(P)){setTimeout(function(){P(E,L,"")},0)}}}if(B===r){delete F._asyncDownloadErrCodeErrStrings[H]}var ad=M.getErrorCode(),X=M.getErrorString();var Z=0,W,aa=F._imgViewer.image._getIndex(),ab=F._imgViewer.image._getSelectedIndices().slice();if(ae&&n.isArray(ae.result)&&n.isNumber(ae.result[2])){Z=ae.result[2]}for(W=0;W<Z;W++){G._addImageControl()}var Y=F._imgViewer.image._getIndex(),af=[];if(Z>0&&Y>aa){for(W=0;W<Z;W++){af.push(Y-W)}af.sort(function(ai,ah){return ai-ah});setTimeout(function(){F._imgViewer.image._innerSetIndexInfo(aa,ab,Y,af,!F._imgViewer.ui._bSingleMode,true)},200)}M._setErrCodeErrString(ad,X)},Q=function(Y,X,W){if((B===r&&F._asyncDownloadErrCodeErrStrings[H]&&F._asyncDownloadErrCodeErrStrings[H].ec===n.errorInfo.getDataFormatInvalidCode())||(B!==r&&M.getErrorCode()===n.errorInfo.getDataFormatInvalidCode())){M._setErrCodeErrString(n.errorInfo.getDataFormatInvalidCode(),n.errorInfo.getDataFormatInvalidString(!0))}if(B===h){N=!1}else{if(F._asyncDownloadErrCodeErrStrings[H]&&F._asyncDownloadErrCodeErrStrings[H].ec!==n.errorInfo.getDataFormatInvalidCode()){M._setErrCodeErrString(F._asyncDownloadErrCodeErrStrings[H].ec,F._asyncDownloadErrCodeErrStrings[H].es)}O();if(n.isFunction(P)){setTimeout(function(){P(E,L,"")},0)}}if(B===r){delete F._asyncDownloadErrCodeErrStrings[H]}};F._HTTPResponse="";if(B===r){F._asyncDownloadErrCodeErrStrings[H]={ec:n.errorInfo.getOkCode(),es:n.errorInfo.getOkString()}}F._sendImgDataToService(V,S,B===r,T,Q,H)},K=function(T,U,R){F._HTTPResponse=T?T:"";if(w.navInfo.bIE&&parseInt(w.navInfo.strBrowserVersion)<10){F._HTTPResponse=R.nativeXhr.responseText}var Q=0;try{Q=R.nativeXhr.status}catch(S){Q=0}if(!U||U.indexOf(n.ajax._strOpenErr)!==-1||U.indexOf(n.ajax._strSendErr)!==-1||w.navInfo.bIE&&U.toLowerCase().indexOf("unknown")!==-1){M._setErrCodeErrString(n.errorInfo.getValueNotValidCode(),n.errorInfo.getValueNotValidString("url"))}else{M._setErrCodeErrString(n.errorInfo.getHttpErrorCode(),n.errorInfo.getHttpErrorString(Q))}if(B===h){N=!1}else{O();if(n.isFunction(P)){setTimeout(function(){P(E,L,F._HTTPResponse)},0)}}if(B===r){delete F._asyncDownloadErrCodeErrStrings[H]}};F._download(C,B===r,D,K,I);if(B===h){return N}}});var u="httpDownloadDocument",a="httpDownloadDocumentAsync";n.each([u,a],function(B){f.prototype[B]=function(){var F=this,M=F._dwsObject,G=F._imgViewer.ui,N=!1,E=n.errorInfo.getOkCode(),L=n.errorInfo.getOkString(),O=function(R,Q){E=R===undefined?M.getErrorCode():R;L=Q===undefined?M.getErrorString():Q};if(F._bDestoryed){return !1}M._setErrCodeErrString(n.errorInfo.getOkCode(),n.errorInfo.getOkString());if(M.getErrorCode()===n.errorInfo.getOkCode()&&!M._validateDivDom(G._getImgViewerId(),!0)){if(B===u){return N}else{O()}}if(M.getErrorCode()===n.errorInfo.getOkCode()&&!M._validateImgViewerExist(G._getImgViewerId(),F._bRemoved)){if(B===u){return N}else{O()}}if(B===u){if(M.getErrorCode()===n.errorInfo.getOkCode()&&!M._validateParamNum(arguments,1)){return N}}else{if(M.getErrorCode()===n.errorInfo.getOkCode()&&arguments.length<3){E=n.errorInfo.getParameterNumberUnmatchedCode();L=n.errorInfo.getParameterNumberUnmatchedString(!0);M._setErrCodeErrString(E,L)}if(M.getErrorCode()===n.errorInfo.getOkCode()&&arguments.length>4){E=n.errorInfo.getParameterNumberUnmatchedCode();L=n.errorInfo.getParameterNumberUnmatchedString(!1);M._setErrCodeErrString(E,L)}}var C=arguments[0],J=arguments[1],P=arguments[2],I=arguments[3]===undefined?null:arguments[3];if(M.getErrorCode()===n.errorInfo.getOkCode()&&!M._validateStringType("url",C)){if(B===u){return N}else{O()}}if(B===a){if(M.getErrorCode()===n.errorInfo.getOkCode()&&J!==null&&!n.isFunction(J)){M._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("onHttpDownloadSuccess"));O()}if(M.getErrorCode()===n.errorInfo.getOkCode()&&P!==null&&!n.isFunction(P)){M._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("onHttpDownloadFailure"))}if(M.getErrorCode()===n.errorInfo.getOkCode()&&I!==null&&!n.isFunction(I)){M._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("onHttpDownloading"));O()}}if(B===a&&M.getErrorCode()!==n.errorInfo.getOkCode()){if(n.isFunction(P)){setTimeout(function(){P(E,L,"")},0)}return null}if(C.trim().length===0){C="invalidUrl"}if(!n.startsWith(C,"http://")&&!n.startsWith(C,"https://")){C=(w.navInfo.bSSL?"https://":"http://")+C}var H=n.now();if(B===a){F._asyncDownloadDocumentErrCodeErrStrings[H]={ec:n.errorInfo.getOkCode(),es:n.errorInfo.getOkString()}}var D=function(S,U,R){var V=[z.preUrl,z.portInfo.curPort,"/",w._getVersionStrForCommand(),"/appendImageFromBytes?","session=",z.sessionId,"&object=",M._dwsObjectId,"&imageviewer=",F._imgViewer._imgViewerId,"&productkey=",w._getProductKey(),"&mode=","document","&ts=",n.now()].join(""),T=function(ae,ac,ag){if(B===u){N=M.getErrorCode()===n.errorInfo.getOkCode()}else{if(F._asyncDownloadDocumentErrCodeErrStrings[H]){M._setErrCodeErrString(F._asyncDownloadDocumentErrCodeErrStrings[H].ec,F._asyncDownloadDocumentErrCodeErrStrings[H].es)}if(M.getErrorCode()===n.errorInfo.getOkCode()){if(n.isFunction(J)){setTimeout(function(){J()},0)}}else{O();if(n.isFunction(P)){setTimeout(function(){P(E,L,"")},0)}}}if(B===a){delete F._asyncDownloadDocumentErrCodeErrStrings[H]}var ad=M.getErrorCode(),X=M.getErrorString();var Z=0,W,aa=F._imgViewer.image._getIndex(),ab=F._imgViewer.image._getSelectedIndices().slice();if(ae&&n.isArray(ae.result)&&n.isNumber(ae.result[2])){Z=ae.result[2]}for(W=0;W<Z;W++){G._addImageControl()}var Y=F._imgViewer.image._getIndex(),af=[];if(Z>0&&Y>aa){for(W=0;W<Z;W++){af.push(Y-W)}af.sort(function(ai,ah){return ai-ah});setTimeout(function(){F._imgViewer.image._innerSetIndexInfo(aa,ab,Y,af,!F._imgViewer.ui._bSingleMode,true)},200)}M._setErrCodeErrString(ad,X)},Q=function(Y,X,W){if((B===a&&F._asyncDownloadDocumentErrCodeErrStrings[H]&&F._asyncDownloadDocumentErrCodeErrStrings[H].ec===n.errorInfo.getDataFormatInvalidCode())||(B!==a&&M.getErrorCode()===n.errorInfo.getDataFormatInvalidCode())){M._setErrCodeErrString(n.errorInfo.getDataFormatInvalidCode(),n.errorInfo.getDataFormatInvalidString(!0))}if(B===u){N=!1}else{if(F._asyncDownloadDocumentErrCodeErrStrings[H]&&F._asyncDownloadDocumentErrCodeErrStrings[H].ec!==n.errorInfo.getDataFormatInvalidCode()){M._setErrCodeErrString(F._asyncDownloadDocumentErrCodeErrStrings[H].ec,F._asyncDownloadDocumentErrCodeErrStrings[H].es)}O();if(n.isFunction(P)){setTimeout(function(){P(E,L,"")},0)}}if(B===a){delete F._asyncDownloadDocumentErrCodeErrStrings[H]}};F._HTTPResponse="";if(B===a){F._asyncDownloadDocumentErrCodeErrStrings[H]={ec:n.errorInfo.getOkCode(),es:n.errorInfo.getOkString()}}F._sendImgDataToService(V,S,B===a,T,Q,H,"document")},K=function(T,U,R){F._HTTPResponse=T?T:"";if(w.navInfo.bIE&&parseInt(w.navInfo.strBrowserVersion)<10){F._HTTPResponse=R.nativeXhr.responseText}var Q=0;try{Q=R.nativeXhr.status}catch(S){Q=0}if(!U||U.indexOf(n.ajax._strOpenErr)!==-1||U.indexOf(n.ajax._strSendErr)!==-1||w.navInfo.bIE&&U.toLowerCase().indexOf("unknown")!==-1){M._setErrCodeErrString(n.errorInfo.getValueNotValidCode(),n.errorInfo.getValueNotValidString("url"))}else{M._setErrCodeErrString(n.errorInfo.getHttpErrorCode(),n.errorInfo.getHttpErrorString(Q))}if(B===u){N=!1}else{O();if(n.isFunction(P)){setTimeout(function(){P(E,L,F._HTTPResponse)},0)}}if(B===a){delete F._asyncDownloadDocumentErrCodeErrStrings[H]}};F._download(C,B===a,D,K,I);if(B===u){return N}}});f.prototype._download=function(C,E,I,D,F){var B=-1,H=E&&n.isFunction(F)?function(L,N){var M=(L.total===0)?100:Math.round(L.loaded*100/L.total),K;if(B!==M){K=F(M)}B=M;if(K===true){N.abort()}}:false,J=E&&n.isFunction(F)?function(K,L){if(!K||w.navInfo.bIE&&parseInt(w.navInfo.strBrowserVersion)<=9){return null}n.addEventListener(K,"progress",function(M){delete (M.totalSize);delete (M.position);H(M,K)})}:!1,G={beforeSend:J,method:"GET",url:C,dataType:"blob",onSuccess:I,onError:D,async:E};if(E){if(w.navInfo.bIE&&parseInt(w.navInfo.strBrowserVersion)<10){G.contentType="text/plain; charset=x-user-defined";G.mimeType="text/plain; charset=x-user-defined";G.headers={"Accept-Charset":"x-user-defined"}}else{G.xhrFields={responseType:w.navInfo.bSafari?"arraybuffer":"blob"};G.onError=function(O,Q,L){if(w.navInfo.bSafari){var P;try{P=String.fromCharCode.apply(null,new Uint8Array(O))}catch(M){P=""}D(P,Q,L)}else{var K=new window.FileReader();try{K.readAsText(O)}catch(N){D("",Q,L)}K.onloadend=function(){var R=K.result;D(R,Q,L)}}}}}else{if(w.navInfo.bIE&&w.navInfo.bHTML5Edition&&window.Uint8Array){G.xhrFields={responseType:"arraybuffer"};G.onSuccess=function(M,N,L){var K=null;if(M){K=new Uint8Array(M)}I(K,N,L)};G.onError=function(M,O,K){var N;try{N=String.fromCharCode.apply(null,new Uint8Array(M))}catch(L){N=""}D(N,O,K)}}else{G.contentType="text/plain; charset=x-user-defined";G.mimeType="text/plain; charset=x-user-defined";if(w.navInfo.bIE&&parseInt(w.navInfo.strBrowserVersion)<10){G.headers={"Accept-Charset":"x-user-defined"}}G.onSuccess=function(O,Q,M){var P,L,K;if(w.navInfo.bIE){K=M.nativeXhr.responseBody}else{P=M.nativeXhr.responseText;L=P.length;K=new Uint8Array(L);for(var N=0;N<L;N++){K[N]=P.charCodeAt(N)}}I(w.navInfo.bSafari?K.buffer:K,Q,M)}}}n.ajax(G)};f.prototype._sendImgDataToService=function(B,E,C,L,F,J,D){var K=function(O){if(O){return O.charAt(0).toUpperCase()+O.substring(1)}else{return""}};var H=this,M=H._dwsObject,I=function(R,Q,P){if(z.isValidResponseValue(R)){if(n.errorInfo.isUnknownCode(R.exception)){R.description=n.errorInfo.getUnknownString(R.exception,R.description);R.exception=EnumDCS_ErrorCode.Unknown}if(R.exception===EnumDCS_ErrorCode.ConnectionToServiceReset&&n.isString(R.description)){R.description=R.description.replace("Webcam","Camera")}if(R.exception===0){if(n.isFunction(L)){L(R,Q,P)}}else{if(R.exception===n.errorInfo.getLicenseVerificationFailedCode()&&R.result){if(!C){M._setErrCodeErrString(R.exception,R.result[1])}if(C){var O=H["_asyncDownload"+K(D)+"ErrCodeErrStrings"][J];if(O){O.ec=R.exception;O.es=R.result[1]}}if(!z.isFullVersion&&R.result[0]!==1&&n.isFunction(L)){L(R)}}else{if(!C){M._setErrCodeErrString(R.exception,R.description)}if(C){var O=H["_asyncDownload"+K(D)+"ErrCodeErrStrings"][J];if(O){O.ec=R.exception;O.es=R.result[1]}}}if(!(R.exception===n.errorInfo.getLicenseVerificationFailedCode()&&!z.isFullVersion&&R.result&&R.result[0]!==1)&&n.isFunction(F)){F(R,Q,P)}}}},N=function(R,Q,P){if(M instanceof n.sdk.DcsObject){if(w.navInfo.bIE&&(parseInt(w.navInfo.strBrowserVersion)<=9)&&n.isString(Q)&&(Q.toLowerCase().indexOf("denied")!==-1||Q.toLowerCase().indexOf(z.IE_PERMISSION_DENIED_Err_Code)!==-1||Q.toLowerCase().indexOf(z.IE_Unknown_Err_Code)!==-1)){if(!C){M._setErrCodeErrString(n.errorInfo.getOperationNotSupportedCode(),n.errorInfo.getOperationNotSupportedString())}else{if(C){var O=H["_asyncDownload"+K(D)+"ErrCodeErrStrings"][J];if(O){O.ec=R.exception;O.es=R.result[1]}}}}else{if(!C){z.throwServiceNotConnectException(M)}else{if(C){var O=H["_asyncDownload"+K(D)+"ErrCodeErrStrings"][J];if(O){O.ec=R.exception;O.es=R.result[1]}}}}}if(n.isFunction(F)){F(R,Q,P)}};B=B||[z.preUrl,z.portInfo.curPort,"/",w._getVersionStrForCommand(),"/ts=",n.now()].join("");C=(C===undefined)?!0:C;var G={method:"POST",url:B,data:E,dataType:"json",onSuccess:I,onError:N,async:C};if(w.navInfo.bIE&&parseInt(w.navInfo.strBrowserVersion)<10){G.mimeType="text/plain; charset=x-user-defined";G.headers={"Accept-Charset":"x-user-defined"}}n.ajax(G)};var o="httpUpload",g="httpUploadAsync";n.each([o,g],function(B){f.prototype[B]=function(){var T=this,O=T._dwsObject,J=T._imgViewer.ui,K=!1,U=n.errorInfo.getOkCode(),P=n.errorInfo.getOkString(),I=function(Z,Y){U=Z===undefined?O.getErrorCode():Z;P=Y===undefined?O.getErrorString():Y};if(T._bDestoryed){return !1}O._setErrCodeErrString(n.errorInfo.getOkCode(),n.errorInfo.getOkString());if(O.getErrorCode()===n.errorInfo.getOkCode()&&!O._validateDivDom(J._getImgViewerId(),!0)){if(B===o){return K}else{I()}}if(O.getErrorCode()===n.errorInfo.getOkCode()&&!O._validateImgViewerExist(J._getImgViewerId(),T._bRemoved)){if(B===o){return K}else{I()}}if(T._validateImgIsHandlingAsyncOperation()){return !1}if(B===o){if(O.getErrorCode()===n.errorInfo.getOkCode()&&arguments.length<3){O._setErrCodeErrString(n.errorInfo.getParameterNumberUnmatchedCode(),n.errorInfo.getParameterNumberUnmatchedString(!0));return K}if(O.getErrorCode()===n.errorInfo.getOkCode()&&arguments.length>5){O._setErrCodeErrString(n.errorInfo.getParameterNumberUnmatchedCode(),n.errorInfo.getParameterNumberUnmatchedString(!1));return K}}else{if(O.getErrorCode()===n.errorInfo.getOkCode()&&arguments.length<5){U=n.errorInfo.getParameterNumberUnmatchedCode();P=n.errorInfo.getParameterNumberUnmatchedString(!0);O._setErrCodeErrString(U,P)}if(O.getErrorCode()===n.errorInfo.getOkCode()&&arguments.length>8){U=n.errorInfo.getParameterNumberUnmatchedCode();P=n.errorInfo.getParameterNumberUnmatchedString(!1);O._setErrCodeErrString(U,P)}}var G=arguments[0],H=arguments[1],C=arguments[2],Q,X,S,V,L;if(B===o){Q=arguments[3]===undefined?s.POST:arguments[3];X=arguments[4]===undefined?j.BINARY:arguments[4]}else{S=arguments[3];V=arguments[4];L=arguments[5]===undefined?null:arguments[5];Q=arguments[6]===undefined?s.POST:arguments[6];X=arguments[7]===undefined?(!!window.Blob?j.BINARY:j.BASE64):arguments[7]}if(O.getErrorCode()===n.errorInfo.getOkCode()&&!O._validateStringType("url",G)){if(B===o){return K}else{I()}}if(O.getErrorCode()===n.errorInfo.getOkCode()&&!O._validateArrayType("indices",H)){if(B===o){return K}else{I()}}H=T._getValidatedIndices(H);if(O.getErrorCode()===n.errorInfo.getOkCode()&&H===null){O._setErrCodeErrString(n.errorInfo.getValueNotValidCode(),n.errorInfo.getValueNotValidString("indices"));if(B===o){return K}else{I()}}if(O.getErrorCode()===n.errorInfo.getOkCode()&&H.length>1&&(C!==b.TIFF&&C!=b.PDF)){O._setErrCodeErrString(n.errorInfo.getMultipageNotSupportedCode(),n.errorInfo.getMultipageNotSupportedString());if(B===o){return K}else{I()}}if(O.getErrorCode()===n.errorInfo.getOkCode()&&!T._isValidValueInEnum(b,C,"imageType")){if(B===o){return K}else{I()}}if(O.getErrorCode()===n.errorInfo.getOkCode()&&!T._isValidValueInEnum(s,Q,"httpMethod")){if(B===o){return K}else{I()}}if(O.getErrorCode()===n.errorInfo.getOkCode()&&!T._isValidValueInEnum(j,X,"dataFormat")){if(B===o){return K}else{I()}}if(!window.Blob&&X===j.BINARY){X=j.BASE64}var N=parseFloat(w.navInfo.strBrowserVersion);if(w.navInfo.bSafari&&!isNaN(N)&&N<6&&X===j.BINARY){X=j.BASE64}if(B===g){if(O.getErrorCode()===n.errorInfo.getOkCode()&&S!==null&&!n.isFunction(S)){O._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("onHttpUploadSuccess"));I()}if(O.getErrorCode()===n.errorInfo.getOkCode()&&V!==null&&!n.isFunction(V)){O._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("onHttpUploadFailure"))}if(O.getErrorCode()===n.errorInfo.getOkCode()&&L!==null&&!n.isFunction(L)){O._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("onHttpUploading"));I()}}if(O.getErrorCode()===n.errorInfo.getOkCode()&&(T._bPropertiesChanged||C==b.PDF&&(T.pdfinfo._pdfCreationDate===null||T.pdfinfo._pdfModifiedDate===null))){var E=T._sendPropertiesToBackend();if(!E){if(B===o){return K}else{I()}}}if(B===g&&O.getErrorCode()!==n.errorInfo.getOkCode()){if(n.isFunction(V)){setTimeout(function(){V(U,P,"")},0)}return null}var M=n.now();if(B===g){T._asyncUploadErrCodeErrStrings[M]={ec:n.errorInfo.getOkCode(),es:n.errorInfo.getOkString()}}var W,R={session:z.sessionId,object:O._dwsObjectId,method:"GetImageData",parameter:[T._imgViewer._imgViewerId,H,C,X]},F=function(aa){W=aa;if(G.trim().length===0){G="invalidUrl"}if(!n.startsWith(G,"http://")&&!n.startsWith(G,"https://")){G=(w.navInfo.bSSL?"https://":"http://")+G}var Y=T._composeUploadData(W,C,X===j.BASE64),ab=function(ac){T._HTTPResponse=ac?ac.toString():"";if(B===o){K=!0}else{if(T._asyncUploadErrCodeErrStrings[M]){O._setErrCodeErrString(T._asyncUploadErrCodeErrStrings[M].ec,T._asyncUploadErrCodeErrStrings[M].es)}if(n.isFunction(S)){setTimeout(function(){S(T._HTTPResponse)},0)}}if(B===g){delete T._asyncUploadErrCodeErrStrings[M]}},Z=function(af,ag,ad){T._HTTPResponse=af?af.toString():"";var ac=0;try{ac=ad.nativeXhr.status}catch(ae){ac=0}if(!ag||ag.indexOf(n.ajax._strOpenErr)!==-1||ag.indexOf(n.ajax._strSendErr)!==-1||w.navInfo.bIE&&ag.toLowerCase().indexOf("unknown")!==-1){O._setErrCodeErrString(n.errorInfo.getValueNotValidCode(),n.errorInfo.getValueNotValidString("url"))}else{O._setErrCodeErrString(n.errorInfo.getHttpErrorCode(),n.errorInfo.getHttpErrorString(ac))}if(B===o){K=!1}else{I();if(n.isFunction(V)){setTimeout(function(){V(U,P,T._HTTPResponse)},0)}}if(B===g){delete T._asyncUploadErrCodeErrStrings[M]}};if(B===g){T._asyncUploadErrCodeErrStrings[M]={ec:n.errorInfo.getOkCode(),es:n.errorInfo.getOkString()}}T._upload(G,Q===s.POST?"POST":"PUT",B===g,Y,ab,Z,L,X)},D=function(aa,Z,Y){T._HTTPResponse="";if(B===o){K=!1}else{if(T._asyncUploadErrCodeErrStrings[M]){O._setErrCodeErrString(T._asyncUploadErrCodeErrStrings[M].ec,T._asyncUploadErrCodeErrStrings[M].es)}I();if(n.isFunction(V)){setTimeout(function(){V(U,P,"")},0)}}if(B===g){delete T._asyncUploadErrCodeErrStrings[M]}};T._getImgDataFromService(X,n.stringify(R),B===g,F,D,M);if(B===o){return K}}});var q="";f.prototype._composeUploadData=function(C,F,J){var E,I,G;switch(F){case b.BMP:I=".bmp";break;case b.JPEG:I=".jpg";break;case b.PDF:I=".pdf";break;case b.PNG:I=".png";break;case b.TIFF:I=".tif";break;default:I="";break}if(J){var H="\r\n",B="--",K="";q=["----DynamsoftWebCamFormBoundary",n.now()].join("");for(G in this._HTTPFormFields){K=[K,B,q,H,"Content-Disposition: form-data; ",'name="',G,'"',H,H,this._HTTPFormFields[G],H].join("")}K=[K,B,q,H,"Content-Disposition: form-data; ",'name="RemoteFile"; ','filename="',n.now(),I,'"',H,"Content-Type: text/plain; charset=utf-8",H,H,C,H,B,q,B].join("");E=K}else{var D=new FormData();for(G in this._HTTPFormFields){D.append(G,this._HTTPFormFields[G])}D.append("RemoteFile",C,n.now()+I);E=D}return E};f.prototype._getImgDataFromService=function(K,E,D,J,F,G){E=E||null;var H=this,N=H._dwsObject,B=[z.preUrl,z.portInfo.curPort,"/",w._getVersionStrForCommand(),"/ts=",n.now()].join(""),I=function(V,U,Q){var T=null,S=function(){try{T=n.parse(V)}catch(W){T=null}if(n.isObject(T)&&T.exception!==undefined){if(n.errorInfo.isUnknownCode(T.exception)){T.description=n.errorInfo.getUnknownString(T.exception,T.description);T.exception=EnumDCS_ErrorCode.Unknown}if(T.exception===EnumDCS_ErrorCode.ConnectionToServiceReset&&n.isString(T.description)){T.description=T.description.replace("Webcam","Camera")}if(!D&&N instanceof n.sdk.DcsObject){N._setErrCodeErrString(T.exception,T.description)}if(D&&H._asyncUploadErrCodeErrStrings[G]){H._asyncUploadErrCodeErrStrings[G].ec=T.exception;H._asyncUploadErrCodeErrStrings[G].es=T.description}if(n.isFunction(F)){F(V,U,Q)}}else{if(n.isFunction(J)){J(V)}}};if(D&&window.Blob&&V instanceof window.Blob&&window.FileReader){var P=new window.FileReader();try{P.readAsText(V)}catch(R){S()}P.onloadend=function(){var Y=P.result,W=null;try{W=n.parse(Y)}catch(X){W=null}if(W&&W.exception!==undefined){V=Y}S()}}else{S()}},O=function(R,Q,P){if(N instanceof n.sdk.DcsObject){if(w.navInfo.bIE&&(parseInt(w.navInfo.strBrowserVersion)<=9)&&n.isString(Q)&&(Q.toLowerCase().indexOf("denied")!==-1||Q.toLowerCase().indexOf(z.IE_PERMISSION_DENIED_Err_Code)!==-1||Q.toLowerCase().indexOf(z.IE_Unknown_Err_Code)!==-1)){if(!D){N._setErrCodeErrString(n.errorInfo.getOperationNotSupportedCode(),n.errorInfo.getOperationNotSupportedString())}else{if(D&&H._asyncUploadErrCodeErrStrings[G]){H._asyncUploadErrCodeErrStrings[G].ec=n.errorInfo.getOperationNotSupportedCode();H._asyncUploadErrCodeErrStrings[G].es=n.errorInfo.getOperationNotSupportedString()}}}else{if(!D){z.throwServiceNotConnectException(N)}else{if(D&&H._asyncUploadErrCodeErrStrings[G]){H._asyncUploadErrCodeErrStrings[G].ec=n.errorInfo.getConnectionToServiceLostCode();H._asyncUploadErrCodeErrStrings[G].es=n.errorInfo.getConnectionToServiceLostString()}}}}if(n.isFunction(F)){F(R,Q,P)}},C=K===j.BASE64?"text/plain; charset=utf-8":"application/octet-stream";cfg={method:"POST",url:B,data:E,dataType:"user-defined",onSuccess:I,onError:O,mimeType:C,async:D};var M=function(T,V,Q){var P=null,S=null,U;try{U=String.fromCharCode.apply(null,new Uint8Array(T));S=n.parse(U)}catch(R){S=null}if(n.isObject(S)&&S.exception!==undefined){P=U}else{if(K!==j.BASE64){if(T){P=new Uint8Array(T);P=new Blob([P],{type:C})}}else{P=T}}I(P,V,Q)};D=(D===undefined)?!0:D;if(D){if(K!==j.BASE64){cfg.xhrFields={responseType:"blob"};var L=parseFloat(w.navInfo.strBrowserVersion);if(w.navInfo.bSafari&&!isNaN(L)&&L<6.1){cfg.xhrFields={responseType:"arraybuffer"};cfg.onSuccess=M}}}else{if(w.navInfo.bIE&&w.navInfo.bHTML5Edition&&window.Uint8Array){if(K!==j.BASE64){cfg.xhrFields={responseType:"arraybuffer"}}cfg.onSuccess=M}else{cfg.contentType="text/plain; charset=x-user-defined";cfg.mimeType="text/plain; charset=x-user-defined";cfg.onSuccess=function(P,Q,V){var T,R,U,X=null;try{X=n.parse(P)}catch(W){X=null}if(n.isObject(X)&&X.exception!==undefined){U=P}else{if(K!==j.BASE64){T=V.nativeXhr.responseText;R=T.length;U=new Uint8Array(R);for(var S=0;S<R;S++){U[S]=T.charCodeAt(S)}U=new Blob([U],{type:C})}else{U=V.nativeXhr.responseText}}I(U,Q,V)}}}n.ajax(cfg)};f.prototype._upload=function(C,H,E,G,J,D,F,K){var B=-1,I=E&&n.isFunction(F)?function(N,P){var O=(N.total===0)?100:Math.round(N.loaded*100/N.total),M;if(B!==O){M=F(O)}B=O;if(M===true){P.abort()}}:false,L=E&&n.isFunction(F)?function(M,N){if(!M||!(M.upload)||w.navInfo.bIE&&parseInt(w.navInfo.strBrowserVersion)<=9){return null}n.addEventListener(M.upload,"progress",function(O){delete (O.totalSize);delete (O.position);I(O,M)})}:!1;n.ajax({method:H,url:C,data:G,beforeSend:L,contentType:K===j.BINARY?false:"multipart/form-data; boundary="+q,dataType:"user-defined",onSuccess:J,onError:D,async:E})};var e=function(){if(!dcsObject._errorString){for(v in EnumDCS_ErrorCode){if(EnumDCS_ErrorCode[v]==dcsObject._errorCode){var B="get"+v+"Code";if(n.errorInfo[B]){dcsObject._errorString=n.errorInfo[B]()}}}}};f.prototype.save=function(C,M,D,K,J){var H=this,L=H._dwsObject;var E={success:false,filename:C};if(H._bDestoryed){return E}if(!L._validateDivDom(H._imgViewer.ui._getImgViewerId(),!0)){return E}if(!L._validateImgViewerExist(H._imgViewer.ui._getImgViewerId(),H._bRemoved)){return E}if(H._validateImgIsHandlingAsyncOperation()){return E}if(!L._validateParamNum(arguments,5)||!L._validateArrayType("indices",M)||!L._validateNumberType("imageType",D)){return E}if(null!=C&&typeof C!="string"){H._dwsObject._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("filename"));return E}if(!C){C=""}C=C.replace(/[\\]/g,"\\\\");if(typeof K!="boolean"){H._dwsObject._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("overwritePrompt"));return E}if(typeof J!="boolean"){H._dwsObject._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("showSaveDialog"));return E}M=H._getValidatedIndices(M);if(M===null){H._dwsObject._setErrCodeErrString(n.errorInfo.getValueNotValidCode(),n.errorInfo.getValueNotValidString("indices"));return E}if(M.length>1&&(D!==b.TIFF&&D!=b.PDF)){H._dwsObject._setErrCodeErrString(n.errorInfo.getMultipageNotSupportedCode(),n.errorInfo.getMultipageNotSupportedString());return E}if(H._bPropertiesChanged||D==b.PDF&&(H.pdfinfo._pdfCreationDate===null||H.pdfinfo._pdfModifiedDate===null)){var B=H._sendPropertiesToBackend();if(!B){return E}}var F={session:z.sessionId,object:L._dwsObjectId,method:"SaveLocal",parameter:[H._imgViewer._imgViewerId,C,M,D,K,J,true,0]},I=function(O){E={success:true,filename:O.result[0]}},G=function(O){if(O){E={success:false,filename:(O&&O.result[2]||C)}}e()},N=!1;L._setErrCodeErrString(n.errorInfo.getOkCode(),n.errorInfo.getOkString());z.postSyncCommand(L,n.stringify(F),I,G);return E};f.prototype.saveAsync=function(C,N,E,L,K,O,H){var I=this,M=I._dwsObject;var D=function(){if(H){(function(Q,S,T,R){setTimeout(function(){Q(S,T,R)},0)})(H,M.getErrorCode(),M.getErrorString(),C)}};if(I._bDestoryed){D();return false}if(!M._validateDivDom(I._imgViewer.ui._getImgViewerId(),!0)){D();return false}if(!M._validateImgViewerExist(I._imgViewer.ui._getImgViewerId(),I._bRemoved)){D();return false}if(I._validateImgIsHandlingAsyncOperation()){D();return false}if(!M._validateParamNum(arguments,7)||!M._validateArrayType("indices",N)||!M._validateNumberType("imageType",E)){D();return false}if(null!=C&&typeof C!="string"){I._dwsObject._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("filename"));D();return false}if(!C){C=""}C=C.replace(/[\\]/g,"\\\\");if(typeof L!="boolean"){I._dwsObject._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("overwritePrompt"));D();return false}if(typeof K!="boolean"){I._dwsObject._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("showSaveDialog"));D();return false}if(typeof O!="function"){I._dwsObject._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("onSaveSuccess"));D();return false}if(typeof H!="function"){I._dwsObject._setErrCodeErrString(n.errorInfo.getTypeNotValidCode(),n.errorInfo.getTypeNotValidString("onSaveFailure"));D();return false}N=I._getValidatedIndices(N);if(N===null){I._dwsObject._setErrCodeErrString(n.errorInfo.getValueNotValidCode(),n.errorInfo.getValueNotValidString("indices"));D();return false}if(N.length>1&&(E!==b.TIFF&&E!=b.PDF)){I._dwsObject._setErrCodeErrString(n.errorInfo.getMultipageNotSupportedCode(),n.errorInfo.getMultipageNotSupportedString());D();return strBase64}if(I._bPropertiesChanged||E==b.PDF&&(I.pdfinfo._pdfCreationDate===null||I.pdfinfo._pdfModifiedDate===null)){var B=I._sendPropertiesToBackend();if(!B){D();return false}}var F={session:z.sessionId,object:M._dwsObjectId,method:"SaveLocal",parameter:[I._imgViewer._imgViewerId,C,N,E,L,K,false,++I._asyncTaskId]},J=function(Q){(function(R,U,S,V){var T=function(){var W={session:z.sessionId,object:R._dwsObjectId,method:"CheckAsyncTaskResult",parameter:[U]};z.postSyncCommand(R,n.stringify(W),function(X){if(""===X.result[0].errorcode){setTimeout(T,1000)}else{if(0===X.result[0].errorcode){S(X.result[0].filename)}else{R._setErrCodeErrString(X.result[0].errorcode,X.result[0].errorstring);e();V(X.result[0].errorcode,X.result[0].errorstring,X.result[0].filename)}}},function(X){e();V(R.getErrorCode(),R.getErrorString(),(X&&X.result[2]||C))})};T()})(M,I._asyncTaskId,O,H,C)},G=function(Q){e();(function(U,T,S,R){setTimeout(function(){U(T,S,R)},0)})(H,M.getErrorCode(),M.getErrorString(),(Q&&Q.result[2]||C))},P=!1;P=z.postSyncCommand(M,n.stringify(F),J,G);if(P){M._setErrCodeErrString(n.errorInfo.getOkCode(),n.errorInfo.getOkString())}return true};f.prototype._destory=function(B){if(!B){this._bDestoryed=true}else{this._bRemoved=true}};m.IO=f})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.dcsEnv,dynamsoft.lib.detect);(function(g,e){var l="PDF",m=l.toLowerCase(),d="get",f="set",b="iValue",a=["Author","CompressionType","CreationDate","ModifiedDate","Creator","Producer","Subject","Keywords","Title","Version"],k=[],j={AUTO:0,FAX3:1,FAX4:2,LZW:3,JPEG:4};function h(o){var n=this;n._io=o;n.EnumPDFCompressionType=j;g.each(a,function(p){n["_"+m+p]=(p==="CreationDate"||p==="ModifiedDate")?null:(p==="CompressionType")?j.AUTO:""})}g.each(a,function(n){k.push(d+l+n);k.push(f+l+n)});g.each(k,function(n){h.prototype[n]=function(){var t=this,o=t._io._dwsObject;if(t._io._bDestoryed){return false}if(!o._validateDivDom(t._io._imgViewer.ui._getImgViewerId(),!0)){return(n.indexOf(d)===0)?undefined:false}if(!o._validateImgViewerExist(t._io._imgViewer.ui._getImgViewerId(),t._io._bRemoved)){return(n.indexOf(d)===0)?undefined:false}if(n.indexOf(d)===0){if(!o._validateParamNum(arguments,0)){return null}}else{if(!o._validateParamNum(arguments,1)){return false}if(dynamsoft.lib.endsWith(n,"CreationDate")||dynamsoft.lib.endsWith(n,"ModifiedDate")){if(!(arguments[0] instanceof Date)){o._setErrCodeErrString(g.errorInfo.getTypeNotValidCode(),g.errorInfo.getTypeNotValidString(b));return false}var r=dynamsoft.lib.endsWith(n,"ModifiedDate")?this["_"+m+"CreationDate"]:this["_"+m+"ModifiedDate"],p=arguments[0];if(r!==null){if(dynamsoft.lib.endsWith(n,"ModifiedDate")&&r.getTime()>p.getTime()||dynamsoft.lib.endsWith(n,"CreationDate")&&r.getTime()<p.getTime()){o._setErrCodeErrString(g.errorInfo.getValueNotValidCode(),"Modified date must be greater than creation date.");return false}}}else{if(dynamsoft.lib.endsWith(n,"CompressionType")){if(!o._validateNumberType(b,arguments[0])||!t._io._isValidValueInEnum(j,arguments[0],b)){return false}}else{if(!o._validateStringType(b,arguments[0])){return false}}}}var q=-1,s="";for(q=0;q<a.length;q++){if(n.indexOf(a[q])!==-1){s=a[q];break}}o._setErrCodeErrString(g.errorInfo.getOkCode(),g.errorInfo.getOkString());if(n.indexOf(d)===0){return t["_"+m+s]}else{if(t["_"+m+s]!==arguments[0]){t._io._bPropertiesChanged=!0}t["_"+m+s]=arguments[0];return true}}});h.prototype._getJsonObj=function(){var t={},r="",s=null;for(var q=0;q<a.length;q++){r=a[q];s=this["_"+m+r];s=s===null?"":s;t[r]=(r==="CreationDate"||a[q]==="ModifiedDate")?s.toString():s}var o=new Date(),n=this["_"+m+"CreationDate"],p=this["_"+m+"ModifiedDate"];if(n===null&&p===null){t.ModifiedDate=t.CreationDate=this._yyyymmddhhMMss(o)}else{if(n!==null&&p!==null){t.CreationDate=this._yyyymmddhhMMss(n);t.ModifiedDate=this._yyyymmddhhMMss(p)}else{t.ModifiedDate=t.CreationDate=this._yyyymmddhhMMss(n===null?p:n)}}return t};h.prototype._yyyymmddhhMMss=function(o){if(!(o instanceof Date)){return""}var r=o.getFullYear(),s=o.getMonth()+1,p=o.getDate(),n=o.getHours(),u=o.getMinutes(),q=o.getSeconds();var t=function(w){return(w>9?"":"0")+w};return[r,t(s),t(p),t(n),t(u),t(q)].join("")};e.PdfInfo=h})(dynamsoft.lib,dynamsoft.lib.sdk);(function(e,d,b){function a(f){if(f&&f._documentEditorManager){return}this._dwsObject=f}a.prototype.addDocumentEditor=function(h,g){var l=this,f=!0;if(!e.isString(g)||g.indexOf(d._dcoEditorClientIdPrefix)==-1){g=d._dcoEditorClientIdPrefix+e.getRandom();var k={session:dynamsoft.lib.detect.sessionId,object:l._dwsObject._dwsObjectId,method:"AddDocumentEditor",parameter:[g]};f=dynamsoft.lib.detect.postSyncCommand(l._dwsObject,e.stringify(k),null,null)}if(f){var j=new b.DocumentEditor(l._dwsObject,h,g);d._documentEditorDic[h]={dwsObject:l._dwsObject,documentEditor:j}}return f};a.prototype.removeDocumentEditor=function(g){var l=this,f=false,k=d._documentEditorDic[g],j=k.documentEditor,h={session:dynamsoft.lib.detect.sessionId,object:l._dwsObject._dwsObjectId,method:"RemoveDocumentEditor",parameter:[j._docEditorId]};f=dynamsoft.lib.detect.postSyncCommand(l._dwsObject,e.stringify(h),null,null);if(f){j.ui._destory(true);j.document._destory(true);delete d._documentEditorDic[g]}return f};b.DocumentEditorManager=a})(dynamsoft.lib,dynamsoft.dcsEnv,dynamsoft.lib.sdk);(function(d,a){function b(e,g,f){var h=this;this._innerIndex=d.guid();h._dwsObject=e;h._docEditorId=f;h.imageViewer=null;h.document=new a.Document(e,h);h.ui=new a.documentUI(e,h,g);h.documentCtrl=new a.DocumentControl(e,h)}a.DocumentEditor=b})(dynamsoft.lib,dynamsoft.lib.sdk);(function(l,h,m,a){function d(o,n,p){var r=this;r._dwsObject=o;r._documentEditor=n;r._documentContainerId=p;r._userDocumentContainer=l.one("#"+p).getEL();l.empty(r._userDocumentContainer);var q=l.getElDimensions(r._userDocumentContainer,false);r._userDocumentEditorWidth=q?q.clientWidth:r._userDocumentContainer.clientWidth;r._userDocumentEditorHeight=q?q.clientHeight:r._userDocumentContainer.clientHeight;r._userDocumentContainer.innerHTML='<div class="ds-dws-doc-editor-wrapper" oncontextmenu="return false;"><div class="ds-dws-doc-editor-container ds-dws-display-inline-block"><div class="ds-dws-doc-obj-container"></div><canvas class="canvas-editer"></canvas></div></div>';r._documentContainerWrapper=l.one(".ds-dws-doc-editor-wrapper",r._userDocumentContainer).getEL();r._documentContainerWrapper.style.width=r._userDocumentEditorWidth+"px";r._documentContainerWrapper.style.height=r._userDocumentEditorHeight+"px";r._documentContainerBox=l.one(".ds-dws-doc-editor-container",r._documentContainerWrapper).getEL();r._documentContainerBox.style.position="relative";r._documentContainerBox.style.width=r._userDocumentEditorWidth+"px";r._documentContainerBox.style.height=r._userDocumentEditorHeight+"px";r._documentContainerImageObj=l.one(".ds-dws-doc-obj-container",r._documentContainerBox).getEL();r._documentContainerImageObj.style.position="relative";r._documentContainerCanvasEditor=l.one(".canvas-editer",r._documentContainerBox).getEL();r._documentContainerCanvasEditor.style.position="absolute";r._documentContainerCanvasEditor.style.top=0;r._documentContainerCanvasEditor.style.left=0;r._documentContainerCanvasEditor.setAttribute("onselectstart","return false;");r._documentContainerCanvasEditor.setAttribute("draggable","return false;");r._pointInfo=new Array(8);r._MINZOOM=0.02,r._MAXZOOM=65;r._zoom=1;r._documentBoundaryColor=1589110015;r._backgroundColor=4294967295;r._documentBoundaryThickness=2;r.MINTHICKNESS=0;r.MAXTHICKNESS=100000;r._zoomSet=false;r.onmouseclick=null;r.onmousemove=null;r._displayMode="";r._bDestoryed=false;r._bRemoved=false}d.prototype._getDocEditorId=function(){return this._documentContainerId};d.prototype._getDocEditorEl=function(){try{return l.one("#"+this._documentContainerId).getEL()}catch(n){return false}};d.prototype.setDocumentBoundaryThickness=function(n){var o=this;if(o._bDestoryed){return false}if(!o._dwsObject._validateDivDom(o._getDocEditorId(),"document")){return false}if(!o._dwsObject._validateDocEditorExist(o._getDocEditorId(),o._bRemoved)){return false}if(!o._dwsObject._validateParamNum(arguments,1)||!o._dwsObject._validateNumberType("thickness",n)){return false}if(!o._dwsObject._validateValue("thickness",n,[o.MINTHICKNESS,o.MAXTHICKNESS],true)){return false}o._documentBoundaryThickness=Math.round(n);o._refresh();return true};d.prototype.getDocumentBoundaryThickness=function(){var n=this;if(n._bDestoryed){return null}if(!n._dwsObject._validateDivDom(n._getDocEditorId(),"document")){return null}if(!n._dwsObject._validateDocEditorExist(n._getDocEditorId(),n._bRemoved)){return null}if(!n._dwsObject._validateParamNum(arguments,0)){return null}return n._documentBoundaryThickness};d.prototype.getZoom=function(){var n=this;if(n._bDestoryed){return null}if(n._dwsObject._bDestoryed){return null}if(!n._dwsObject._validateDivDom(n._getDocEditorId(),"document")){return null}if(!n._dwsObject._validateDocEditorExist(n._getDocEditorId(),n._bRemoved)){return null}if(!n._dwsObject._validateParamNum(arguments,0)){return null}return n._zoom};d.prototype.setZoom=function(n){var o=this;if(o._bDestoryed){return false}if(o._dwsObject._bDestoryed){return false}if(!o._dwsObject._validateDivDom(o._getDocEditorId(),"document")){return false}if(!o._dwsObject._validateDocEditorExist(o._getDocEditorId(),o._bRemoved)){return false}if(!o._dwsObject._validateParamNum(arguments,1)||!o._dwsObject._validateNumberType("zoomValue",n)){return false}if(!o._dwsObject._validateValue("zoomValue",n,[o._MINZOOM,o._MAXZOOM],true)){return false}o._zoom=n;o._zoomSet=true;o._refresh();return true};var e="getBackgroundColor",b="setBackgroundColor",j="getDocumentBoundaryColor",f="setDocumentBoundaryColor",k=0,g=4294967295;l.each([e,b,j,f],function(n){d.prototype[n]=function(){var o=this;if(o._bDestoryed){if(n==e||n==j){return null}return false}if(o._dwsObject._bDestoryed){if(n==e||n==j){return null}return false}if(!o._dwsObject._validateDivDom(o._getDocEditorId(),"document")){return(n==e||n==j)?null:false}if(!o._dwsObject._validateDocEditorExist(o._getDocEditorId(),o._bRemoved)){return(n==e||n==j)?null:false}if(n==e||n==j){if(!o._dwsObject._validateParamNum(arguments,0)){return null}}if(n==b||n==f){if(!o._dwsObject._validateParamNum(arguments,1)||!o._dwsObject._validateNumberType("color",arguments[0])||!o._dwsObject._validateValue("color",arguments[0],[k,g],true)){return false}}if(n==e){return o._backgroundColor}if(n==b){o._backgroundColor=arguments[0];o._userDocumentContainer.style.backgroundColor=l.IntToColorStr(arguments[0]);return true}if(n==j){return o._documentBoundaryColor}if(n==f){o._documentBoundaryColor=arguments[0];o._refresh();return true}}});l.each(["getContainerId","show","hide"],function(n){d.prototype[n]=function(){var p=this;if(p._bDestoryed){return n=="getContainerId"?null:false}var o=p._getDocEditorId();if(!p._dwsObject._validateDivDom(o,"document")){return n=="getContainerId"?null:false}if(!p._dwsObject._validateDocEditorExist(p._getDocEditorId(),p._bRemoved)){return n=="getContainerId"?null:false}if(!p._dwsObject._validateParamNum(arguments,0)){return n=="getContainerId"?null:false}if(n=="getContainerId"){return o}if(n=="show"){p._displayMode=(p._displayMode=="none")?"":p._displayMode;if(p._userDocumentContainer.style.display=="none"){p._userDocumentContainer.style.display=p._displayMode}else{p._displayMode=p._userDocumentContainer.style.display}return true}if(n=="hide"){if(p._userDocumentContainer.style.display!="none"){p._displayMode=p._userDocumentContainer.style.display}p._userDocumentContainer.style.display="none";p._displayMode=(p._displayMode=="none")?"":p._displayMode;return true}return false}});d.prototype._refresh=function(){var n=this;n._documentEditor.documentCtrl.refreshUI()};d.prototype._GetPointInfo=function(){var q=this,p=q._documentEditor.documentCtrl.updateMovePointInfo();for(var o=0;o<p.length;o++){q._pointInfo[o]=Math.round(p[o])}for(var o=0;o<p.length/2;o++){for(var n=0;n<p.length/2;n++){if(o!=n&&q._pointInfo[2*o]==q._pointInfo[2*n]){if(q._pointInfo[2*o+1]==q._pointInfo[2*n+1]){q._pointInfo[2*o]++}}}}for(var o=0;o<q._pointInfo.length;o++){if(isNaN(q._pointInfo[o])){q._pointInfo[o]=o+1}}return q._pointInfo};d.prototype._destory=function(n){var o=this;l.empty(o._userDocumentContainer);if(!n){o._bDestoryed=true}else{o._bRemoved=true}o._zoomSet=false};h.documentUI=d})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.dcsEnv,dynamsoft.lib.detect);(function(g,e,d,f){function b(j,h){var k=this;k._dwsObject=j;k._documentEditor=h;k._MINADJUSTABLE=-100;k._MAXADJUSTABLE=100;k._bDiscard=false;k._bDestoryed=false;k._bRemoved=false}b.prototype.adjustContrast=function(j){var l=this;if(l._bDestoryed){return false}if(!l._dwsObject._validateDivDom(l._documentEditor.ui._getDocEditorId(),"document")){return false}if(!l._dwsObject._validateDocEditorExist(l._documentEditor.ui._getDocEditorId(),l._bRemoved)){return false}if(!l._dwsObject._validateParamNum(arguments,1)||!l._dwsObject._validateNumberType("contrast",j)){return false}if(!l._dwsObject._validateValue("contrast",j,[l._MINADJUSTABLE,l._MAXADJUSTABLE],true)){return false}var k={session:d.sessionId,object:l._dwsObject._dwsObjectId,method:"AdjustContrastOriginal",parameter:[l._documentEditor._docEditorId,j]};var h=g.detect.postSyncCommand(l._dwsObject,g.stringify(k),null,null);if(h){l._documentEditor.documentCtrl.refreshSrc();return true}return false};b.prototype.adjustBrightness=function(k){var l=this;if(l._bDestoryed){return false}if(!l._dwsObject._validateDivDom(l._documentEditor.ui._getDocEditorId(),"document")){return false}if(!l._dwsObject._validateDocEditorExist(l._documentEditor.ui._getDocEditorId(),l._bRemoved)){return false}if(!l._dwsObject._validateParamNum(arguments,1)||!l._dwsObject._validateNumberType("brightness",k)){return false}if(!l._dwsObject._validateValue("brightness",k,[l._MINADJUSTABLE,l._MAXADJUSTABLE],true)){return false}var j={session:d.sessionId,object:l._dwsObject._dwsObjectId,method:"AdjustBrightnessOriginal",parameter:[l._documentEditor._docEditorId,k]};var h=g.detect.postSyncCommand(l._dwsObject,g.stringify(j),null,null);if(h){l._documentEditor.documentCtrl.refreshSrc();return true}return false};var a=["rotateLeft","rotateRight"];g.each(a,function(h){b.prototype[h]=function(){var m=this,l;if(h=="rotateLeft"){l="left"}else{l="right"}if(m._bDestoryed){return false}if(!m._dwsObject._validateDivDom(m._documentEditor.ui._getDocEditorId(),"document")){return false}if(!m._dwsObject._validateDocEditorExist(m._documentEditor.ui._getDocEditorId(),m._bRemoved)){return false}if(!m._dwsObject._validateParamNum(arguments,0)){return false}var k={session:d.sessionId,object:m._dwsObject._dwsObjectId,method:g.upperCaseFirst(h)+"Original",parameter:[m._documentEditor._docEditorId]};var j=g.detect.postSyncCommand(m._dwsObject,g.stringify(k),null,null);if(j){m._documentEditor.documentCtrl.refreshRotate(l);return true}return false}});g.each(["toColor","toGrey","toBlackWhite"],function(h){b.prototype[h]=function(){var l=this;if(l._bDestoryed){return false}if(!l._dwsObject._validateDivDom(l._documentEditor.ui._getDocEditorId(),"document")){return false}if(!l._dwsObject._validateDocEditorExist(l._documentEditor.ui._getDocEditorId(),l._bRemoved)){return false}if(!l._dwsObject._validateParamNum(arguments,0)){return false}var k={session:d.sessionId,object:l._dwsObject._dwsObjectId,method:g.upperCaseFirst(h)+"Original",parameter:[l._documentEditor._docEditorId]};var j=g.detect.postSyncCommand(l._dwsObject,g.stringify(k),null,null);if(j){l._documentEditor.documentCtrl.refreshSrc();return true}return false}});b.prototype.ondiscardmodified=function(){return false};b.prototype.discard=function(){var n=this;if(n._bDestoryed){return false}if(!n._dwsObject._validateDivDom(n._documentEditor.ui._getDocEditorId(),"document")){return false}if(!n._dwsObject._validateDocEditorExist(n._documentEditor.ui._getDocEditorId(),n._bRemoved)){return false}if(!n._dwsObject._validateParamNum(arguments,0)){return false}var k={session:d.sessionId,object:n._dwsObject._dwsObjectId,method:"DiscardDocument",parameter:[n._documentEditor._docEditorId,n._bDiscard]},j=function(){n._documentEditor.documentCtrl.destroy()},m=function(o){};var h=g.detect.postSyncCommand(n._dwsObject,g.stringify(k),j,m);if(h){n._bDiscard=false;return true}else{if(n._dwsObject.getErrorCode()==-3001){var l;if(g.isFunction(n.ondiscardmodified)){l=n.ondiscardmodified()}else{l=n.ondiscardmodified}if(l==true){n._dwsObject._setErrCodeErrString(g.errorInfo.getOperationCancelledCode(),g.errorInfo.getOperationCancelledString());return false}else{n._bDiscard=true;n.discard();return true}}else{if(n._dwsObject.getErrorCode()==-1028){n._dwsObject._setErrCodeErrString(g.errorInfo.getDocumentNotExistCode(),g.errorInfo.getDocumentNotExistString());return false}else{return false}}}};b.prototype.save=function(){var l=this,j=false;if(l._bDestoryed){return false}if(!l._dwsObject._validateParamNum(arguments,0)){return false}if(!l._dwsObject._validateDivDom(l._documentEditor.ui._getDocEditorId(),"document")){return false}if(l._documentEditor.imageViewer&&!l._dwsObject._validateDivDom(l._documentEditor.imageViewer.ui._getImgViewerId(),!0)){return false}if(!l._dwsObject._validateDocEditorExist(l._documentEditor.ui._getDocEditorId(),l._bRemoved)){return false}if(l._documentEditor.imageViewer&&!l._dwsObject._validateImgViewerExist(l._documentEditor.imageViewer.ui._getImgViewerId(),l._bRemoved)){return false}if(l._documentEditor.imageViewer&&l._documentEditor.imageViewer.io._validateImgIsHandlingAsyncOperation()){return false}var k={session:d.sessionId,object:l._dwsObject._dwsObjectId,method:"SaveDocument",parameter:[l._documentEditor._docEditorId,l._documentEditor.ui._GetPointInfo()]},h=function(r){var n=l._dwsObject.getErrorCode(),s=l._dwsObject.getErrorString();var t=r.result[0].imageviewid;var q;var p=r.result[0].index;var m=r.result[0].result;if(m==true){for(var o in f._imageViewerDic){if(f._imageViewerDic[o].imgViewerClientId==t){q=f._imageViewerDic[o].imageViewer}}l._documentEditor.documentCtrl.destroy();q.image._updatedImage(p);j=true}else{l._dwsObject._setErrCodeErrString(n,s);return false}};g.detect.postSyncCommand(l._dwsObject,g.stringify(k),h,null);return j};b.prototype.saveAs=function(n){var m=this;if(m._bDestoryed){return false}if(!m._dwsObject._validateParamNum(arguments,1)||!m._dwsObject._validateStringType("imageViewerContainerId",n)){return false}if(!m._dwsObject._validateDivDom(n,!0)){return false}if(!m._dwsObject._validateDivDom(m._documentEditor.ui._getDocEditorId(),!0)){return false}var h=f._documentEditorDic[n];var l=f._videoViewerDic[n];if(h||l){m._dwsObject._setErrCodeErrString(g.errorInfo.getObjectOccupiedCode(),g.errorInfo.getObjectOccupiedString(n));return false}if(!m._dwsObject._validateDocEditorExist(m._documentEditor.ui._getDocEditorId(),m._bRemoved)){return false}if(!m._dwsObject._validateImgViewerExist(n,m._bRemoved)){return false}var j=f._imageViewerDic[n];var p=j.imageViewer;if(p.io._validateImgIsHandlingAsyncOperation()){return false}if(p.image.getCount()==p.image.getCapacity()){m._dwsObject._setErrCodeErrString(g.errorInfo.getBufferIsFullCode(),g.errorInfo.getBufferIsFullString());return false}var k={session:d.sessionId,object:m._dwsObject._dwsObjectId,method:"SaveDocumentAs",parameter:[m._documentEditor._docEditorId,p._imgViewerId,m._documentEditor.ui._GetPointInfo()]},o=function(){m._documentEditor.documentCtrl.destroy();p.ui._addImageControl()};var q=g.detect.postSyncCommand(m._dwsObject,g.stringify(k),o,null);return q};b.prototype._destory=function(h){if(!h){this._bDestoryed=true}else{this._bRemoved=true}};e.Document=b})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.lib.detect,dynamsoft.dcsEnv);(function(f,d,a,e){function b(h,g){var j=this;j.dwsObject=h;j.documentEditor=g;j.documentEditorWidth="";j.documentEditorHeight="";j.documentUrl="";j.objDocument=false;j.objDocumentDefaultWidth="";j.objDocumentDefaultHeight="";j.defaultPointInfo="";j.pointInfo=new Array(10);j.movePointInfo=new Array(8);j.zoomPointInfo=new Array(8);j.midPointInfo=new Array(8);j.pointInductor=new Array(8);j.slopeSide=new Array(4);j.tempx="";j.tempy="";j.curPointIndex="";j.invalidShape=false;j.drawErrorRect=false;j.outerDiv=false;j.hintDiv=false;j.editorCanvas=false;j.editorCanvasWidth="";j.editorCanvasHeight="";j.containerBox=false;j.zoom=1;j.brushThickness=2;j.MAXLOACOUNT=6;j.curLoadCount=0;j.bDestroy=false;j.init()}b.prototype.init=function(){var g=this;g.documentEditorWidth=g.documentEditor.ui._userDocumentEditorWidth;g.documentEditorHeight=g.documentEditor.ui._userDocumentEditorHeight;g.containerBox=g.documentEditor.ui._documentContainerBox;g.outerDiv=g.documentEditor.ui._documentContainerImageObj;g.editorCanvas=g.documentEditor.ui._documentContainerCanvasEditor;g.documentContainerImageObj=g.documentEditor.ui._documentContainerImageObj};b.prototype.attachDocument=function(){var h=this;h.invalidShape=false;h.drawErrorRect=false;h.zoom=1;h.documentUrl=h.getRefreshedDocUrl();h.GetDocBoundaryInfoFromEditor();for(var g=0;g<h.pointInfo.length;g++){if(h.pointInfo[g]<0){h.pointInfo[g]=0}}h.objDocumentDefaultWidth=h.pointInfo[0];h.objDocumentDefaultHeight=h.pointInfo[1];h.movePointInfo=h.getMovePointInfo();h.copyArry(h.movePointInfo,h.zoomPointInfo);h.getSlopeSide();h.midPointInfo=h.getMidPointInfo();h.destroy();h.initHintDiv();h.initObjDoc();h.editorCanvas.onmousedown=function(o){var k=this.getContext("2d");var n=(o||window.event).offsetX;var p=(o||window.event).offsetY;h.brushThickness=h.documentEditor.ui.getDocumentBoundaryThickness();for(var m=0;m<h.pointInductor.length;m++){if(m<4){h.pointInductor[m]=(Math.abs(h.zoomPointInfo[2*m]-n)<h.brushThickness*2+8&&Math.abs(h.zoomPointInfo[2*m+1]-p)<h.brushThickness*2+8)?true:false}else{h.pointInductor[m]=(Math.abs(h.midPointInfo[2*(m-4)]-n)<h.brushThickness*2+8&&Math.abs(h.midPointInfo[2*(m-4)+1]-p)<h.brushThickness*2+8)?true:false}}for(var m=h.pointInductor.length-1;m>-1;m--){if(m<4&&h.pointInductor[m]==true){for(var l=0;l<h.pointInductor.length;l++){if(m!=l){h.pointInductor[l]=false}}}}for(var m=0;m<h.pointInductor.length;m++){if(h.pointInductor[m]==true&&!h.invalidShape){h.curPointIndex=m;if(m<4){h.tempx=h.zoomPointInfo[2*m];h.tempy=h.zoomPointInfo[2*m+1]}else{h.tempx0=h.zoomPointInfo[2*(m-4)],h.tempy0=h.zoomPointInfo[2*(m-4)+1],h.tempx1=h.zoomPointInfo[(2*(m-4)+2)%8],h.tempy1=h.zoomPointInfo[(2*(m-4)+3)%8]}}}this.onmousemove=function(A){var j=(A||window.event).offsetX;var B=(A||window.event).offsetY;for(var x=0;x<h.pointInductor.length;x++){if(x<4&&h.pointInductor[x]==true){this.style.cursor="move";k.clearRect(0,0,h.editorCanvasWidth,h.editorCanvasHeight);h.zoomPointInfo[2*x]=j;h.zoomPointInfo[2*x+1]=B;h.getSlopeSide();h.checkPointBorder();if(h.checkPointShape()){h.drawErrorRect=true}else{h.drawErrorRect=false}h.drawRect()}else{if(x==4&&h.pointInductor[4]==true){this.style.cursor="move";k.clearRect(0,0,h.editorCanvasWidth,h.editorCanvasHeight);var G=h.zoomPointInfo[0],z=h.zoomPointInfo[1],E=h.zoomPointInfo[2],w=h.zoomPointInfo[3];var s=h.slopeSide[0],F=-1,y=B-h.slopeSide[0]*j;var r=h.slopeSide[1],D=-1,u=h.zoomPointInfo[3]-h.slopeSide[1]*h.zoomPointInfo[2];var q=h.slopeSide[3],C=-1,t=h.zoomPointInfo[1]-h.slopeSide[3]*h.zoomPointInfo[0];if(h.slopeSide[0]==0){if(h.slopeSide[1]=="Infinity"){h.zoomPointInfo[2]=h.zoomPointInfo[2];h.zoomPointInfo[3]=B}else{h.zoomPointInfo[2]=(B-h.zoomPointInfo[3])/h.slopeSide[1]+h.zoomPointInfo[2];h.zoomPointInfo[3]=B}if(h.slopeSide[3]=="Infinity"){h.zoomPointInfo[0]=h.zoomPointInfo[0];h.zoomPointInfo[1]=B}else{h.zoomPointInfo[0]=(B-h.zoomPointInfo[1])/h.slopeSide[3]+h.zoomPointInfo[0];h.zoomPointInfo[1]=B}}else{if(h.slopeSide[0]=="Infinity"){if(h.slopeSide[1]==0){h.zoomPointInfo[2]=j;h.zoomPointInfo[3]=h.zoomPointInfo[3]}else{h.zoomPointInfo[3]=h.slopeSide[1]*(j-h.zoomPointInfo[2])+h.zoomPointInfo[3];h.zoomPointInfo[2]=j}if(h.slopeSide[3]==0){h.zoomPointInfo[0]=j;h.zoomPointInfo[1]=h.zoomPointInfo[1]}else{h.zoomPointInfo[1]=h.slopeSide[3]*(j-h.zoomPointInfo[0])+h.zoomPointInfo[1];h.zoomPointInfo[0]=j}}else{if(h.slopeSide[1]==0){h.zoomPointInfo[2]=h.zoomPointInfo[2]+(j-h.midPointInfo[0]);h.zoomPointInfo[3]=h.zoomPointInfo[3]}else{if(h.slopeSide[1]=="Infinity"){h.zoomPointInfo[2]=h.zoomPointInfo[2];h.zoomPointInfo[3]=h.zoomPointInfo[3]+(B-h.midPointInfo[1])}else{h.zoomPointInfo[2]=(D*y-F*u)/(r*F-s*D);h.zoomPointInfo[3]=(s*u-r*y)/(r*F-s*D)}}if(h.slopeSide[3]==0){h.zoomPointInfo[0]=h.zoomPointInfo[0]+(j-h.midPointInfo[0]);h.zoomPointInfo[1]=h.zoomPointInfo[1]}else{if(h.slopeSide[3]=="Infinity"){h.zoomPointInfo[0]=h.zoomPointInfo[0];h.zoomPointInfo[1]=h.zoomPointInfo[1]+(B-h.midPointInfo[1])}else{h.zoomPointInfo[0]=(C*y-F*t)/(q*F-s*C);h.zoomPointInfo[1]=(s*t-q*y)/(q*F-s*C)}}}}h.checkPointBorder();if(h.checkPointShape()){h.drawErrorRect=true;h.zoomPointInfo[0]=G;h.zoomPointInfo[1]=z;h.zoomPointInfo[2]=E;h.zoomPointInfo[3]=w}else{h.drawErrorRect=false}h.drawRect()}else{if(x==5&&h.pointInductor[5]==true){this.style.cursor="move";k.clearRect(0,0,h.editorCanvasWidth,h.editorCanvasHeight);var G=h.zoomPointInfo[2],z=h.zoomPointInfo[3],E=h.zoomPointInfo[4],w=h.zoomPointInfo[5];var s=h.slopeSide[1],F=-1,y=B-h.slopeSide[1]*j;var r=h.slopeSide[0],D=-1,u=h.zoomPointInfo[3]-h.slopeSide[0]*h.zoomPointInfo[2];var q=h.slopeSide[2],C=-1,t=h.zoomPointInfo[5]-h.slopeSide[2]*h.zoomPointInfo[4];if(h.slopeSide[1]==0){if(h.slopeSide[2]=="Infinity"){h.zoomPointInfo[4]=h.zoomPointInfo[4];h.zoomPointInfo[5]=B}else{h.zoomPointInfo[4]=(B-h.zoomPointInfo[5])/h.slopeSide[2]+h.zoomPointInfo[4];h.zoomPointInfo[5]=B}if(h.slopeSide[0]=="Infinity"){h.zoomPointInfo[2]=h.zoomPointInfo[2];h.zoomPointInfo[3]=B}else{h.zoomPointInfo[2]=(B-h.zoomPointInfo[3])/h.slopeSide[0]+h.zoomPointInfo[2];h.zoomPointInfo[3]=B}}else{if(h.slopeSide[1]=="Infinity"){if(h.slopeSide[2]==0){h.zoomPointInfo[4]=j;h.zoomPointInfo[5]=h.zoomPointInfo[5]}else{h.zoomPointInfo[5]=h.slopeSide[2]*(j-h.zoomPointInfo[4])+h.zoomPointInfo[5];h.zoomPointInfo[4]=j}if(h.slopeSide[0]==0){h.zoomPointInfo[2]=j;h.zoomPointInfo[3]=h.zoomPointInfo[3]}else{h.zoomPointInfo[3]=h.slopeSide[0]*(j-h.zoomPointInfo[2])+h.zoomPointInfo[3];h.zoomPointInfo[2]=j}}else{if(h.slopeSide[2]==0){h.zoomPointInfo[4]=h.zoomPointInfo[4]+(j-h.midPointInfo[2]);h.zoomPointInfo[5]=h.zoomPointInfo[5]}else{if(h.slopeSide[2]=="Infinity"){h.zoomPointInfo[4]=h.zoomPointInfo[4];h.zoomPointInfo[5]=h.zoomPointInfo[5]+(B-h.midPointInfo[3])}else{h.zoomPointInfo[4]=(C*y-F*t)/(q*F-s*C);h.zoomPointInfo[5]=(s*t-q*y)/(q*F-s*C)}}if(h.slopeSide[0]==0){h.zoomPointInfo[2]=h.zoomPointInfo[2]+(j-h.midPointInfo[2]);h.zoomPointInfo[3]=h.zoomPointInfo[3]}else{if(h.slopeSide[0]=="Infinity"){h.zoomPointInfo[2]=h.zoomPointInfo[2];h.zoomPointInfo[3]=h.zoomPointInfo[3]+(B-h.midPointInfo[3])}else{h.zoomPointInfo[2]=(D*y-F*u)/(r*F-s*D);h.zoomPointInfo[3]=(s*u-r*y)/(r*F-s*D)}}}}h.checkPointBorder();if(h.checkPointShape()){h.drawErrorRect=true;h.zoomPointInfo[2]=G;h.zoomPointInfo[3]=z;h.zoomPointInfo[4]=E;h.zoomPointInfo[5]=w}else{h.drawErrorRect=false}h.drawRect()}else{if(x==6&&h.pointInductor[6]==true){this.style.cursor="move";k.clearRect(0,0,h.editorCanvasWidth,h.editorCanvasHeight);var G=h.zoomPointInfo[4],z=h.zoomPointInfo[5],E=h.zoomPointInfo[6],w=h.zoomPointInfo[7];var s=h.slopeSide[2],F=-1,y=B-h.slopeSide[2]*j;var r=h.slopeSide[1],D=-1,u=h.zoomPointInfo[5]-h.slopeSide[1]*h.zoomPointInfo[4];var q=h.slopeSide[3],C=-1,t=h.zoomPointInfo[7]-h.slopeSide[3]*h.zoomPointInfo[6];if(h.slopeSide[2]==0){if(h.slopeSide[3]=="Infinity"){h.zoomPointInfo[6]=h.zoomPointInfo[6];h.zoomPointInfo[7]=B}else{h.zoomPointInfo[6]=(B-h.zoomPointInfo[7])/h.slopeSide[3]+h.zoomPointInfo[6];h.zoomPointInfo[7]=B}if(h.slopeSide[1]=="Infinity"){h.zoomPointInfo[4]=h.zoomPointInfo[4];h.zoomPointInfo[5]=B}else{h.zoomPointInfo[4]=(B-h.zoomPointInfo[5])/h.slopeSide[1]+h.zoomPointInfo[4];h.zoomPointInfo[5]=B}}else{if(h.slopeSide[2]=="Infinity"){if(h.slopeSide[3]==0){h.zoomPointInfo[6]=j;h.zoomPointInfo[7]=h.zoomPointInfo[7]}else{h.zoomPointInfo[7]=h.slopeSide[3]*(j-h.zoomPointInfo[6])+h.zoomPointInfo[7];h.zoomPointInfo[6]=j}if(h.slopeSide[1]==0){h.zoomPointInfo[4]=j;h.zoomPointInfo[5]=h.zoomPointInfo[5]}else{h.zoomPointInfo[5]=h.slopeSide[1]*(j-h.zoomPointInfo[4])+h.zoomPointInfo[5];h.zoomPointInfo[4]=j}}else{if(h.slopeSide[3]==0){h.zoomPointInfo[6]=h.zoomPointInfo[6]+(j-h.midPointInfo[4]);h.zoomPointInfo[7]=h.zoomPointInfo[7]}else{if(h.slopeSide[3]=="Infinity"){h.zoomPointInfo[6]=h.zoomPointInfo[6];h.zoomPointInfo[7]=h.zoomPointInfo[7]+(B-h.midPointInfo[5])}else{h.zoomPointInfo[6]=(C*y-F*t)/(q*F-s*C);h.zoomPointInfo[7]=(s*t-q*y)/(q*F-s*C)}}if(h.slopeSide[1]==0){h.zoomPointInfo[4]=h.zoomPointInfo[4]+(j-h.midPointInfo[4]);h.zoomPointInfo[5]=h.zoomPointInfo[5]}else{if(h.slopeSide[1]=="Infinity"){h.zoomPointInfo[4]=h.zoomPointInfo[4];h.zoomPointInfo[5]=h.zoomPointInfo[5]+(B-h.midPointInfo[5])}else{h.zoomPointInfo[4]=(D*y-F*u)/(r*F-s*D);h.zoomPointInfo[5]=(s*u-r*y)/(r*F-s*D)}}}}h.checkPointBorder();if(h.checkPointShape()){h.drawErrorRect=true;h.zoomPointInfo[4]=G;h.zoomPointInfo[5]=z;h.zoomPointInfo[6]=E;h.zoomPointInfo[7]=w}else{h.drawErrorRect=false}h.drawRect()}else{if(x==7&&h.pointInductor[7]==true){this.style.cursor="move";k.clearRect(0,0,h.editorCanvasWidth,h.editorCanvasHeight);var G=h.zoomPointInfo[6],z=h.zoomPointInfo[7],E=h.zoomPointInfo[0],w=h.zoomPointInfo[1];var s=h.slopeSide[3],F=-1,y=B-h.slopeSide[3]*j;var r=h.slopeSide[2],D=-1,u=h.zoomPointInfo[7]-h.slopeSide[2]*h.zoomPointInfo[6];var q=h.slopeSide[0],C=-1,t=h.zoomPointInfo[1]-h.slopeSide[0]*h.zoomPointInfo[0];if(h.slopeSide[3]==0){if(h.slopeSide[0]=="Infinity"){h.zoomPointInfo[0]=h.zoomPointInfo[0];h.zoomPointInfo[1]=B}else{h.zoomPointInfo[0]=(B-h.zoomPointInfo[1])/h.slopeSide[0]+h.zoomPointInfo[0];h.zoomPointInfo[1]=B}if(h.slopeSide[2]=="Infinity"){h.zoomPointInfo[6]=h.zoomPointInfo[6];h.zoomPointInfo[7]=B}else{h.zoomPointInfo[6]=(B-h.zoomPointInfo[7])/h.slopeSide[2]+h.zoomPointInfo[6];h.zoomPointInfo[7]=B}}else{if(h.slopeSide[3]=="Infinity"){if(h.slopeSide[0]==0){h.zoomPointInfo[0]=j;h.zoomPointInfo[1]=h.zoomPointInfo[1]}else{h.zoomPointInfo[1]=h.slopeSide[0]*(j-h.zoomPointInfo[0])+h.zoomPointInfo[1];h.zoomPointInfo[0]=j}if(h.slopeSide[2]==0){h.zoomPointInfo[6]=j;h.zoomPointInfo[7]=h.zoomPointInfo[7]}else{h.zoomPointInfo[7]=h.slopeSide[2]*(j-h.zoomPointInfo[6])+h.zoomPointInfo[7];h.zoomPointInfo[6]=j}}else{if(h.slopeSide[0]==0){h.zoomPointInfo[0]=h.zoomPointInfo[0]+(j-h.midPointInfo[6]);h.zoomPointInfo[1]=h.zoomPointInfo[1]}else{if(h.slopeSide[0]=="Infinity"){h.zoomPointInfo[0]=h.zoomPointInfo[0];h.zoomPointInfo[1]=h.zoomPointInfo[1]+(B-h.midPointInfo[7])}else{h.zoomPointInfo[0]=(C*y-F*t)/(q*F-s*C);h.zoomPointInfo[1]=(s*t-q*y)/(q*F-s*C)}}if(h.slopeSide[2]==0){h.zoomPointInfo[6]=h.zoomPointInfo[6]+(j-h.midPointInfo[6]);h.zoomPointInfo[7]=h.zoomPointInfo[7]}else{if(h.slopeSide[2]=="Infinity"){h.zoomPointInfo[6]=h.zoomPointInfo[6];h.zoomPointInfo[7]=h.zoomPointInfo[7]+(B-h.midPointInfo[7])}else{h.zoomPointInfo[6]=(D*y-F*u)/(r*F-s*D);h.zoomPointInfo[7]=(s*u-r*y)/(r*F-s*D)}}}}h.checkPointBorder();if(h.checkPointShape()){h.drawErrorRect=true;h.zoomPointInfo[6]=G;h.zoomPointInfo[7]=z;h.zoomPointInfo[0]=E;h.zoomPointInfo[1]=w}else{h.drawErrorRect=false}h.drawRect()}}}}}}}};h.editorCanvas.onmouseup=function(q){this.style.cursor="default";this.onmousemove=null;if(h.curPointIndex<4){if(h.invalidShape){h.zoomPointInfo[2*h.curPointIndex]=h.tempx;h.zoomPointInfo[2*h.curPointIndex+1]=h.tempy;h.getSlopeSide();h.drawErrorRect=false;h.drawRect();h.invalidShape=false}}else{if(h.curPointIndex>=4){if(h.invalidShape){var o=h.curPointIndex;h.zoomPointInfo[2*(o-4)]=h.tempx0,h.zoomPointInfo[2*(o-4)+1]=h.tempy0,h.zoomPointInfo[(2*(o-4)+2)%8]=h.tempx1,h.zoomPointInfo[(2*(o-4)+3)%8]=h.tempy1;h.getSlopeSide();h.drawErrorRect=false;h.drawRect();h.invalidShape=false}}}var l=h.zoomPointInfo;var n=l[0],x=l[1],m=l[2],w=l[3],k=l[4],u=l[5],j=l[6],s=l[7];while(n>=m||w>=u||k<=j||s<=x||Math.abs((w+u-x-s)/(m+k-j-n))>Math.abs((u+s-x-w)/(k+j-n-m))){var t=n;n=m,m=k,k=j,j=t;var r=x;x=w,w=u,u=s,s=r}l[0]=n,l[1]=x,l[2]=m,l[3]=w,l[4]=k,l[5]=u,l[6]=j,l[7]=s};h.editorCanvas.onmouseout=function(j){this.style.cursor="default";this.onmousemove=null;h.editorCanvas.onmouseup()};h.editorCanvas.onmouseover=function(j){this.style.cursor="default";this.onmousemove=null;h.editorCanvas.onmouseup()}};b.prototype.getMovePointInfo=function(){var h=this;for(var g=0;g<h.movePointInfo.length;g++){h.movePointInfo[g]=h.pointInfo[g+2]}return h.movePointInfo};b.prototype.getMidPointInfo=function(){var g=this;g.midPointInfo[0]=1*((g.zoomPointInfo[0]+g.zoomPointInfo[2])/2);g.midPointInfo[1]=1*((g.zoomPointInfo[1]+g.zoomPointInfo[3])/2);g.midPointInfo[2]=1*((g.zoomPointInfo[2]+g.zoomPointInfo[4])/2);g.midPointInfo[3]=1*((g.zoomPointInfo[3]+g.zoomPointInfo[5])/2);g.midPointInfo[4]=1*((g.zoomPointInfo[4]+g.zoomPointInfo[6])/2);g.midPointInfo[5]=1*((g.zoomPointInfo[5]+g.zoomPointInfo[7])/2);g.midPointInfo[6]=1*((g.zoomPointInfo[6]+g.zoomPointInfo[0])/2);g.midPointInfo[7]=1*((g.zoomPointInfo[7]+g.zoomPointInfo[1])/2);return g.midPointInfo};b.prototype.getSlopeSide=function(){var h=this;for(var g=0;g<4;g++){if(g<3){if((h.zoomPointInfo[2*g+3]-h.zoomPointInfo[2*g+1])==0&&(h.zoomPointInfo[2*(g+1)]-h.zoomPointInfo[2*g])==0){h.slopeSide[g]=0}else{h.slopeSide[g]=(h.zoomPointInfo[2*g+3]-h.zoomPointInfo[2*g+1])/(h.zoomPointInfo[2*(g+1)]-h.zoomPointInfo[2*g])}}else{if(g==3){if((h.zoomPointInfo[7]-h.zoomPointInfo[1])==0&&(h.zoomPointInfo[6]-h.zoomPointInfo[0])==0){h.slopeSide[3]=0}else{h.slopeSide[3]=(h.zoomPointInfo[7]-h.zoomPointInfo[1])/(h.zoomPointInfo[6]-h.zoomPointInfo[0])}}}}return h.slopeSide};b.prototype.updateMovePointInfo=function(){var j=this,h;h=j.documentEditor.ui.getZoom();for(var g=0;g<j.zoomPointInfo.length;g++){j.movePointInfo[g]=1*(j.zoomPointInfo[g]/h)}for(var g=0;g<j.zoomPointInfo.length;g++){if(j.movePointInfo[g]<0){j.movePointInfo[g]=0}if(j.movePointInfo[2*g]>j.objDocumentDefaultWidth-1){j.movePointInfo[2*g]=j.objDocumentDefaultWidth-1}if(j.movePointInfo[2*g+1]>j.objDocumentDefaultHeight-1){j.movePointInfo[2*g+1]=j.objDocumentDefaultHeight-1}}return j.movePointInfo};b.prototype.updateZoomPointInfo=function(){var j=this,h;h=j.documentEditor.ui.getZoom();for(var g=0;g<j.zoomPointInfo.length;g++){j.zoomPointInfo[g]=j.zoomPointInfo[g]*(h/j.zoom)}j.zoom=h;return j.zoomPointInfo};b.prototype.checkPointBorder=function(){var j=this;var h=false;for(var g=0;g<j.zoomPointInfo.length/2;g++){if(j.zoomPointInfo[2*g]<0){j.zoomPointInfo[2*g]=0;h=true}else{if(j.zoomPointInfo[2*g]>j.editorCanvasWidth-1){j.zoomPointInfo[2*g]=j.editorCanvasWidth-1;h=true}}if(j.zoomPointInfo[2*g+1]<0){j.zoomPointInfo[2*g+1]=0;h=true}else{if(j.zoomPointInfo[2*g+1]>j.editorCanvasHeight-1){j.zoomPointInfo[2*g+1]=j.editorCanvasHeight-1;h=true}}}};b.prototype.checkPointShape=function(){var r=this;var k=r.zoomPointInfo;var n=k[0],y=k[1],l=k[2],w=k[3],h=k[4],t=k[5],g=k[6],s=k[7];var m=t-y,x=n-h,q=h*y-n*t;var j=s-w,u=l-g,o=g*w-l*s;if(!((m*l+x*w+q)>0&&(m*g+x*s+q)<0&&(j*n+u*y+o)<0&&(j*h+u*t+o)>0)){r.invalidShape=true;return true}r.invalidShape=false;return false};b.prototype.initHintDiv=function(){var g=this;g.hintDiv=document.createElement("div");g.hintDiv.className="ds-dws-doc-hint-container";g.setHintString("Loading ...");g.hintDiv.style.display="none";g.hintDiv.style.textAlign="center";g.outerDiv.appendChild(g.hintDiv)};b.prototype.setHintString=function(g){if(!f.isString(g)){return null}var h=this;if(h.hintDiv.innerText){h.hintDiv.innerText=g}else{if(h.hintDiv.textContent){h.hintDiv.textContent=g}else{h.hintDiv.appendChild(document.createTextNode(g))}}};b.prototype.drawRect=function(){var h=this;h.getMidPointInfo();var g=h.editorCanvas.getContext("2d");h.brushThickness=h.documentEditor.ui.getDocumentBoundaryThickness();g.clearRect(0,0,h.editorCanvasWidth,h.editorCanvasHeight);g.beginPath();if(h.drawErrorRect){g.strokeStyle=f.IntToColorStr(4278190335)}else{g.strokeStyle=f.IntToColorStr(h.documentEditor.ui.getDocumentBoundaryColor())}g.lineWidth=h.brushThickness;g.moveTo(h.zoomPointInfo[0],h.zoomPointInfo[1]);g.lineTo(h.zoomPointInfo[2],h.zoomPointInfo[3]);g.lineTo(h.zoomPointInfo[4],h.zoomPointInfo[5]);g.lineTo(h.zoomPointInfo[6],h.zoomPointInfo[7]);g.closePath();g.stroke();h.drawArc(h.zoomPointInfo[0],h.zoomPointInfo[1],h.brushThickness+4,h.brushThickness+3);h.drawArc(h.zoomPointInfo[2],h.zoomPointInfo[3],h.brushThickness+4,h.brushThickness+3);h.drawArc(h.zoomPointInfo[4],h.zoomPointInfo[5],h.brushThickness+4,h.brushThickness+3);h.drawArc(h.zoomPointInfo[6],h.zoomPointInfo[7],h.brushThickness+4,h.brushThickness+3);h.drawArc(h.midPointInfo[0],h.midPointInfo[1],h.brushThickness+3,h.brushThickness+2);h.drawArc(h.midPointInfo[2],h.midPointInfo[3],h.brushThickness+3,h.brushThickness+2);h.drawArc(h.midPointInfo[4],h.midPointInfo[5],h.brushThickness+3,h.brushThickness+2);h.drawArc(h.midPointInfo[6],h.midPointInfo[7],h.brushThickness+3,h.brushThickness+2)};b.prototype.drawArc=function(j,g,m,k){var l=this;var h=l.editorCanvas.getContext("2d");h.beginPath();h.fillStyle=f.IntToColorStr(l.documentEditor.ui.getDocumentBoundaryColor());h.lineWidth=l.documentEditor.ui.getDocumentBoundaryThickness();h.arc(j,g,m,0,Math.PI*2);h.stroke();h.closePath();h.beginPath();h.fillStyle="rgba(255,255,255,.5)";h.arc(j,g,k,0,Math.PI*2);h.fill();h.closePath()};b.prototype.initObjDoc=function(){var g=this;g.objDocument=new Image();g.objDocument.className="ds-dws-doc-obj";g.objDocument.setAttribute("alt","document editor");g.objDocument.style.display="none";g.hintDiv.style.display="block";g.setHintString("Loading ...");g.positionHintDiv();g.objDocument.onload=function(){g.fitDocument();g.hintDiv.style.display="none";g.objDocument.style.display=""};g.objDocument.onerror=function(){++g.curLoadCount;if(g.curLoadCount>g.MAXLOACOUNT){g.setHintString("Error ocurrs");a.handleImageLoadingError(g.dwsObject,g.objDocument.src);if(g.objDocument.parentNode){g.objDocument.parentNode.removeChild(this)}}else{g.objDocument.src=[g.documentUrl,"&ts=",f.now()].join("")}};g.curLoadCount=1;g.objDocument.src=[g.documentUrl,"&ts=",f.now()].join("");g.outerDiv.appendChild(g.objDocument)};b.prototype.refreshUIDoc=function(){var h=this,g;g=h.documentEditor.ui.getZoom();h.objDocument.width=g*h.objDocumentDefaultWidth;h.objDocument.height=g*h.objDocumentDefaultHeight;h.editorCanvas.setAttribute("width",g*h.objDocumentDefaultWidth);h.editorCanvas.setAttribute("height",g*h.objDocumentDefaultHeight);h.editorCanvasWidth=g*h.objDocumentDefaultWidth;h.editorCanvasHeight=g*h.objDocumentDefaultHeight;h.refreshScrollBar();h.positionObjDoc();h.positionEditorCanvas()};b.prototype.refreshSrcDoc=function(){var k=this,j;var g=k.hintDiv,h=k.objDocument;j=k.documentEditor.ui.getZoom();k.initHintDiv();k.objDocument=new Image();k.objDocument.className="ds-dws-doc-obj";k.objDocument.setAttribute("alt","document editor");k.objDocument.style.display="none";k.hintDiv.style.display="block";k.setHintString("Loading ...");k.positionHintDiv();k.objDocument.onload=function(){k.documentContainerImageObj.removeChild(g);k.documentContainerImageObj.removeChild(h);k.objDocument.width=j*k.objDocumentDefaultWidth;k.objDocument.height=j*k.objDocumentDefaultHeight;k.positionObjDoc();k.hintDiv.style.display="none";k.objDocument.style.display=""};k.objDocument.onerror=function(){++k.curLoadCount;if(k.curLoadCount>k.MAXLOACOUNT){k.setHintString("Error ocurrs");a.handleImageLoadingError(k.dwsObject,k.objDocument.src);if(k.objDocument.parentNode){k.objDocument.parentNode.removeChild(this)}}else{k.objDocument.src=[k.documentUrl,"&ts=",f.now()].join("")}};k.curLoadCount=1;k.objDocument.src=[k.documentUrl,"&ts=",f.now()].join("");k.outerDiv.appendChild(k.objDocument)};b.prototype.refreshRotateDoc=function(l){var m=this,j,h;var g=m.hintDiv,k=m.objDocument;m.zoom=m.documentEditor.ui.getZoom();m.initHintDiv();m.objDocument=new Image();m.objDocument.className="ds-dws-doc-obj";m.objDocument.setAttribute("alt","document editor");m.objDocument.style.display="none";m.hintDiv.style.display="block";m.setHintString("Loading ...");m.positionHintDiv();j=m.objDocumentDefaultWidth;m.objDocumentDefaultWidth=m.objDocumentDefaultHeight;m.objDocumentDefaultHeight=j;m.objDocument.onload=function(){m.documentContainerImageObj.removeChild(g);m.documentContainerImageObj.removeChild(k);m.objDocument.width=m.zoom*m.objDocumentDefaultWidth;m.objDocument.height=m.zoom*m.objDocumentDefaultHeight;m.positionObjDoc();m.hintDiv.style.display="none";m.objDocument.style.display="";m.refreshScrollBar();if(l=="left"){m.refreshRotateLeftCanvas()}else{m.refreshRotateRightCanvas()}if(m.documentEditor.ui._zoomSet==false){m.fitDocument()}};m.objDocument.onerror=function(){++m.curLoadCount;if(m.curLoadCount>m.MAXLOACOUNT){m.setHintString("Error ocurrs");a.handleImageLoadingError(m.dwsObject,m.objDocument.src);if(m.objDocument.parentNode){m.objDocument.parentNode.removeChild(this)}}else{m.objDocument.src=[m.documentUrl,"&ts=",f.now()].join("")}};m.curLoadCount=1;m.objDocument.src=[m.documentUrl,"&ts=",f.now()].join("");m.outerDiv.appendChild(m.objDocument)};b.prototype.refreshRotateRightCanvas=function(){var k=this,j=new Array(8),h=new Array(8);k.copyArry(k.zoomPointInfo,j);k.editorCanvasWidth=k.zoom*k.objDocumentDefaultWidth;k.editorCanvasHeight=k.zoom*k.objDocumentDefaultHeight;k.editorCanvas.setAttribute("width",k.zoom*k.objDocumentDefaultWidth);k.editorCanvas.setAttribute("height",k.zoom*k.objDocumentDefaultHeight);for(var g=0;g<j.length;g++){if(g<2){k.zoomPointInfo[g]=j[g+6]}else{if(g>1){k.zoomPointInfo[g]=j[g-2]}}}k.copyArry(k.zoomPointInfo,h);for(var g=0;g<h.length/2;g++){k.zoomPointInfo[2*g+1]=h[2*g];k.zoomPointInfo[2*g]=k.editorCanvasWidth-h[2*g+1]}k.drawRect();k.positionEditorCanvas()};b.prototype.refreshRotateLeftCanvas=function(){var k=this,j=new Array(8),h=new Array(8);k.copyArry(k.zoomPointInfo,j);k.editorCanvasWidth=k.zoom*k.objDocumentDefaultWidth;k.editorCanvasHeight=k.zoom*k.objDocumentDefaultHeight;k.editorCanvas.setAttribute("width",k.zoom*k.objDocumentDefaultWidth);k.editorCanvas.setAttribute("height",k.zoom*k.objDocumentDefaultHeight);k.zoomPointInfo[0]=j[2];k.zoomPointInfo[1]=j[3];k.zoomPointInfo[2]=j[4];k.zoomPointInfo[3]=j[5];k.zoomPointInfo[4]=j[6];k.zoomPointInfo[5]=j[7];k.zoomPointInfo[6]=j[0];k.zoomPointInfo[7]=j[1];k.copyArry(k.zoomPointInfo,h);for(var g=0;g<h.length/2;g++){k.zoomPointInfo[2*g+1]=k.editorCanvasHeight-h[2*g];k.zoomPointInfo[2*g]=h[2*g+1]}k.drawRect();k.positionEditorCanvas()};b.prototype.fitDocument=function(){var j=this;var h=j.documentEditorWidth/j.documentEditorHeight;var g=j.objDocumentDefaultWidth/j.objDocumentDefaultHeight;if(g>h){j.objDocument.width=j.documentEditorWidth;j.objDocument.height=j.objDocument.width/g}else{j.objDocument.height=j.documentEditorHeight;j.objDocument.width=j.objDocument.height*g}j.editorCanvas.setAttribute("width",j.objDocument.width);j.editorCanvas.setAttribute("height",j.objDocument.height);j.editorCanvasWidth=j.objDocument.width;j.editorCanvasHeight=j.objDocument.height;j.documentEditor.ui._zoom=j.objDocument.width/j.objDocumentDefaultWidth;j.updateZoomPointInfo();j.positionObjDoc();j.positionEditorCanvas();j.refreshScrollBar();j.drawRect()};b.prototype.refreshScrollBar=function(){var g=this;if(g.objDocument.width>g.documentEditorWidth){g.containerBox.style.overflowX="scroll"}else{g.containerBox.style.overflowX="hidden"}if(g.objDocument.height>g.documentEditorHeight){g.containerBox.style.overflowY="scroll"}else{g.containerBox.style.overflowY="hidden"}};b.prototype.positionObjDoc=function(){var j=this;if(!j.objDocument){return}j.objDocument.style.position="absolute";var h=(j.documentEditorHeight-j.objDocument.height)/2,g=(j.documentEditorWidth-j.objDocument.width)/2;if(h<0){h=0}if(g<0){g=0}j.objDocument.style.top=parseInt(h)+"px";j.objDocument.style.left=parseInt(g)+"px"};b.prototype.positionEditorCanvas=function(){var j=this;var h=(j.documentEditorHeight-j.editorCanvasHeight)/2,g=(j.documentEditorWidth-j.editorCanvasWidth)/2;if(h<0){h=0}if(g<0){g=0}j.editorCanvas.style.top=parseInt(h)+"px";j.editorCanvas.style.left=parseInt(g)+"px"};b.prototype.positionHintDiv=function(){var m=this,h=m.documentEditor.ui._userDocumentEditorWidth,j=m.documentEditor.ui._userDocumentEditorHeight,l=m.hintDiv.style.width,g=m.hintDiv.style.height;var k=(j-g)/2;if(k<0){k=0}m.hintDiv.style.position="relative";m.hintDiv.style.top=parseInt(k)+"px"};b.prototype.refreshUI=function(){var g=this;g.updateZoomPointInfo();g.midPointInfo=g.getMidPointInfo();g.refreshUIDoc();g.drawRect()};b.prototype.refreshSrc=function(){var g=this;g.documentUrl=g.getRefreshedDocUrl();g.refreshSrcDoc()};b.prototype.refreshRotate=function(g){var h=this;h.documentUrl=h.getRefreshedDocUrl();h.refreshRotateDoc(g)};b.prototype.copyArry=function(h,g){for(var j=0;j<h.length;j++){g[j]=h[j]}};b.prototype.getRefreshedDocUrl=function(){var g=this;return[a.preUrl,a.portInfo.curPort,"/",dynamsoft.dcsEnv._getVersionStrForCommand(),"/img?session=",a.sessionId,"&object=",g.dwsObject._dwsObjectId,"&documenteditor=",g.documentEditor._docEditorId].join("")};b.prototype.GetDocBoundaryInfoFromEditor=function(){var k=this;var j={session:a.sessionId,object:k.dwsObject._dwsObjectId,method:"GetDocBoundaryInfo",parameter:[k.documentEditor._docEditorId]},h=function(l){k.pointInfo=l.result};var g=f.detect.postSyncCommand(k._dwsObject,f.stringify(j),h,null)};b.prototype.destroy=function(){var g=this;if(g.hintDiv&&g.hintDiv.parentNode){g.hintDiv.parentNode.removeChild(g.hintDiv)}if(g.objDocument&&g.objDocument.parentNode){g.objDocument.parentNode.removeChild(g.objDocument)}if(g.editorCanvas){g.editorCanvas.getContext("2d").clearRect(0,0,g.documentEditor.ui._userDocumentEditorWidth,g.documentEditor.ui._userDocumentEditorHeight)}else{g.documentEditor.ui._documentContainerCanvasEditor.getContext("2d").clearRect(0,0,g.documentEditor.ui._userDocumentEditorWidth,g.documentEditor.ui._userDocumentEditorHeight)}g.editorCanvas.setAttribute("width","");g.editorCanvas.setAttribute("height","");g.editorCanvasWidth=g.objDocument.width=0;g.editorCanvasHeight=g.objDocument.height=0;g.zoom=1;g.documentEditor.ui._zoom=1;g.documentEditor.ui._zoomSet=false;g.refreshScrollBar();g.bDestroy=true};d.DocumentControl=b})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.lib.detect,dynamsoft.dcsEnv);var EnumDCS_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8};(function(d,j){var e=false;var h=function(){var l=dynamsoft.initOrder,n=false;if(!e){for(var m=0;m<l.length;m++){if(l[m]=="dcs"){n=true;break}}if(!n){l.push("dcs");e=true}}j.initQueue.push(arguments)};var g=function(m){if(arguments.length!=1||!d.isString(m)){return null}var l=j._videoViewerDic[m];return l?l.dwsObject:null};var b=function(){var l;if(arguments.length>0){return l}var n={session:d.detect.sessionId,method:"GetConfigedLogLevel"},m=function(o){if(o.result[0]!==undefined){l=o.result[0]}};d.detect.postSyncCommand(null,d.stringify(n),m,null);return l};var a=function(m){var l=!1;if(arguments.length!=1||!d.isNumber(arguments[0])){return l}m=Math.round(m);if(m!==0&&m!==1){return l}var n={session:d.detect.sessionId,method:"ConfigLogLevel",parameter:[m]};l=d.detect.postSyncCommand(null,d.stringify(n),null,null);return l};var k=function(){var l=!1;if(arguments.length>0){return l}var m={session:d.detect.sessionId,method:"RemoveAllCameraAuthorizations"};l=d.detect.postSyncCommand(null,d.stringify(m),null,null);return l};var f=function(o){var l=!1;if(arguments.length!=1||!d.isNumber(arguments[0])){return l}o=Math.round(o);var m=!1;for(var n in EnumDCS_Language){if(EnumDCS_Language[n]==o){m=!0;break}}if(!m){return l}j._lang=o;return true};j.init=h;j.getObject=g;j.getLogLevel=b;j.setLogLevel=a;j.removeAllCameraAuthorizations=k;j.ondcsnotfound=undefined;j.ondcsneedupgrade=undefined;j.setLanguage=f;j.initQueue=[];j._videoViewerDic={};j._imageViewerDic={};j._documentEditorDic={};j._bTurnToInitDcsObj=false})(dynamsoft.lib,dynamsoft.dcsEnv);(function(k,t,r){var f=false,l=false,j=null;var o=function(){f=true;if(!t.bConnected&&!t.dcsModuleBinary&&t.downloadDcsModuleStatus===t.enumDownloadDcsModuleStatus.idle){t.downloadDcsModule()}if(t.bConnected){t.sendHeartBeatCommand(true)}if(t.bConnected&&j){a()}},a=function(){Dynamsoft__OnclickCloseInstallEx();setTimeout(function(){t.sendHeartBeatCommand(true);var y=r._dwsObjClientIdPrefix+k.getRandom(),x=r._imgViewerClientIdPrefix+k.getRandom(),w=t.getInitInfo(y,x);if(w===undefined){t.bConnected=false}else{if(t.isValidResponseValue(w)&&(w.exception!=0)){t.sendRemoveObjectCommand(y);if(!k.isNull(j[3])){if(w.exception===EnumDCS_ErrorCode.CameraNotAuthorized&&k.isString(w.description)){w.description=w.description.replace("/Webcams","")}(j[3])(w.exception,w.description)}}else{if(t.isValidResponseValue(w)&&(w.exception==0)){new k.sdk.DcsObject(j[0],j[1],y,x);if(!k.isNull(j[2])){(j[2])(j[0],j[1])}}}}if(w==undefined){r.initQueue.unshift(j)}j=null;l=false;h(true)},100)};t.bConnectNumLimited=true;t.asyncGetServiceInfo(function(){o()},function(){o()});var q=4,d,e,s,m,n,g,u;var h=function(w){if((dynamsoft.initOrder.length>0&&dynamsoft.initOrder[0]=="dcs")){dynamsoft.initOrder.splice(0,1);r._bTurnToInitDcsObj=w}};var b=function(){d=j[0];e=j[1];s=j[2];m=j[3];n=false;g=0;u="Successful";if(j.length!=q){n=true;g=k.errorInfo.getParameterNumberUnmatchedCode();u=k.errorInfo.getParameterNumberUnmatchedString(j.length<4)}if(!n&&!k.isString(d)){n=true;g=k.errorInfo.getTypeNotValidCode();u=k.errorInfo.getTypeNotValidString("videoViewerContainer")}if(!n&&!k.isString(e)){n=true;g=k.errorInfo.getTypeNotValidCode();u=k.errorInfo.getTypeNotValidString("imageViewerContainer")}if(!n&&!k.isFunction(s)&&!k.isNull(s)){n=true;g=k.errorInfo.getTypeNotValidCode();u=k.errorInfo.getTypeNotValidString("onSuccess")}if(!n&&!k.isFunction(m)&&!k.isNull(m)){n=true;g=k.errorInfo.getTypeNotValidCode();u=k.errorInfo.getTypeNotValidString("onFailure")}if(!n&&d==e){n=true;g=k.errorInfo.getContainerIdNotValidCode();u=k.errorInfo.getContainerIdNotValidString()}if(!n){var y;try{y=k.one("#"+d).getEL()}catch(x){y=false}if(!y){n=true;g=k.errorInfo.getObjectNotExistCode();u=k.errorInfo.getObjectNotExistString(d)}if(!n&&y.nodeName.toUpperCase()!="DIV"){n=true;g=k.errorInfo.getContainerTypeNotValidCode();u=k.errorInfo.getContainerTypeNotValidString(false)}}if(!n){var w;try{w=k.one("#"+e).getEL()}catch(x){w=false}if(!w){n=true;g=k.errorInfo.getObjectNotExistCode();u=k.errorInfo.getObjectNotExistString(e)}if(!n&&w.nodeName.toUpperCase()!="DIV"){n=true;g=k.errorInfo.getContainerTypeNotValidCode();u=k.errorInfo.getContainerTypeNotValidString(true)}}if(!n&&r._videoViewerDic[d]){n=true;g=k.errorInfo.getObjectOccupiedCode();u=k.errorInfo.getObjectOccupiedString(d)}if(!n&&r._imageViewerDic[e]){n=true;g=k.errorInfo.getObjectOccupiedCode();u=k.errorInfo.getObjectOccupiedString(e)}};var p=function(){if((!t.bConnected&&!f)||r.initQueue.length<=0||l){return}if(!((dynamsoft.initOrder.length>0&&dynamsoft.initOrder[0]=="dcs")||r._bTurnToInitDcsObj)){return}l=true;j=r.initQueue[0];r.initQueue.splice(0,1);if(!j){l=false;return}else{b();if(r.navInfo.bMac){if(k.isFunction(m)){setTimeout(function(){m(EnumDCS_ErrorCode.Unknown,"DCS is not yet supported on Mac.")},0)}}if(n){l=false;if(k.isFunction(m)){setTimeout(function(){m(g,u)},0)}h(false);return}}var w=function(){if(!k.isString(t.getSessionIdSync())){if(j){r.initQueue.unshift(j)}l=false;return true}return false},x=function(){t.asyncGetServiceInfo(function(){if(w()){return}a()},function(){t.downloadDcsModule(function(){dynamsoft.dcp.loadZip(t.dcsModuleBinary,100,function(z){var y;try{y=k.parse(z)}catch(A){y=null}if(y&&y.result&&y.result.length>0&&!y.result[0]){l=false;if(k.isFunction(m)){setTimeout(function(){m(k.errorInfo.getSendDcsModuleFailedCode(),k.errorInfo.getSendDcsModuleFailedString())},0)}t.downloadDcsModuleStatus=t.enumDownloadDcsModuleStatus.fail;h(false);setTimeout(function(){Dynamsoft__OnclickCloseInstallEx()},0);return}t.asyncGetServiceInfo(function(){if(w()){return}a()},function(){l=false;if(k.isFunction(m)){setTimeout(function(){m(k.errorInfo.getConnectDcsModuleFailedCode(),k.errorInfo.getConnectDcsModuleFailedString())},0)}h(false);setTimeout(function(){Dynamsoft__OnclickCloseInstallEx()},0);return},500,20)},function(){l=false;if(k.isFunction(m)){setTimeout(function(){m(k.errorInfo.getSendDcsModuleFailedCode(),k.errorInfo.getSendDcsModuleFailedString())},0)}h(false);setTimeout(function(){Dynamsoft__OnclickCloseInstallEx()},0);return})},function(){l=false;if(k.isFunction(m)){setTimeout(function(){m(k.errorInfo.getDownloadDcsModuleFailedCode(),k.errorInfo.getDownloadDcsModuleFailedString())},0)}h(false);setTimeout(function(){Dynamsoft__OnclickCloseInstallEx()},0);return})},undefined,2)};dynamsoft.dcp.versionInfo(function(y,A){if(dynamsoft.dcp.detect.bConnected){x()}else{if(r.navInfo.bIE&&(parseInt(r.navInfo.strBrowserVersion)<=9)&&k.isString(A)&&(A.toLowerCase().indexOf("denied")!==-1||A.toLowerCase().indexOf(t.IE_PERMISSION_DENIED_Err_Code)!==-1||A.toLowerCase().indexOf(t.IE_Unknown_Err_Code)!==-1)){l=false;if(k.isFunction(m)){setTimeout(function(){m(k.errorInfo.getOperationNotSupportedCode(),k.errorInfo.getOperationNotSupportedString())},0)}h(false);return}var z=false;if(k.isFunction(r.ondcsnotfound)){z=r.ondcsnotfound()}if(k.isBoolean(z)&&!z){Dynamsoft__OnclickCloseInstallEx();r.showInstallDialog(true)}t.asyncConnDcpUnitlReady(function(){x()})}})};setInterval(p,1000)})(dynamsoft.lib,dynamsoft.lib.detect,dynamsoft.dcsEnv);(function(a){a.ready(function(){var b=[dynamsoft.dcsEnv.resourcesPath,"/hint.css"].join("");a.getCss(b)})})(dynamsoft.lib);
